!function(){"use strict";var t="undefined"==typeof global?self:global;if("function"!=typeof t.require){var e={},n={},r={},i={}.hasOwnProperty,o=/^\.\.?(\/|$)/,a=function(t,e){for(var n,r=[],i=(o.test(e)?t+"/"+e:e).split("/"),a=0,s=i.length;a<s;a++)n=i[a],".."===n?r.pop():"."!==n&&""!==n&&r.push(n);return r.join("/")},s=function(t){return t.split("/").slice(0,-1).join("/")},u=function(e){return function(n){var r=a(s(e),n);return t.require(r,e)}},l=function(t,e){var r=g&&g.createHot(t),i={id:t,exports:{},hot:r};return n[t]=i,e(i.exports,u(t),i),i.exports},c=function(t){return r[t]?c(r[t]):t},f=function(t,e){return c(a(s(t),e))},d=function(t,r){null==r&&(r="/");var o=c(t);if(i.call(n,o))return n[o].exports;if(i.call(e,o))return l(o,e[o]);throw new Error("Cannot find module '"+t+"' from '"+r+"'")};d.alias=function(t,e){r[e]=t};var p=/\.[^.\/]+$/,v=/\/index(\.[^\/]+)?$/,h=function(t){if(p.test(t)){var e=t.replace(p,"");i.call(r,e)&&r[e].replace(p,"")!==e+"/index"||(r[e]=t)}if(v.test(t)){var n=t.replace(v,"");i.call(r,n)||(r[n]=t)}};d.register=d.define=function(t,r){if(t&&"object"==typeof t)for(var o in t)i.call(t,o)&&d.register(o,t[o]);else e[t]=r,delete n[t],h(t)},d.list=function(){var t=[];for(var n in e)i.call(e,n)&&t.push(n);return t};var g=t._hmr&&new t._hmr(f,d,e,n);d._cache=n,d.hmr=g&&g.wrap,d.brunch=!0,t.require=d}}(),function(){"undefined"==typeof window?this:window;require.register("Config.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=t.Config=function o(){r(this,o)};i.backend="//"}),require.register("access/LoginView.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.LoginView=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=e("Config"),u=e("../base/View"),l=e("../base/Router"),c=e("../base/Repository"),f=e("./UserRepository"),d=e("../toast/Toast"),p=e("../toast/ToastAlert");t.LoginView=function(t){function e(){r(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.template='\n\t\t\t<a cv-link = "user">User</a>\n\t\t\t<br />\n\t\t\t\n\t\t\t<a cv-link = "user/login">Login</a>\n\t\t\t<br />\n\n\t\t\t<a cv-link = "user/register">Register</a>\n\t\t\t<br />\n\n\t\t\t<a cv-link = "user/logout">Logout</a>\n\t\t\t<br />\n\n\t\t\t<input\n\t\t\t\ttype  = "button"\n\t\t\t\tvalue = "Login via FaceBook"\n\t\t\t \tcv-on = "click:facebookLogin(event)"\n\t\t\t />\n\t\t\t <input\n\t\t\t\ttype  = "button"\n\t\t\t\tvalue = "Log Out"\n\t\t\t \tcv-on = "click:logout(event)"\n\t\t\t />\n\t\t',t}return o(e,t),a(e,[{key:"facebookLogin",value:function(t){var e=this;console.log("fb!"),t.preventDefault();window.open(s.Config.backend+"/facebookLogin");this.userCheck&&this.clearInterval(this.userCheck),this.userCheck=this.onInterval(333,function(){f.UserRepository.getCurrentUser(!0).then(function(t){var n=t.body;n.id&&n&&(e.clearInterval(e.userCheck),l.Router.clearCache(),c.Repository.clearCache(),d.Toast.instance().pop(new p.ToastAlert({title:"Logged in as "+n.username,body:"ID: "+n.publicId,time:2400})))})})}},{key:"logout",value:function(t){window.open(s.Config.backend+"/user/logout?page=app%3Fclose%3D1")}}]),e}(u.View)}),require.register("access/UserRepository.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.UserRepository=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=e("Config"),u=e("../base/Bindable"),l=e("../base/Repository"),c=t.UserRepository=function(t){function e(){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),a(e,null,[{key:"getCurrentUser",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.args=this.args||u.Bindable.makeBindable({}),!window.prerenderer)return!e&&this.running?(console.log(this.running),this.running):!e&&this.args.response?Promise.resolve(this.args.response):e===!1?Promise.resolve(this.args.response):(this.running=this.request(this.uri+"current",!1,!1,!1).then(function(e){if(t.running=!1,e.body.roles)for(var n in e.body.roles)"SeanMorris\\Access\\Role\\Administrator"==e.body.roles[n]["class"]&&(e.body.isAdmin=!0);return e&&e.body.id&&(t.args.response=e,t.args.current=e.body),e}),this.running)}},{key:"login",value:function(){return this.request(this.uri+"/login")}},{key:"logout",value:function(){var t=this;this.args=this.args||u.Bindable.makeBindable({});var e=this.args.current;return this.request(this.uri+"logout",!1,{},!1).then(function(){return t.args.current=null,e})}},{key:"onChange",value:function(t){return this.args=this.args||u.Bindable.makeBindable({}),this.args.bindTo("current",t)}},{key:"uri",get:function(){return s.Config.backend+"/user/"}}]),e}(l.Repository);l.Repository.onResponse(function(t){c.args=c.args||u.Bindable.makeBindable({}),t&&t.meta&&t.meta.currentUser&&(!c.args.current||t.meta.currentUser.id!==c.args.current.id)&&(c.args.current=t.meta.currentUser)},{wait:0})}),require.register("base/Bag.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.Bag=function(){function t(e){r(this,t),this.meta=Symbol("meta"),this.content={},this._items=!1,this.changeCallback=e}return o(t,[{key:"add",value:function(t){if(("undefined"==typeof t?"undefined":i(t))instanceof Object)throw new Error("Only objects may be added/removed from Bags.");t[this.meta]||(t[this.meta]=Symbol("bagId")),this.content[t[this.meta]]=t,this.changeCallback&&this.changeCallback(this.content[t[this.meta]],this.meta,1)}},{key:"remove",value:function(t){if("object"!==("undefined"==typeof t?"undefined":i(t)))throw new Error("Only objects may be added/removed from Bags.");if(!t[this.meta]||!this.content[t[this.meta]])return this.changeCallback&&this.changeCallback(void 0,this.meta,0),!1;var e=this.content[t[this.meta]];delete this.content[t[this.meta]],this.changeCallback&&this.changeCallback(e,this.meta,-1)}},{key:"id",value:function(t){return t[this.meta]}},{key:"get",value:function(t){return this.content[t]}},{key:"keys",value:function(){return Object.getOwnPropertySymbols(this.content).slice()}},{key:"items",value:function(){var t=this;return this.keys().map(function(e){return t.get(e)}).slice()}}]),t}()}),require.register("base/Bindable.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.Bindable=function(){function t(){r(this,t)}return o(t,null,[{key:"isBindable",value:function(e){return!!e.___binding___&&e.___binding___===t}},{key:"makeBindable",value:function(e){if(!e||e.___binding___||"object"!==("undefined"==typeof e?"undefined":i(e))||e instanceof Node)return e;Object.defineProperty(e,"___ref___",{enumerable:!1,writable:!0}),Object.defineProperty(e,"bindTo",{enumerable:!1,writable:!0}),Object.defineProperty(e,"isBound",{enumerable:!1,writable:!0}),Object.defineProperty(e,"___binding___",{enumerable:!1,writable:!0}),Object.defineProperty(e,"___bindingAll___",{enumerable:!1,writable:!0}),Object.defineProperty(e,"___isBindable___",{enumerable:!1,writable:!0}),Object.defineProperty(e,"___executing___",{enumerable:!1,writable:!0}),Object.defineProperty(e,"___stack___",{enumerable:!1,writable:!0}),Object.defineProperty(e,"___stackTime___",{enumerable:!1,writable:!0}),Object.defineProperty(e,"___before___",{enumerable:!1,writable:!0}),Object.defineProperty(e,"___after___",{enumerable:!1,writable:!0}),Object.defineProperty(e,"___setCount___",{enumerable:!1,writable:!0}),Object.defineProperty(e,"___wrapped___",{enumerable:!1,writable:!0}),Object.defineProperty(e,"___object___",{enumerable:!1,writable:!1,value:e}),e.___isBindable___=t,e.___wrapped___={},e.___binding___={},e.___bindingAll___=[],e.___stack___=[],e.___stackTime___=[],e.___before___=[],e.___after___=[],e.___setCount___={},e.bindTo=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=!1;t instanceof Function&&(r=n||{},n=t,i=!0);var o=!1;r.delay>=0&&(n=function(t){return function(e,n,i,o){var a=i[n];setTimeout(function(){return t(e,n,i,o,a)},r.delay)}}(n)),r.throttle>=0&&(n=function(t){return function(e,n,i,a){if(!o){var s=i[n];t(e,n,i,a,s),o=!0,setTimeout(function(){return o=!1},r.throttle)}}}(n));var a=void 0;if(r.wait>=0&&(n=function(t){return function(e,n,i,o){a&&clearTimeout(a);var s=i[n];a=setTimeout(function(){return t(e,n,i,o,s)},r.wait)}}(n)),i){var s=e.___bindingAll___.length;e.___bindingAll___.push(n);for(var u in e)n(e[u],u,e,!1);return function(){e.___bindingAll___[s]=null}}e.___binding___[t]||(e.___binding___[t]=[]);var l=e.___binding___[t].length;return e.___binding___[t].push(n),n(e[t],t,e,!1),function(){e.___binding___[t]&&(e.___binding___[t][l]=null)}},e.isBound=function(){for(var t in e.___bindingAll___)if(e.___bindingAll___[t])return!0;for(var n in e.___binding___)for(var r in e.___binding___[n])if(e.___binding___[n][r])return!0;return!1};for(var n in e)e[n]&&"object"==i(e[n])&&!e[n]instanceof Node&&!e[n]instanceof Promise&&(e[n]=t.makeBindable(e[n]));var r=function(n,r,o){if("string"==typeof r&&"___"===r.substring(0,3)&&"___"===r.slice(-3))return!0;if(n[r]===o)return!0;if(o&&"object"==("undefined"==typeof o?"undefined":i(o))&&!(o instanceof Node)&&o.___isBindable___!==t){o=t.makeBindable(o);for(var a in o)o[a]&&"object"==i(o[a])&&(o[a]=t.makeBindable(o[a]))}for(var s in e.___bindingAll___)e.___bindingAll___[s]&&e.___bindingAll___[s](o,r,n,!1);var u=!1;if(r in e.___binding___)for(var l in e.___binding___[r])e.___binding___[r]&&e.___binding___[r][l]&&e.___binding___[r][l](o,r,n,!1,n[r])===!1&&(u=!0);if(!u){var c=Object.getOwnPropertyDescriptor(n,r),f=n instanceof File&&"lastModifiedDate"==r;f||c&&!c.writable||(n[r]=o)}n.___setCount___[r]||(n.___setCount___[r]=0),n.___setCount___[r]++;var d=10;return n.___setCount___[r]>d&&o instanceof Object,Reflect.set(n,r,o)},o=function(t,n){if(!(n in t))return!0;for(var r in e.___bindingAll___)e.___bindingAll___[r](void 0,n,t,!0,t[n]);if(n in e.___binding___)for(var i in e.___binding___[n])e.___binding___[n][i]&&e.___binding___[n][i](void 0,n,t,!0,t[n]);return Array.isArray(t)?t.splice(n,1):delete t[n],!0},a=function(n,r){return n[r]instanceof Function?n.___wrapped___[r]?n.___wrapped___[r]:(n.___wrapped___[r]=function(){n.___executing___=r,n.___stack___.unshift(r);for(var t in n.___before___)n.___before___[t](n,r,e);var i=e instanceof Promise?e:e.___ref___,o=n[r].apply(i,arguments);for(var a in n.___after___)n.___after___[a](n,r,e);return n.___executing___=null,n.___stack___.shift(),o},n.___wrapped___[r]):(n[r]instanceof Object&&t.makeBindable(n[r]),n[r])};return e.___ref___=new Proxy(e,{deleteProperty:o,get:a,set:r}),e.___ref___}},{key:"clearBindings",value:function(t){t.___wrapped___={},t.___bindingAll___=[],t.___binding___={},t.___before___=[],t.___after___=[],t.___ref___={}}},{key:"resolve",value:function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=void 0,i=e.split("."),o=i[0];i.length;){if(n&&1===i.length){var a=this.makeBindable(t);return[a,i.shift(),o]}r=i.shift(),!(!r in t)&&t[r]&&t[r]instanceof Object||(t[r]={}),t=this.makeBindable(t[r])}return[this.makeBindable(t),r,o]}}]),t}()}),require.register("base/Cache.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.Cache=function(){function t(){r(this,t)}return i(t,null,[{key:"store",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"standard",i=0;n&&(i=1e3*n+(new Date).getTime()),this.bucket||(this.bucket={}),this.bucket[r]||(this.bucket[r]={}),this.bucket[r][t]={expiration:i,value:e}}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"standard";return this.bucket&&this.bucket[n]&&this.bucket[n][t]&&(0==this.bucket[n][t].expiration||this.bucket[n][t].expiration>(new Date).getTime())?this.bucket[n][t].value:e}}]),t}()}),require.register("base/Cookie.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Cookie=void 0;var i=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=e("./Bindable"),s=t.Cookie=function(){function t(){r(this,t)}return o(t,null,[{key:"set",value:function(e,n){t.jar[e]=n}},{key:"get",value:function(e){return t.jar[e]}},{key:"delete",value:function(e){delete t.jar[e]}}]),t}();s.jar=s.jar||a.Bindable.makeBindable({}),"data"!==window.location.href.substr(0,4)&&(document.cookie.split(";").map(function(t){var e=t.split("="),n=i(e,2),r=n[0],o=n[1];try{o=JSON.parse(o)}catch(a){o=o}r=r.trim(),s.jar[decodeURIComponent(r)]=o}),s.jar.bindTo(function(t,e,n,r){n[e]=t,r&&(n[e]=null);var i=encodeURIComponent(e)+"="+n[e];document.cookie=i}))}),require.register("base/Dom.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.Dom=function(){function t(){r(this,t)}return i(t,null,[{key:"mapTags",value:function(t,e,n,r,i){var o=[],a=!0;r&&(a=!1);for(var s=!1,u=document.createTreeWalker(t,NodeFilter.SHOW_ALL,{acceptNode:function(t){if(!a){if(t!==r)return NodeFilter.FILTER_SKIP;a=!0}return i&&t===i&&(s=!0),s?NodeFilter.FILTER_SKIP:e?t instanceof Element&&t.matches(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}},!1);u.nextNode();)o.push(n(u.currentNode));return o}},{key:"dispatchEvent",value:function(e,n){e.dispatchEvent(n),t.mapTags(e,!1,function(t){t.dispatchEvent(n)})}}]),t}()}),require.register("base/Model.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Model=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=e("./Cache"),a=e("./Bindable");e("./Repository"),t.Model=function(){function t(e){r(this,t),this.repository=e}return i(t,[{key:"consume",value:function(e){for(var n in e){var r=e[n];if(e[n]instanceof Object&&e[n]["class"]&&e[n].publicId){var i=e[n]["class"]+"::"+e[n].publidId,s=o.Cache.load(i,!1,"model-type-repo");r=a.Bindable.makeBindable(new t(this.repository)),s&&(r=s),r.consume(e[n]),o.Cache.store(i,r,0,"model-type-repo")}this[n]=r}}}]),t}()}),require.register("base/Persist.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Persist=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=(e("./View"),e("./Bindable"));t.Persist=function(){function t(){r(this,t)}return o(t,null,[{key:"watch",value:function(e,n){var r={},o="Persist::["+e+"]",s=localStorage.getItem(o),u=void 0;n=a.Bindable.makeBindable(n);var l=n.bindTo(function(a,s,u,l,c){if(r[s]){if(a!==c)for(;r[s].length;)r[s].pop()()}else r[s]=[];"object"===("undefined"==typeof a?"undefined":i(a))&&r[s].push(t.watch(e+"::"+s,a)),localStorage.setItem(o,JSON.stringify(n))},{delay:0});if(u=JSON.parse(s))for(var c in u)n[c]=u[c];return function(){l();for(var t in r)for(;r[t].length;)r[t].pop()();localStorage.removeItem(o)}}}]),t}()}),require.register("base/Repository.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Repository=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=e("./Bindable"),s=e("./Router"),u=e("./Cache"),l=e("./Model"),c=e("./Bag"),f=e("../form/Form"),d=e("../form/multiField/FormWrapper"),p=function(){function t(e){r(this,t),this.uri=e}return o(t,[{key:"get",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this.uri+"/"+e,a=u.Cache.load(o+s.Router.queryToString(s.Router.queryOver(i),!0),!1,"model-uri-repo");return!r&&a?Promise.resolve(a):t.request(o,i).then(function(t){return n.extractModel(t.body)})}},{key:"page",value:function(){var e=this,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments[1]);return t.request(this.uri,n).then(function(t){var n=[];for(var r in t.body){var i=t.body[r];n.push(e.extractModel(i))}return t.body=n,t})}},{key:"edit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.uri+"/create";return e&&(i=this.uri+"/"+e+"/edit"),n?t.request(i,{api:"json"},n).then(function(t){return t.body}):t.request(i).then(function(t){var e=new f.Form(t.meta.form,r);return new d.FormWrapper(e,i,"POST",r)})}},{key:"extractModel",value:function(t){var e=a.Bindable.makeBindable(new l.Model(this));e.consume(t);var n=this.uri+"/"+e.publicId;if(u.Cache.store(n,e,10,"model-uri-repo"),e["class"]){var r=e["class"]+"::"+e.publidId;u.Cache.load(r,!1,"model-type-repo");u.Cache.store(r,e,10,"model-type-repo")}return e}}],[{key:"loadPage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.request(this.uri,t).then(function(t){return t})}},{key:"domCache",value:function(t,e){}},{key:"load",value:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.objects=this.objects||{},this.objects[this.uri]=this.objects[this.uri]||{},this.objects[this.uri][t]?Promise.resolve(this.objects[this.uri][t]):this.request(this.uri+"/"+t).then(function(t){})}},{key:"form",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.uri+"/create";return t&&(e=this.uri+"/"+t+"/edit"),this.request(e).then(function(t){return t})}},{key:"clearCache",value:function(){this.objects&&this.objects[this.uri]&&(this.objects[this.uri]={})}},{key:"encode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n||(n=new FormData);for(var r in t){var o=r;e&&(o=e+"["+o+"]"),t[r]&&"object"!==i(t[r])?n.append(o,t[r]):this.encode(t[r],o,n)}return n}},{key:"onResponse",value:function(t){return this._onResponse||(this._onResponse=new c.Bag),this._onResponse.add(t)}},{key:"request",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a="GET",s="",u=null,l={};e&&(l=e),this._onResponse||(this._onResponse=new c.Bag),l.api=l.api||"json",s=Object.keys(l).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(l[t])}).join("&");var f=t;n&&(i=!1,a="POST",u=n instanceof FormData?n:this.encode(n)),f=t+"?"+s;var d=new XMLHttpRequest;if("responseType"in o&&(d.responseType=o.responseType),!n&&i&&this.cache&&this.cache[f])return Promise.resolve(this.cache[f]);var p='script[data-uri="'+f+'"]',v=document.querySelector(p);if(!n&&i&&v){var h=JSON.parse(v.innerText);return Promise.resolve(h)}d.withCredentials=!0;var g=document.createElement("a");g.href=f;var b=g.pathname;n||(d.timeout=15e3,this.xhrs[b]=d);var y=new Promise(function(t,e){n&&"progressUp"in o&&(d.upload.onprogress=o.progressUp),"progressDown"in o&&(d.onprogress=o.progressDown),d.onreadystatechange=function(){var n=4,i=200,o=void 0;if(d.readyState===n){if(r.cache||(r.cache={}),"application/json"==d.getResponseHeader("Content-Type")||"application/json; charset=utf-8"==d.getResponseHeader("Content-Type")||"text/json"==d.getResponseHeader("Content-Type")||"text/json; charset=utf-8"==d.getResponseHeader("Content-Type"))if(o=JSON.parse(d.responseText),0==o.code){var a=document.querySelector('script[data-uri="'+f+'"]'),s=window.prerenderer;s&&(a||(a=document.createElement("script"),a.type="text/json",a.setAttribute("data-uri",f),document.head.appendChild(a)),a.innerText=JSON.stringify(o));var u=r._onResponse.items();for(var l in u)u[l](o,!0);o._http=d.status,d.status===i?t(o):e(o)}else{var c=r._onResponse.items();for(var p in c)c[p](o,!0);e(o)}else{var v=r._onResponse.items();for(var h in v)v[h](d,!0);d.status===i?t(d):e(d)}delete r.xhrs[b]}},d.open(a,f,!0),d.send(u)});return y}},{key:"cancel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:/^.$/;for(var e in this.xhrs)this.xhrs[e]&&e.match(t)&&this.xhrs[e].abort();this.xhrList=[]}},{key:"xhrs",get:function(){return this.xhrList=this.xhrList||[]}}]),t}();t.Repository=p}),require.register("base/Router.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Router=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=e("./View"),a=(e("./Cache"),e("Config"));t.Router=function(){function t(){r(this,t)}return i(t,null,[{key:"wait",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DOMContentLoaded",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document;r.addEventListener(n,function(){e.listen(t)})}},{key:"listen",value:function(t){var e=this,n=[location.toString()],r=history.length,i=location.pathname+location.search;location.hash&&(i+=location.hash),window.addEventListener("popstate",function(i){i.preventDefault(),n.length&&r==history.length?location.toString()==n[n.length-2]?n.pop():n.push(location.toString()):(n.push(location.toString()),r=history.length),e.match(location.pathname,t)}),this.go(i)}},{key:"go",value:function(t,e){var n=this;document.title=a.Config.title,setTimeout(function(){history.pushState(null,null,t),e||(e===!1&&(n.path=null),window.dispatchEvent(new Event("popstate")),"#"===t.substring(0,1)&&window.dispatchEvent(new HashChangeEvent("hashchange")))},0)}},{key:"match",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.path!==t||r){var i=new CustomEvent("cvRouteStart",{cancelable:!0,detail:{result:y,path:t,view:e}}),a=e.args.content,s=e.routes;this.path=t,this.query={};var u=new URLSearchParams(location.search);this.queryString=location.search;var l=!0,c=!1,f=void 0;try{for(var d,p=u[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var v=d.value;this.query[v[0]]=v[1]}}catch(h){c=!0,f=h}finally{try{!l&&p["return"]&&p["return"]()}finally{if(c)throw f}}var g={},b=!1,y="";t=t.substr(1).split("/");for(var _ in this.query)g[_]=this.query[_];t:for(var m in s){var w=m.split("/");if(!(w.length<t.length)){for(var k in w)if("%"==w[k].substr(0,1)){var O=null,j=/^%(\w+)\??/.exec(w[k]);if(j&&j[1]&&(O=j[1]),!O)throw new Error(w[k]+' is not a valid argument segment in route "'+m+'"');if(t[k])g[O]=t[k];else{if("?"!=w[k].substr(w[k].length-1,1))continue t;g[O]=""}}else if(t[k]!==w[k])continue t;if(!r&&a&&s[m]instanceof Object&&a instanceof s[m]&&!(s[m]instanceof Promise)&&a.update(g))return e.args.content=a,!0;b=m,y=s[m];break}}if(document.dispatchEvent(i),b in s&&s[b]instanceof Object&&s[b].isView&&s[b].isView())y=new s[b](g),y.root=function(){return e};else if(s[b]instanceof Function){y="";var T=s[b](g);T instanceof Promise?(y=!1,T.then(function(r){n.update(e,t,r)})["catch"](function(r){n.update(e,t,r)})):y=T}else s[b]instanceof Promise?(y=!1,s[b].then(function(r){n.update(e,t,r)})["catch"](function(r){n.update(e,t,r)})):s[b]instanceof Object?y=new s[b](g):"string"==typeof s[b]&&(y=s[b]);return this.update(e,t,y),y instanceof o.View&&(y.pause(!1),y.update(g,r)),b!==!1}}},{key:"update",value:function(t,e,n){var r=new CustomEvent("cvRoute",{cancelable:!0,detail:{result:n,path:e,view:t}}),i=new CustomEvent("cvRouteEnd",{cancelable:!0,detail:{result:n,path:e,view:t}});n!==!1&&(t.args.content instanceof o.View&&t.args.content.remove(),document.dispatchEvent(r)&&(t.args.content=n),document.dispatchEvent(i))}},{key:"clearCache",value:function(){}},{key:"queryOver",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new URLSearchParams(location.search),n={},r=[],i=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;r[l[0]]=l[1]}}catch(c){o=!0,a=c}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}for(var f in r)n[f]=r[f];for(var d in t)n[d]=t[d];return delete n.api,n}},{key:"queryToString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=t;e||(r=this.queryOver(t));for(var i in r)""!==r[i]&&n.push(i+"="+encodeURIComponent(r[i]));return n.join("&")}},{key:"setQuery",value:function(t,e,n){var r={};r[t]=e,this.go(this.path+"?"+this.queryToString(r),n)}}]),t}()}),require.register("base/RuleSet.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.RuleSet=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=(e("./Dom"),e("./Tag")),a=e("./View");t.RuleSet=function(){function t(){r(this,t)}return i(t,[{key:"add",value:function(t,e){return this.rules=this.rules||{},this.rules[t]=this.rules[t]||[],this.rules[t].push(e),this}},{key:"apply",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t.apply(e,n);for(var r in this.rules)for(var i in this.rules[r]){var o=this.rules[r][i],a=t.wrap(e,o,n),s=e.querySelectorAll(r),u=!0,l=!1,c=void 0;try{for(var f,d=s[Symbol.iterator]();!(u=(f=d.next()).done);u=!0){var p=f.value;a(p)}}catch(v){l=!0,c=v}finally{try{!u&&d["return"]&&d["return"]()}finally{if(l)throw c}}}}}],[{key:"add",value:function(t,e){return this.globalRules=this.globalRules||{},this.globalRules[t]=this.globalRules[t]||[],this.globalRules[t].push(e),this}},{key:"apply",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var n in this.globalRules)for(var r in this.globalRules[n]){var i=this.globalRules[n][r],o=this.wrap(t,i,e),a=t.querySelectorAll(n),s=!0,u=!1,l=void 0;try{for(var c,f=a[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){var d=c.value;o(d)}}catch(p){u=!0,l=p}finally{try{!s&&f["return"]&&f["return"]()}finally{if(u)throw l}}}}},{key:"wait",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"DOMContentLoaded",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,r=function(e,n){return function(){return n.removeEventListener(e,r),t.apply()}}(e,n);n.addEventListener(e,r)}},{key:"wrap",value:function(t,e){
var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(e instanceof a.View||e&&e.prototype&&e.prototype instanceof a.View)&&(e=function(t){return function(){return t}}(e)),function(t){t.___cvApplied___||(Object.defineProperty(t,"___cvApplied___",{enumerable:!1,writable:!0}),t.___cvApplied___=[]);for(var r in t.___cvApplied___)if(e==t.___cvApplied___[r])return;var i=void 0,s=void 0;n&&(i=s=n,n.viewList&&(s=n.viewList.parent));var u=new o.Tag(t,s,null,(void 0),i),l=u.element.parentNode,c=u.element.nextSibling,f=e(u);if(f!==!1&&t.___cvApplied___.push(e),f instanceof HTMLElement&&(f=new o.Tag(f)),f instanceof o.Tag){if(!f.element.contains(u.element)){for(;u.element.firstChild;)f.element.appendChild(u.element.firstChild);u.remove()}c?l.insertBefore(f.element,c):l.appendChild(f.element)}f&&f.prototype&&f.prototype instanceof a.View&&(f=new f),f instanceof a.View&&(n&&(n.cleanup.push(function(t){return function(){t.remove()}}(f)),f.parent=n,n.cleanup.push(n.args.bindTo(function(t,e,n){n[e]=t,f.args[e]=t})),n.cleanup.push(f.args.bindTo(function(t,e,r,i){r[e]=t,n.args[e]=t}))),u.clear(),f.render(u.element))}}}]),t}()}),require.register("base/Tag.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Tag=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=e("./Bindable");t.Tag=function(){function t(e,n,i,a,s){r(this,t),this.element=o.Bindable.makeBindable(e),this.parent=n,this.direct=s,this.ref=i,this.index=a,this.cleanup=[],this.proxy=o.Bindable.makeBindable(this)}return i(t,[{key:"remove",value:function(){o.Bindable.clearBindings(this);for(var t=void 0;t=this.cleanup.shift();)t();if(this.clear(),this.element){var e=new Event("cvDomDetached");this.element.dispatchEvent(e),this.element.remove(),this.element=this.ref=this.parent=null}}},{key:"clear",value:function(){if(this.element)for(var t=new Event("cvDomDetached");this.element.firstChild;)this.element.firstChild.dispatchEvent(t),this.element.removeChild(this.element.firstChild)}},{key:"pause",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}}]),t}()}),require.register("base/Theme.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.Theme=function(){function t(){r(this,t),this.views={"SeanMorris\\TheWhtRbt\\Location":{single:"twr9/LocationPreview",list:"twr9/LocationList"},"SeanMorris\\TheWhtRbt\\Image":{single:"DetailView",list:"DetailListView"}}}return i(t,[{key:"resolve",value:function(t){var e=void 0;if(Array.isArray(t)){for(var n in t){var r=t[n]["class"]||t[n].content_type;if(e&&e!==r)throw new Error("Model list mismatch!");e=r}return this.views[e]?this.views[e].list?this.views[e].list:this.views[e]:"DetailListView"}return!!t&&(e=t["class"]||t.content_type,this.views[e]?this.views[e].single?this.views[e].single:this.views[e]:"DetailView")}}]),t}()}),require.register("base/View.js",function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0;var o=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=e("./Bindable"),u=e("./ViewList"),l=e("./Router"),c=(e("./Cookie"),e("./Dom")),f=(e("./Tag"),e("./RuleSet"));t.View=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),Object.defineProperty(this,"___VIEW___",{enumerable:!1,writable:!0}),this.___VIEW___=t,this.args=s.Bindable.makeBindable(e),this._id=this.uuid(),this.args._id=this._id,this.template="",this.document="",this.firstNode=null,this.lastNode=null,this.nodes=null,this.cleanup=[],this.attach=[],this.detach=[],this.eventCleanup=[],this.parent=null,this.viewList=null,this.viewLists={},this.withViews={},this.tags={},this.intervals=[],this.timeouts=[],this.frames=[],this.ruleSet=new f.RuleSet,this.preRuleSet=new f.RuleSet,this.subBindings={},this.removed=!1,this.preserve=!1,this.interpolateRegex=/(\[\[((?:\$)?[\w\.]+)\]\])/g}return a(t,[{key:"onFrame",value:function(t){var e=function n(e){t(e),window.requestAnimationFrame(n)};e()}},{key:"onTimeout",value:function(t,e){var n=this,r=function(){n.timeouts[o].fired=!0,n.timeouts[o].callback=null,e()},i=setTimeout(r,t),o=this.timeouts.length;return this.timeouts.push({timeout:i,callback:r,time:t,fired:!1,created:(new Date).getTime(),paused:!1}),i}},{key:"clearTimeout",value:function(t){for(var e in this.timeouts)t===this.timeouts[e].timeout&&(clearInterval(this.timeouts[e].timeout),delete this.timeouts[e])}},{key:"onInterval",value:function(t,e){var n=setInterval(e,t);return this.intervals.push({timeout:n,callback:e,time:t,paused:!1}),n}},{key:"clearInterval",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){for(var e in this.intervals)t===this.intervals[e].timeout&&(clearInterval(this.intervals[e].timeout),delete this.intervals[e])})},{key:"pause",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(void 0===t&&(this.paused=!this.paused),this.paused=t,this.paused){for(var e in this.timeouts)this.timeouts[e].fired?delete this.timeouts[e]:clearTimeout(this.timeouts[e].timeout);for(var n in this.intervals)clearInterval(this.intervals[n].timeout)}else{for(var r in this.timeouts)this.timeouts[r].timeout.paused&&(this.timeouts[r].fired?delete this.timeouts[r]:this.timeouts[r].timeout=setTimeout(this.timeouts[r].callback,this.timeouts[r].time));for(var i in this.intervals)this.intervals[i].timeout.paused&&(this.intervals[i].timeout.paused=!1,this.intervals[i].timeout=setInterval(this.intervals[i].callback,this.intervals[i].time))}for(var o in this.viewLists){if(!this.viewLists[o])return;this.viewLists[o].pause(!!t)}for(var a in this.tags)if(Array.isArray(this.tags[a]))for(var s in this.tags[a])this.tags[a][s].pause(!!t);else this.tags[a].pause(!!t)}},{key:"render",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(r instanceof t&&(r=r.firstNode),this.nodes){for(var i in this.detach)this.detach[i]();var o=function(t){var i=new Event("cvDomDetached",{bubbles:!0,target:e.nodes[t]}),o=new Event("cvDomAttached",{bubbles:!0,target:e.nodes[t]});e.nodes[t].dispatchEvent(i),c.Dom.mapTags(e.nodes[t],!1,function(t){t.dispatchEvent(i)}),n&&(r?n.insertBefore(e.nodes[t],r):n.appendChild(e.nodes[t])),c.Dom.mapTags(e.nodes[t],!1,function(t){t.dispatchEvent(o)}),e.nodes[t].dispatchEvent(o)};for(var a in this.nodes)o(a);for(var s in this.attach)this.attach[s]()}else{var u=void 0;this.template==document?u=this.template:this.document?u=this.document:(u=document.createRange().createContextualFragment(this.template),this.document=u),this.preRuleSet.apply(u,this),c.Dom.mapTags(u,!1,function(t){t.matches?(t.matches("[cv-each]")&&e.mapEachTags(t),t.matches("[cv-with]")&&e.mapWithTags(t),t.matches("[cv-prerender]")&&e.mapPrendererTags(t),t.matches("[cv-link]")&&e.mapLinkTags(t),t.matches("[cv-bind]")&&e.mapBindTags(t),t.matches("[cv-attr]")&&e.mapAttrTags(t),e.mapInterpolatableTags(t),t.matches("[cv-expand]")&&e.mapExpandableTags(t),t.matches("[cv-if]")&&e.mapIfTags(t),t.matches("[cv-ref]")&&e.mapRefTags(t),t.matches("[cv-on]")&&e.mapOnTags(t)):e.mapInterpolatableTags(t)}),this.ruleSet.apply(u,this),this.nodes=[],window.devmode===!0?this.firstNode=document.createComment("Template "+this._id+" Start"):this.firstNode=document.createTextNode(""),this.nodes.push(this.firstNode),n&&(r?n.insertBefore(this.firstNode,r):n.appendChild(this.firstNode));for(var l=function(){var t=u.firstChild,i=new Event("cvDomAttached",{bubbles:!0,target:t});e.nodes.push(t),n&&(r?n.insertBefore(t,r):n.appendChild(t)),c.Dom.mapTags(t,!1,function(t){t.dispatchEvent(i)}),t.dispatchEvent(i)};u.firstChild;)l();window.devmode===!0?this.lastNode=document.createComment("Template "+this._id+" End"):this.lastNode=document.createTextNode(""),this.nodes.push(this.lastNode),n&&(r?n.insertBefore(this.lastNode,r):n.appendChild(this.lastNode));for(var f in this.attach)this.attach[f]();this.postRender(n)}}},{key:"mapExpandableTags",value:function(t){var e=this,n=t.getAttribute("cv-expand"),r=s.Bindable.makeBindable(this.args[n]||{});t.removeAttribute("cv-expand");var i=function(n){if("name"==n||"type"==n)return"continue";var i=r.bindTo(n,function(t,e){return function(n){t.setAttribute(e,n)}}(t,n));e.cleanup.push(function(){i(),r.isBound()&&s.Bindable.clearBindings(r)})};for(var o in r){i(o)}}},{key:"mapAttrTags",value:function(t){var e=this,n=t.getAttribute("cv-attr");t.removeAttribute("cv-attr");var r=n.split(","),i=r.map(function(t){return t.split(":")}),a=function(n){var r=e.args,a=i[n][1],u=a;if(a.match(/\./)){var l=s.Bindable.resolve(e.args,a,!0),c=o(l,2);r=c[0],u=c[1]}r[i[n][1]]&&t.setAttribute(i[n][0],r[i[n][1]]);var f=i[n][0];e.cleanup.push(r.bindTo(u,function(e){return null==e?void t.setAttribute(f,""):void t.setAttribute(f,e)}))};for(var u in i)a(u)}},{key:"mapInterpolatableTags",value:function(e){var n=this,r=this.interpolateRegex;if(e.nodeType==Node.TEXT_NODE){var i=e.nodeValue;if(!this.interpolatable(i))return;for(var a=0,u=void 0,l=function(){var r=u[2],l=!1;if("$"===r.substr(0,1)&&(l=!0,r=r.substr(1)),"000"===r.substr(0,3))return expand=!0,r=r.substr(3),"continue";var c=i.substring(a,u.index);a=u.index+u[1].length;var f=document.createTextNode(c);e.parentNode.insertBefore(f,e);var d=void 0;d=l?document.createElement("div"):document.createTextNode("");var p=n.args,v=r;if(r.match(/\./)){var h=s.Bindable.resolve(n.args,r,!0),g=o(h,2);p=g[0],v=g[1]}e.parentNode.insertBefore(d,e);var b=p.bindTo(v,function(r,i){return function(o,a,s){s[a]instanceof t&&s[a]!==o&&(s[a].preserve||s[a].remove()),r.nodeValue="",o instanceof t?(o.render(e.parentNode,r),n.cleanup.push(function(){o.preserve||o.remove()})):(o instanceof Object&&o.__toString instanceof Function&&(o=o.__toString()),i?r.innerHTML=o:r.nodeValue=o)}}(d,l));n.cleanup.push(function(){b(),p.isBound()||s.Bindable.clearBindings(p)})};u=r.exec(i);){l()}var c=i.substring(a),f=document.createTextNode(c);e.parentNode.insertBefore(f,e),e.nodeValue=""}if(e.nodeType==Node.ELEMENT_NODE)for(var d=function(t){if(!n.interpolatable(e.attributes[t].value))return"continue";for(var i=0,a=void 0,u=e.attributes[t].value,l=e.attributes[t],c={},f=[];a=r.exec(u);)f.push(u.substring(i,a.index)),c[a[2]]||(c[a[2]]=[]),c[a[2]].push(f.length),f.push(a[1]),i=a.index+a[1].length;f.push(u.substring(i));var d=function(t){var r=n.args,i=t;if(t.match(/\./)){var a=s.Bindable.resolve(n.args,t,!0),u=o(a,2);r=u[0],i=u[1]}var d=t,p=r.bindTo(i,function(t,n,r,o){for(var a in c)for(var s in c[d])f[c[d][s]]=r[a],n===i&&(f[c[d][s]]=t);e.setAttribute(l.name,f.join(""))});n.cleanup.push(function(){p(),r.isBound()||s.Bindable.clearBindings(r)})};for(var p in c)d(p)},p=0;p<e.attributes.length;p++){d(p)}}},{key:"mapRefTags",value:function(t){var e=t.getAttribute("cv-ref"),n=e.split(":"),r=o(n,3),i=r[0],a=r[1],s=r[2],u=this.stringToClass(a);t.removeAttribute("cv-ref"),Object.defineProperty(t,"___tag___",{enumerable:!1,writable:!0}),this.cleanup.push(function(){t.___tag___=null,t.remove()});var l=this,c=this;this.viewList&&(l=this.viewList.parent);var f=new u(t,this,i,(void 0),c);for(t.___tag___=f;l;){!l.parent;var d=this.args[s];void 0!==d?(l.tags[i]||(l.tags[i]=[]),l.tags[i][d]=f):l.tags[i]=f,l=l.parent}}},{key:"mapBindTags",value:function(e){var n=this,r=e.getAttribute("cv-bind"),i=this.args,a=r,u=null;if(r.match(/\./)){var l=s.Bindable.resolve(this.args,r,!0),c=o(l,3);i=c[0],a=c[1],u=c[2]}i!==this.args&&(this.subBindings[r]=this.subBindings[r]||[],this.cleanup.push(this.args.bindTo(u,function(){for(;n.subBindings.length;)console.log("HERE!"),n.subBindings.shift()()})));var f=i.bindTo(a,function(n,r,i,o,a){if(a instanceof t&&a!==n&&a.remove(),"INPUT"!=e.tagName&&"SELECT"!=e.tagName&&"TEXTAREA"!=e.tagName)n instanceof t?n.render(e):e.innerText=n;else{var s=e.getAttribute("type");if(s&&"checkbox"==s.toLowerCase())e.checked=!!n;else if(s&&"radio"==s.toLowerCase())e.checked=n==e.value;else if("file"!==s){if("SELECT"==e.tagName)for(var u in e.options){var l=e.options[u];l.value==n&&(e.selectedIndex=u)}e.value=null==n?"":n}}});i!==this.args&&this.subBindings[r].push(f),this.cleanup.push(f);var d=function(t){if(t.target===e){var n=e.getAttribute("type"),r=e.getAttribute("multiple");n&&"checkbox"==n.toLowerCase()?e.checked?i[a]=t.target.value:i[a]=!1:"file"!==n?i[a]=t.target.value:"file"==n&&r&&(i[a]=Array.from(t.target.files))}};e.addEventListener("input",d),e.addEventListener("change",d),e.addEventListener("value-changed",d),this.cleanup.push(function(t,e){return function(){t.removeEventListener("input",d),t.removeEventListener("change",d),t.removeEventListener("value-changed",d),t=void 0,e=void 0}}(e,d)),e.removeAttribute("cv-bind")}},{key:"mapOnTags",value:function(t){var e=this;String(t.getAttribute("cv-on")).split(/;/).map(function(t){return t.split(":")}).map(function(t,n){return function(i){var o=i[0].replace(/(^[\s\n]+|[\s\n]+$)/,""),a=i[1],s=[],u=/(\w+)(?:\(([$\w\s'",]+)\))?/.exec(a);u.length&&(a=u[1].replace(/(^[\s\n]+|[\s\n]+$)/,""),u[2]&&(s=u[2].split(",").map(function(t){return t.trim()})));for(var l=void 0,c=e;c;){if("function"==typeof c[a]){var f=function(){var t=c,e=a;return l=function(){t[e].apply(t,arguments)},"break"}();if("break"===f)break}if(c.viewList&&c.viewList.parent)c=c.viewList.parent;else{if(!c.parent)break;c=c.parent}}var d=function(t,n,i,o){return function(t){var u=s.map(function(r){var i=void 0;return parseInt(r)==r?r:"event"===r||"$event"===r?t:"$view"===r?n:"$tag"===r?o:"$parent"===r?e.parent:"$subview"===r?e:r in e.args?e.args[r]:(i=/^['"](\w+?)["']$/.exec(r))?i[1]:void 0});if("function"!=typeof i)throw new Error(a+" is not defined on View object.\n\nTag:\n\n"+o.outerHTML);i.apply(void 0,r(u))}}(t,c,l,n);switch(o){case"_init":d();break;case"_attach":e.attach.push(d);break;case"_detach":e.detach.push(d);break;default:n.addEventListener(o,d),e.cleanup.push(function(){n.removeEventListener(o,d)})}return[o,a,s]}}(this,t));t.removeAttribute("cv-on")}},{key:"mapLinkTags",value:function(t){var e=t.getAttribute("cv-link");t.setAttribute("href",e);var n=function(n){return n.preventDefault(),"http"==e.substring(0,4)||"//"==e.substring(0,2)?void window.open(t.getAttribute("href",e)):void l.Router.go(t.getAttribute("href"))};t.addEventListener("click",n),this.cleanup.push(function(t,e){return function(){t.removeEventListener("click",e),t=void 0,e=void 0}}(t,n)),t.removeAttribute("cv-link")}},{key:"mapPrendererTags",value:function(t){var e=t.getAttribute("cv-prerender"),n=window.prerenderer;("never"==e&&n||"only"==e&&!n)&&t.parentNode.removeChild(t)}},{key:"mapWithTags",value:function(e){var n=this,r=e.getAttribute("cv-with"),i=e.getAttribute("cv-carry");e.removeAttribute("cv-with"),e.removeAttribute("cv-carry");var o=e.innerHTML,a=[];i&&(a=i.split(",").map(function(t){return t.trim()}));var u=this.args.bindTo(r,function(r,i,u,l){for(n.withViews[i]&&n.withViews[i].remove();e.firstChild;)e.removeChild(e.firstChild);var c=new t;n.cleanup.push(function(t){return function(){t.remove()}}(c)),c.template=o,c.parent=n;var f=function(t){var e=n.args.bindTo(a[t],function(t,e){c.args[e]=t});c.cleanup.push(e),n.cleanup.push(function(){e(),c.remove()})};for(var d in a)f(d);var p=function(t){var e=r.bindTo(t,function(t,e){c.args[e]=t});n.cleanup.push(function(){e(),r.isBound()||s.Bindable.clearBindings(r),c.remove()}),c.cleanup.push(function(){e(),r.isBound()||s.Bindable.clearBindings(r)})};for(var d in r)p(d);c.render(e),n.withViews[i]=c});this.cleanup.push(u)}},{key:"mapEachTags",value:function(e){var n=this,r=e.getAttribute("cv-each");e.removeAttribute("cv-each");for(var i=e.innerHTML;e.firstChild;)e.removeChild(e.firstChild);var a=r.split(":"),s=o(a,3),l=s[0],c=s[1],f=s[2],d=this.args.bindTo(l,function(r,o,a,s,d){n.viewLists[l]&&n.viewLists[l].remove();var p=new u.ViewList(i,c,r,n,f);n.cleanup.push(function(){p.remove()});var v=n.args.bindTo(function(t,e,n,r){"_id"!=e&&p.args.subArgs[e]!==t&&(p.args.subArgs[e]=t)});for(var h in n.args)"_id"!=h&&(p.args.subArgs[o]=n.args[h]);var g=p.args.bindTo(function(e,r,i,o,a){if("_id"!=r&&"___"!==r.substring(0,3)){var s=e,u=a;e instanceof t&&(s=e.___ref___),a instanceof t&&(u=a.___ref___),s!==u&&i[r]instanceof t&&i[r].remove(),r in n.args&&s!==u&&(n.args[r]=e)}},{wait:0});for(n.cleanup.push(function(){v(),g()});e.firstChild;)e.removeChild(e.firstChild);n.viewLists[l]=p,p.render(e)});this.cleanup.push(function(){d()})}},{key:"mapIfTags",value:function(e){var n=e.getAttribute("cv-if");e.removeAttribute("cv-if");var r=e.innerHTML,i=!1;for("!"===n.substr(0,1)&&(i=!0,n=n.substr(1));e.firstChild;)e.removeChild(e.firstChild);var a=document.createRange().createContextualFragment(""),u=new t;u.template=r,u.parent=this;for(var l=this.syncBind(u),c=this;c.parent;)c=c.parent;this.cleanup.push(function(){l()}),u.render(e);var f=this.args,d=n;if(n.match(/\./)){var p=s.Bindable.resolve(this.args,n,!0),v=o(p,2);f=v[0],d=v[1]}var h=f.bindTo(d,function(t,n){if(Array.isArray(t)&&(t=!!t.length),i&&(t=!t),t)u.render(e);else{for(;e.firstChild;)e.firstChild.remove();u.render(a)}});this.cleanup.push(function(){h(),f.isBound()||s.Bindable.clearBindings(f)})}},{key:"syncBind",value:function(e){var n=this,r=this.args.bindTo(function(t,n,r,i){"_id"!=n&&e.args[n]!==t&&(e.args[n]=t)});for(var i in this.args)"_id"!=i&&(e.args[i]=this.args[i]);var o=e.args.bindTo(function(e,r,i,o,a){if("_id"!=r){var s=e,u=a;e instanceof t&&(s=e.___ref___),a instanceof t&&(u=a.___ref___),s!==u&&a instanceof t&&a.remove(),r in n.args&&s!==u&&(n.args[r]=e)}},{wait:0});return function(){r(),o()}}},{key:"postRender",value:function(t){}},{key:"interpolatable",value:function(t){return!!String(t).match(this.interpolateRegex)}},{key:"uuid",value:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})}},{key:"remove",value:function(){var t=new Event("cvDomDetached");for(var e in this.tags)if(Array.isArray(this.tags[e]))for(var n in this.tags[e])this.tags[e][n].remove();else this.tags[e].remove();for(var r in this.nodes)this.nodes[r].dispatchEvent(t),this.nodes[r].remove();for(var i=void 0;i=this.cleanup.shift();)i();for(var o in this.viewLists)this.viewLists[o]&&this.viewLists[o].remove();this.viewLists=[];for(var a in this.timeouts)clearInterval(this.timeouts[a].timeout),delete this.timeouts[a];for(var s in this.intervals)clearInterval(this.intervals[s].timeout),delete this.intervals[s];this.removed=!0}},{key:"update",value:function(){}},{key:"beforeUpdate",value:function(t){}},{key:"afterUpdate",value:function(t){}},{key:"stringToClass",value:function(t){var n=t.split("/"),r=n[n.length-1],i=e(t);return i[r]}}],[{key:"isView",value:function(){return t}}]),t}()}),require.register("base/ViewList.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.ViewList=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=e("./Bindable"),a=e("./View"),s=function(){function t(e,n,i,a){var s=this,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;r(this,t),this.args=o.Bindable.makeBindable({}),this.args.value=o.Bindable.makeBindable(i||{}),this.args.subArgs=o.Bindable.makeBindable({}),this.views=[],this.cleanup=[],this.template=e,this.subProperty=n,this.keyProperty=u,this.tag=null,this.paused=!1,this.parent=a,this.args.value.___before___.push(function(t){"bindTo"!=t.___executing___&&(s.paused=!0)}),this.args.value.___after___.push(function(t){"bindTo"!=t.___executing___&&(s.paused=t.___stack___.length>1,s.reRender())});var l=this.args.value.bindTo(function(t,e,n,r){if(!s.paused)if(r){s.views[e]&&s.views[e].remove(),s.views.splice(e,1);for(var i in s.views)s.views[i].args[s.keyProperty]=i}else s.views[e]||s.reRender()},{wait:0});this.cleanup.push(l)}return i(t,[{key:"render",value:function(t){for(var e in this.views)this.views[e].render(t);this.tag=t}},{key:"reRender",value:function(){var t=this;if(!this.paused&&this.tag){var e=[];for(var n in this.views)e[n]=this.views[n];var r=[];for(var i in this.args.value){var o=!1;for(var s in e)if(e[s]&&this.args.value[i]===e[s].args[this.subProperty]){o=!0,r[i]=e[s],r[i].args[this.keyProperty]=i,delete e[s];break}o||!function(){var e={};r[i]=new a.View(e);r[i].template=t.template,r[i].parent=t.parent,r[i].viewList=t,r[i].args[t.keyProperty]=i,r[i].args[t.subProperty]=t.args.value[i],t.cleanup.push(t.args.value.bindTo(i,function(t,e,n){})),t.cleanup.push(e.bindTo(t.subProperty,function(n,r){var i=e[t.keyProperty];t.args.value[i]=n})),t.cleanup.push(t.args.subArgs.bindTo(function(t,n,r,i){e[n]=t})),e[t.subProperty]=t.args.value[i]}()}for(var u in e){var l=!1;for(var c in r)if(e[u]===r[c]){l=!0;break}l||e[u].remove()}var f=!0;for(var d in this.views)this.views[d]!==r[d]&&(f=!1);for(var p in r)r[p]!==this.views[p]&&(e.splice(p+1,0,r[p]),r[p].render(this.tag));for(var v in r)r[v].args[this.keyProperty]=v;this.views=r}}},{key:"pause",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];for(var e in this.views)this.views[e].pause(t)}},{key:"remove",value:function(){for(var t in this.views)this.views[t].remove();for(var e=void 0;this.cleanup.length;)(e=this.cleanup.pop())();for(this.views=[];this.tag&&this.tag.firstChild;)this.tag.removeChild(this.tag.firstChild);o.Bindable.clearBindings(this.args.subArgs),o.Bindable.clearBindings(this.args),this.args.value.isBound()||o.Bindable.clearBindings(this.args.value)}}]),t}();t.ViewList=s}),require.register("form/ButtonField.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonField=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=e("./Field");t.ButtonField=function(t){function e(t,n,o,a){r(this,e);var s=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,a));return s.args.title=s.args.title||s.args.value,s.template='\n\t\t\t<label\n\t\t\t\tfor = "'+s.args.name+'"\n\t\t\t\tdata-type = "'+s.args.attrs.type+'"\n\t\t\t\tcv-ref = "label:curvature/base/Tag">\n\t\t\t\t<input\n\t\t\t\t\tname   = "'+s.args.name+'"\n\t\t\t\t\ttype   = "'+s.args.attrs.type+'"\n\t\t\t\t\tvalue  = "[[title]]"\n\t\t\t\t\tcv-on  = "click:clicked(event)"\n\t\t\t\t\tcv-ref = "input:curvature/base/Tag"\n\n\t\t\t\t\tcv-expand = "attrs"\n\t\t\t\t/>\n\t\t\t</label>\n\t\t',s}return o(e,t),a(e,[{key:"clicked",value:function(t){"submit"==this.args.attrs.type&&(t.preventDefault(),t.stopPropagation(),this.form.tags.formTag.element.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0})))}}]),e}(s.Field)}),require.register("form/Field.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Field=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=e("../base/View");e("../base/Bindable"),t.Field=function(t){function e(t,n,o,a){r(this,e);var s=Object.assign({},t),u=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,s));u.args.title=u.args.title||"",u.args.value=null===u.args.value?"":u.args.value,u.value=u.args.value,u.skeleton=s,u.disabled=null,u.args.valueString="",u.form=n,u.parent=o,u.key=a,u.ignore=u.args.attrs["data-cv-ignore"]||!1;var l="";"checkbox"==u.args.attrs.type&&(l='value = "1"'),u.template='\n\t\t\t<label\n\t\t\t\tfor           = "'+u.args.name+'"\n\t\t\t\tdata-type     = "'+u.args.attrs.type+'"\n\t\t\t\tcv-ref        = "label:curvature/base/Tag"\n\t\t\t>\n\t\t\t\t<span cv-if = "title">\n\t\t\t\t\t<span cv-ref = "title:curvature/base/Tag">[[title]]</span>\n\t\t\t\t</span>\n\t\t\t\t<input\n\t\t\t\t\tname      = "'+u.args.name+'"\n\t\t\t\t\ttype      = "'+(u.args.attrs.type||"text")+'"\n\t\t\t\t\tcv-bind   = "value"\n\t\t\t\t\tcv-ref    = "input:curvature/base/Tag"\n\t\t\t\t\tcv-expand = "attrs"\n\t\t\t\t\t'+l+"\n\t\t\t\t/>\n\t\t\t</label>\n\t\t";var c=null;return u.args.bindTo("value",function(t,e){u.value=t,c!=e&&(c=a,u.args.valueString=JSON.stringify(t||"",null,4),u.valueString=u.args.valueString,"file"==u.args.attrs.type&&u.tags.input&&u.tags.input.element.files&&u.tags.input.element.length?u.args.attrs.multiple?u.parent.args.value[a]=Array.from(u.tags.input.element.files):u.parent.args.value[a]=u.tags.input.element.files[0]:(u.parent.args.value||(u.parent.args.value={}),u.parent.args.value[a]=t),c=null)},{wait:0}),u.parent.args.value[u.key]=u.args.value,u.parent.args.value.bindTo(a,function(t,e){c!=e&&(c=e,"file"==u.args.attrs.type&&u.tags.input&&u.tags.input.element.files&&u.tags.input.element.files.length?u.args.attrs.multiple?u.parent.args.value[a]=Array.from(u.tags.input.element.files):u.parent.args.value[a]=u.tags.input.element.files[0]:u.args.value=t,c=null)}),u}return o(e,t),a(e,[{key:"disable",value:function(){this.hasChildren(),this.disabled="disabled"}},{key:"enable",value:function(){this.hasChildren(),this.disabled=!1}},{key:"hasChildren",value:function(){return!1}},{key:"getName",value:function(){return this.tags.input?this.tags.input.element.getAttribute("name"):this.args.name}}]),e}(s.View)}),require.register("form/FieldSet.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.FieldSet=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=e("./Field"),u=e("./Form");t.FieldSet=function(t){function e(t,n,o,a){r(this,e);var s=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,a));return s.args.value={},s.args.fields=u.Form.renderFields(t.children,s),s.fields=s.args.fields,s.template='\n\t\t\t<label\n\t\t\t\tfor        = "'+s.args.name+'"\n\t\t\t\tdata-type  = "'+s.args.attrs.type+'"\n\t\t\t\tdata-multi = "'+(s.args.attrs["data-multi"]?"true":"false")+'"\n\t\t\t\tcv-ref     = "label:curvature/base/Tag"\n\t\t\t>\n\t\t\t\t<span cv-if = "title">\n\t\t\t\t\t<span cv-ref = "title:curvature/base/Tag">[[title]]</span>\n\t\t\t\t</span>\n\t\t\t\t<fieldset\n\t\t\t\t\tname   = "'+s.args.name+'"\n\t\t\t\t\tcv-ref = "input:curvature/base/Tag"\n\t\t\t\t\tcv-expand="attrs"\n\t\t\t\t\tcv-each = "fields:field"\n\t\t\t\t>\n\t\t\t\t\t[[field]]\n\t\t\t\t</fieldset>\n\t\t\t</label>\n\t\t',s}return o(e,t),a(e,[{key:"hasChildren",value:function(){return!!Object.keys(this.args.fields).length}},{key:"wrapSubfield",value:function(t){return t}}]),e}(s.Field)}),require.register("form/FileField.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.FileField=void 0;var a=e("./Field");t.FileField=function(t){function e(t,n,o,a){r(this,e);var s=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,a));return s.template='\n\t\t\t<label\n\t\t\t\tfor       = "'+s.args.name+'"\n\t\t\t\tdata-type = "'+s.args.attrs.type+'"\n\t\t\t\tcv-ref    = "label:curvature/base/Tag">\n\t\t\t>\n\t\t\t\t<input\n\t\t\t\t\tname    = "'+s.args.name+'"\n\t\t\t\t\ttype    = "'+s.args.attrs.type+'"\n\t\t\t\t\tcv-bind = "value"\n\t\t\t\t\tcv-ref  = "input:curvature/base/Tag"\n\t\t\t\t\tcv-expand = "attrs"\n\t\t\t\t/>\n\t\t\t\t<span style = "display:none" cv-if = "value">[[[value]]]</span>\n\t\t\t</label>\n\t\t',s}return o(e,t),e}(a.Field)}),require.register("form/Form.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);
t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Form=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=e("../base/View"),u=e("./Field"),l=e("./FieldSet"),c=e("./SelectField"),f=e("./RadioField"),d=e("./HtmlField"),p=e("./HiddenField"),v=e("./ButtonField"),h=e("./TextareaField"),g=e("./multiField/View");t.Form=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e);var o=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,{}));return o.args.flatValue=o.args.flatValue||{},o.args.value=o.args.value||{},o.args.method=t._method||"GET",o.args.classes=o.args.classes||[],o.args.bindTo("classes",function(t){o.args._classes=t.join(" ")}),o._onSubmit=[],o._onRender=[],o.action="",o.template='\n\t\t\t<form\n\t\t\t\tclass     = "[[_classes]]"\n\t\t\t\tmethod    = "[[method]]"\n\t\t\t\tenctype   = "multipart/form-data"\n\t\t\t\tcv-on     = "submit:submit(event)"\n\t\t\t\tcv-ref    = "formTag:curvature/base/Tag"\n\t\t\t\tcv-each   = "fields:field"\n\t\t\t\tcv-expand = "attrs"\n\t\t\t>\n\t\t\t\t[[field]]\n\t\t\t</form>\n\t\t',o.args.fields=e.renderFields(t,o,n),o.fields=o.args.fields,o.args.bindTo("value",function(t){o.args.valueString=JSON.stringify(t,null,4),o.valueString=o.args.valueString,o.value=t}),o}return o(e,t),a(e,[{key:"submitHandler",value:function(t){t.preventDefault(),t.stopPropagation()}},{key:"submit",value:function(t){this.args.valueString=JSON.stringify(this.args.value,null,4);for(var e in this._onSubmit)this._onSubmit[e](this,t)}},{key:"buttonClick",value:function(t){}},{key:"onSubmit",value:function(t){this._onSubmit.push(t)}},{key:"onRender",value:function(t){this._onRender.push(t)}},{key:"formData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];t||(t=new FormData),e||(e=this);for(var r in e.args.fields)if(!e.args.fields[r]||!e.args.fields[r].disabled){var i=n.slice(0);if(i.push(r),e.args.fields[r]&&e.args.fields[r].hasChildren())this.formData(t,e.args.fields[r],i);else if(e.args.fields[r]){var o=e.args.fields[r].getName();if("file"==e.args.fields[r].args.type&&e.args.fields[r].tags.input.element.files.length)if(e.args.fields[r].args.attrs.multiple)for(var a=e.args.fields[r].tags.input.element.files,s=0;s<a.length;s++)a[s]&&t.append(o+"[]",a[s]);else e.args.fields[r].tags.input.element.files[0]&&t.append(o,e.args.fields[r].tags.input.element.files[0]);else("file"!==e.args.fields[r].args.type||e.args.fields[r].args.value)&&t.append(o,void 0===e.args.fields[r].args.value?"":e.args.fields[r].args.value)}}return t}},{key:"queryString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=[];for(var n in this.args.flatValue)t[n]=t[n]||this.args.flatValue[n];for(var r in t)e.push(r+"="+encodeURIComponent(t[r]));return e.join("&")}},{key:"populate",value:function(t){for(var e in t)this.args.value[e]=t[e]}},{key:"hasChildren",value:function(){return!!Object.keys(this.args.fields).length}},{key:"postRender",value:function(){for(var t in this._onRender)this._onRender[t](this)}}],[{key:"renderFields",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={},o=function(o){if(i[o])return"continue";if("_"==o.substr(0,1))return"continue";var a=null,s=null;if(n&&(s=n instanceof e?n:n.form),r&&t[o].name in r)a=new r[t[o].name](t[o],s,n,o);else switch(t[o].type){case"fieldset":a=t[o].attrs["data-multi"]?new g.View(t[o],s,n,o):new l.FieldSet(t[o],s,n,o);break;case"select":a=new c.SelectField(t[o],s,n,o);break;case"radios":a=new f.RadioField(t[o],s,n,o);break;case"html":a=new d.HtmlField(t[o],s,n,o);break;case"submit":case"button":a=new v.ButtonField(t[o],s,n,o);break;case"hidden":a=new p.HiddenField(t[o],s,n,o);break;case"textarea":a=new h.TextareaField(t[o],s,n,o);break;default:a=new u.Field(t[o],s,n,o)}i[o]=a,a.args.bindTo("value",function(t,e,n,r){if(("html"!=n.type||n.contentEditable)&&"fieldset"!=n.type){var i=a.getName();return n.disabled?void delete s.args.flatValue[i]:void(s.args.flatValue[i]=t)}})};for(var a in t){o(a)}return i}}]),e}(s.View)}),require.register("form/HiddenField.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.HiddenField=void 0;var a=e("./Field");t.HiddenField=function(t){function e(t,n,o,a){r(this,e);var s=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,a));return s.args.attrs.type=s.args.attrs.type||"hidden",s.template='\n\t\t\t<label\n\t\t\t\tfor       = "'+s.args.name+'"\n\t\t\t\tdata-type = "'+s.args.attrs.type+'"\n\t\t\t\tstyle     = "display:none"\n\t\t\t\tcv-ref    = "label:curvature/base/Tag">\n\t\t\t\t<input\n\t\t\t\t\t\tname      = "'+s.args.name+'"\n\t\t\t\t\t\ttype      = "'+s.args.attrs.type+'"\n\t\t\t\t\t\tcv-bind   = "value"\n\t\t\t\t\t\tcv-ref    = "input:curvature/base/Tag"\n\t\t\t\t\t\tcv-expand = "attrs"\n\t\t\t\t/>\n\t\t\t\t<span cv-if = "value">[[[value]]]</span>\n\t\t\t</label>\n\t\t',s}return o(e,t),e}(a.Field)}),require.register("form/HtmlField.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.HtmlField=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=e("../base/View");t.HtmlField=function(t){function e(t,n,o,a){r(this,e);var s=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,a));return s.ignore=s.args.attrs["data-cv-ignore"]||!1,s.args.contentEditable=s.args.attrs.contenteditable||!1,s.template='<div\n\t\t\tname            = "'+s.args.name+'"\n\t\t\tcv-ref          = "input:curvature/base/Tag"\n\t\t\tcontenteditable = "[[contentEditable]]"\n\t\t\tcv-expand       = "attrs"\n\t\t>[[$value]]</div>',s}return o(e,t),a(e,[{key:"hasChildren",value:function(){return!1}},{key:"disable",value:function(){this.args.disabled="disabled"}},{key:"getName",value:function(){return this.tags.input?this.tags.input.element.getAttribute("name"):this.args.name}}]),e}(s.View)}),require.register("form/RadioField.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.RadioField=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=e("./Field");t.RadioField=function(t){function e(t,n,o,a){r(this,e);var s=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,a));return s.template='\n\t\t\t<label\n\t\t\t\tfor       = "'+s.args.name+'"\n\t\t\t\tdata-type = "'+s.args.attrs.type+'"\n\t\t\t\tcv-ref    = "label:curvature/base/Tag">\n\t\t\t\t<span cv-if = "title">\n\t\t\t\t\t<span cv-ref = "title:curvature/base/Tag">[[title]]</span>\n\t\t\t\t</span>\n\t\t\t\t<span\n\t\t\t\t\tcv-each  = "options:option:optionText"\n\t\t\t\t\tcv-carry = "value"\n\t\t\t\t\t--cv-ref  = "input:curvature/base/Tag"\n\t\t\t\t/>\n\t\t\t\t\t<label>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tname      = "'+s.args.name+'"\n\t\t\t\t\t\t\ttype      = "radio"\n\t\t\t\t\t\t\tvalue     = "[[option]]"\n\t\t\t\t\t\t\tcv-bind   = "value"\n\t\t\t\t\t\t\tcv-expand = "attrs"\n\t\t\t\t\t/>\n\t\t\t\t\t\t[[optionText]]\n\t\t\t\t\t</label>\n\t\t\t\t</span>\n\t\t\t</label>\n\t\t',s}return o(e,t),a(e,[{key:"getLabel",value:function(){for(var t in this.args.options)if(this.args.options[t]==this.args.value)return t}}]),e}(s.Field)}),require.register("form/SelectField.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.SelectField=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=e("./Field");t.SelectField=function(t){function e(t,n,o,a){r(this,e);var s=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,a));return s.template='\n\t\t\t<label\n\t\t\t\tfor       = "'+s.args.name+'"\n\t\t\t\tdata-type = "'+s.args.attrs.type+'"\n\t\t\t\tcv-ref    = "label:curvature/base/Tag">\n\t\t\t\t<span cv-if = "title">\n\t\t\t\t\t<span cv-ref = "title:curvature/base/Tag">[[title]]</span>\n\t\t\t\t</span>\n\t\t\t\t<select\n\t\t\t\t\tname      = "'+s.args.name+'"\n\t\t\t\t\tcv-bind   = "value"\n\t\t\t\t\tcv-each   = "options:option:optionText"\n\t\t\t\t\tcv-ref    = "input:curvature/base/Tag"\n\t\t\t\t\tcv-expand = "attrs"\n\t\t\t\t/>\n\t\t\t\t\t<option value = "[[option]]">[[optionText]]</option>\n\t\t\t\t</select>\n\t\t\t</label>\n\t\t',s.args.bindTo("value",function(t,e,n,r,i){}),s}return o(e,t),a(e,[{key:"postRender",value:function(t){var e=this;this.onTimeout(0,function(){var t=e.tags.input.element;for(var n in t.options){var r=t.options[n];r.value==e.args.value&&(t.selectedIndex=n)}})}},{key:"getLabel",value:function(){for(var t in this.args.options)if(this.args.options[t]==this.args.value)return t}}]),e}(s.Field)}),require.register("form/TextareaField.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.TextareaField=void 0;var a=e("./Field");t.TextareaField=function(t){function e(t,n,o,a){r(this,e);var s=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,a));return s.args.attrs.type=s.args.attrs.type||"hidden",s.template='\n\t\t\t<label\n\t\t\t\tfor       = "'+s.args.name+'"\n\t\t\t\tdata-type = "'+s.args.attrs.type+'"\n\t\t\t\tcv-ref    = "label:curvature/base/Tag">\n\t\t\t\t<span cv-if = "title">\n\t\t\t\t\t<span cv-ref = "title:curvature/base/Tag">[[title]]</span>\n\t\t\t\t</span>\n\t\t\t\t<textarea\n\t\t\t\t\t\tname      = "'+s.args.name+'"\n\t\t\t\t\t\tcv-bind   = "value"\n\t\t\t\t\t\tcv-ref    = "input:curvature/base/Tag"\n\t\t\t\t\t\tcv-expand = "attrs"\n\t\t\t\t></textarea>\n\t\t\t\t<cv-template cv-if = "attrs.data-caption">\n\t\t\t\t\t<p>[[attrs.data-caption]]</p>\n\t\t\t\t</cv-template>\n\t\t\t</label>\n\t\t',s}return o(e,t),e}(a.Field)}),require.register("form/multiField/CreateForm.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.CreateForm=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function l(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:l(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},u=e("./FormWrapper");e("../../form/HiddenField"),t.CreateForm=function(t){function e(t,n){var o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",arguments.length>3&&void 0!==arguments[3]?arguments[3]:{});r(this,e);var a=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,"POST",o||{}));return a.creating=!!t.publicId,a}return o(e,t),a(e,[{key:"onLoad",value:function(t){for(var n in t.args.fields)if(t.args.fields[n].tags.input&&"hidden"!=t.args.fields[n].args.attrs.type){var r=t.args.fields[n].tags.input.element;r.focus();break}s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onLoad",this).call(this,t)}},{key:"onRequest",value:function(){return this.args.view.args.addIcon=this.args.view.args.loader,this.args.view.args.loading=!0,this.args.view.args.classes+=" loading",s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRequest",this).call(this)}},{key:"onResponse",value:function(t){this.args.view.args.loading=!1,this.args.view.args.classes="",this.args.wrapper?this.args.wrapper.refresh(t.body):this.args.view.addRecord(t.body),this.args.view.addButtonClicked(),this.args.view.args.addIcon="+",this.args.view.args.creating="",s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onResponse",this).call(this,t)}}]),e}(u.FormWrapper)}),require.register("form/multiField/Form.js",function(t,e,n){"use strict"}),require.register("form/multiField/FormWrapper.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.FormWrapper=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=(e("Config"),e("../../base/Repository")),u=e("../../form/Form"),l=e("../../toast/Toast"),c=(e("../../toast/ToastAlert"),e("../../base/View")),f=e("../../base/Router");t.FormWrapper=function(t){function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r(this,e);var l=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return l.path=n,l.args.method=o,l.args.action=l.args.action||null,l.args.form=null,l.args.title=null,l.args["class"]="",l.template='\n\t\t\t<div class = "form constrict [[class]]">\n\t\t\t\t<div cv-if = "title"><label>[[title]]</label></div>\n\t\t\t\t[[form]]\n\t\t\t</div>\n\t\t',l._onLoad=[],l._onSubmit=[],l._onRender=[],l._onRequest=[],l._onError=[],l._onResponse=[],n instanceof u.Form?l.loadForm(form,a):s.Repository.request(n).then(function(t){return t&&t.meta&&t.meta.form&&t.meta.form instanceof Object?(l.loadForm(new u.Form(t.meta.form,a)),void l.onLoad(l.args.form,t.body)):void console.log("Cannot render form with ",t)}),l}return o(e,t),a(e,[{key:"loadForm",value:function(t){var e=this;this.args.form=t,this.args.form.onSubmit(function(t,n){if(e.onSubmit(t,n)!==!1){n&&(n.preventDefault(),n.stopPropagation());var r=t.tags.formTag.element,i=r.getAttribute("action")||e.args.action||e.path,o=r.getAttribute("method")||e.args.method,a=t.args.flatValue;if(o=o.toUpperCase(),"GET"==o){var u={};e.args.content&&e.args.content.args&&(e.args.content.args.page=0),u.page=0;for(var l in a)"api"!==l&&(u[l]=a[l]);var c=e.onRequest(u);c.then(function(){e.onResponse({}),f.Router.go(i+"?"+f.Router.queryToString(u)),e.update(u)})["catch"](function(t){e.onRequestError(t)})}else if("POST"==o){var d=t.formData(),p=!0,v=!1,h=void 0;try{for(var g,b=d.entries()[Symbol.iterator]();!(p=(g=b.next()).done);p=!0){g.value}}catch(y){v=!0,h=y}finally{try{!p&&b["return"]&&b["return"]()}finally{if(v)throw h}}var _=e.onRequest(d);_&&_.then(function(){s.Repository.request(i,{api:"json"},d,!1,{progressDown:function(t){e.progressDown(t)},progressUp:function(t){e.progressUp(t)}}).then(function(t){e.onResponse(t)})["catch"](function(t){e.onRequestError(t)})})}}})}},{key:"onRequest",value:function(t){var e=[];for(var n in this._onRequest){var r=this._onRequest[n](t,this);r&&e.push(r)}return 0==e.length?Promise.resolve():Promise.all(e)}},{key:"onRequestError",value:function(t){for(var e in this._onError)this._onError[e](t,this);if(t.messages)for(var n in t.messages)l.Toast.instance().alert(t.body&&t.body.id?"Success!":"Error!",t.messages[n],3500)}},{key:"onResponse",value:function(t){for(var e in this._onResponse)this._onResponse[e](t,this);if(t.messages)for(var n in t.messages)l.Toast.instance().alert(t.body&&t.body.id?"Success!":"Error!",t.messages[n],3500)}},{key:"onLoad",value:function(t,e){for(var n in this._onLoad)this._onLoad[n](this,t,e)}},{key:"onSubmit",value:function(t,e){for(var n in this._onSubmit)this._onSubmit[n](this,e)}},{key:"postRender",value:function(){for(var t in this._onRender)this._onRender[t](this.args.form)}},{key:"customFields",value:function(){return{}}},{key:"submit",value:function(){}},{key:"progressUp",value:function(t){console.log(t.loaded,t.total,t.loaded/t.total)}},{key:"progressDown",value:function(t){console.log(t.loaded,t.total,t.loaded/t.total)}}]),e}(c.View)}),require.register("form/multiField/SearchForm.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.SearchForm=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function d(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:d(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},u=e("Config"),l=e("./FormWrapper"),c=e("../../form/HiddenField"),f=e("../../base/Repository");t.SearchForm=function(t){function e(t,n){arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r(this,e);var o=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,"POST",{search:c.HiddenField}));return o.superTemplate=o.template,o.args.records=[],o.selected=null,o.template="\n\t\t\t"+o.superTemplate+'\n\t\t\t<div cv-each = "records:record:r" class = "dropdown-results">\n\t\t\t\t<div\n\t\t\t\t\tcv-on         = "click:select(event)"\n\t\t\t\t\tdata-index    = "[[r]]"\n\t\t\t\t\tdata-publicId = "[[record.publicId]]"\n\t\t\t\t\tclass         = "[[record.classes]]"\n\t\t\t\t>\n\t\t\t\t\t[[record.title]]\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t',o}return o(e,t),a(e,[{key:"onLoad",value:function(t){var n=this;for(var r in t.args.fields)if(t.args.fields[r].tags.input&&"hidden"!=t.args.fields[r].args.attrs.type){var i=t.args.fields[r].tags.input.element;i.focus();break}t.args.flatValue.bindTo("keyword",function(t){n.args.records=[],n.selected=null,t&&(console.log(n.path,t),f.Repository.request(u.Config.backend+n.path,{keyword:t}).then(function(e){console.log(e.body),e.body&&(n.args.records=e.body.map(function(e){return e.classes="",e.title==t&&(e.classes="selected",n.selected=e),e}))}))}),s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onLoad",this).call(this,t)}},{key:"onRequest",value:function(){return s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRequest",this).call(this)}},{key:"onResponse",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onResponse",this).call(this,t)}},{key:"select",value:function(t){var e=t.target.getAttribute("data-index"),n=(t.target.getAttribute("data-publicId"),this.args.records[e]);console.log(n),this.args.view.addRecord(n),this.args.view.addButtonClicked()}},{key:"onSubmit",value:function(t,e){return e.preventDefault(),e.stopPropagation(),this.selected&&(this.args.view.addRecord(this.selected),this.args.view.addButtonClicked()),!1}}]),e}(l.FormWrapper)}),require.register("form/multiField/View.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=e("../../form/Form"),l=e("../../form/FieldSet"),c=e("./CreateForm"),f=e("./SearchForm"),d=(e("./FormWrapper"),e("./Wrapper"));t.View=function(t){function e(t,n,o,a){r(this,e);var s=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,a));s.args._fields=[],s.dragging=!1,s.dropping=!1;for(var u in s.args.fields)s.args._fields[u]=s.wrapSubfield(s.args.fields[u]);return s.args.fields[-1].disable(),s.args.creating="",s.args.fieldType="",s.args.createForm=s.args.createForm||"",s.args.searchForm=s.args.searchForm||"",s.setCreateForm({view:s}),s.args.loader="...",s.args.addIcon="&#215;",s.args.addIcon="a",s.args.addIcon="+",s.template='\n\t\t\t<label\n\t\t\t\tfor        = "'+s.args.name+'"\n\t\t\t\tdata-type  = "'+s.args.attrs.type+'"\n\t\t\t\tdata-multi = "'+(s.args.attrs["data-multi"]?"true":"false")+'"\n\t\t\t>\n\t\t\t\t<span cv-if = "title">\n\t\t\t\t\t<span cv-ref = "title:curvature/base/Tag">[[title]]</span>\n\t\t\t\t</span>\n\n\t\t\t\t<fieldset\n\t\t\t\t\tname  = "'+s.args.name+'"\n\t\t\t\t\tclass = "multi-field [[creating]] [[fieldType]]"\n\t\t\t\t>\n\n\t\t\t\t\t<div class = "record-list" cv-each = "_fields:field:f">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass     = "single-record"\n\t\t\t\t\t\t\tdata-for  = "[[f]]"\n\t\t\t\t\t\t\tdraggable = "true"\n\t\t\t\t\t\t\tcv-on     = "\n\t\t\t\t\t\t\t\tdrop:drop(event);\n\t\t\t\t\t\t\t\tdragstart:drag(event);\n\t\t\t\t\t\t\t\tdragend:dragStop(event);\n\t\t\t\t\t\t\t\tdragover:dragOver(event);\n\t\t\t\t\t\t\t"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t[[field]]\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class = "overlay create">\n\t\t\t\t\t\t<div class = "form constrict">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tcv-on = "click:addButtonClicked(event)"\n\t\t\t\t\t\t\t\tclass = "bubble bottom left-margin close"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t&#215;\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t[[createForm]]\n\t\t\t\t\t\t[[searchForm]]\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class = "overlay loading">\n\t\t\t\t\t\t[[loader]]\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div cv-if = "createFormReady">\n\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tcv-on = "click:addButtonClicked(event)"\n\t\t\t\t\t\t\tclass = "bubble bottom left-margin add"\n\t\t\t\t\t\t>[[addIcon]]</div>\n\n\t\t\t\t\t</div>\n\n\t\t\t\t</fieldset>\n\n\t\t\t</label>\n\t\t',s}return o(e,t),s(e,[{key:"setCreateForm",value:function(t){var e=this;this.args.createForm=new c.CreateForm(Object.assign({},t),t.publicId?this.args.attrs["data-endpoint"]+"/"+t.publicId+"/edit":this.args.attrs["data-endpoint"]+"/create"),this.args.createForm._onLoad.push(function(t,n){e.args.createFormReady=!0}),this.args.searchForm=new f.SearchForm(Object.assign({},t),this.args.attrs["data-endpoint"])}},{key:"wrapSubfield",value:function(t){return new d.Wrapper({field:t,parent:this})}},{key:"addButtonClicked",value:function(){this.args.creating||(this.args.creating="creating")}},{key:"addRecord",value:function(t){Array.isArray(t)||(t=[t]);for(var e in t){var n=(this.args.fields[-1].constructor,Object.assign({},this.args.fields[-1].skeleton)),r=Object.values(this.args.fields).length-1;n=this.cloneSkeleton(n),n=this.correctNames(n,r);var i={};i[r+1]=n;var o=u.Form.renderFields(i,this)[r+1];this.args.fields[r]=o;var a=this.wrapSubfield(o);o.args.value.id=t[e].id||"",o.args.value["class"]=t[e]["class"]||"",o.args.value.title=t[e].title||"",this.args._fields.push(a),a.refresh(t[e])}}},{key:"editRecord",value:function(t,e){this.setCreateForm({view:this,publicId:t.publicId,wrapper:e}),this.args.creating=this.args.creating?"":"creating"}},{key:"deleteImage",value:function(t){this.args.fields[t].disable(),this.args._fields[t].args.classes="deleted"}},{key:"undeleteImage",value:function(t){this.args.fields[t].enable(),this.args._fields[t].args.classes=""}},{key:"cloneSkeleton",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={};Array.isArray(t)&&(n=[]);for(var r in t)"fields"!=r&&(t[r]&&"object"===a(t[r])?n[r]=Object.assign({},this.cloneSkeleton(t[r],e+1)):n[r]=t[r]);return n}},{key:"correctNames",value:function(t,e){if(t.name=t.name.replace(/\[-1\]/,"["+e+"]"),t.attrs.name=t.name,"children"in t)for(var n in t.children)t.children[n]=this.correctNames(t.children[n],e);return t}},{key:"drag",value:function(t){this.dragging=t.target}},{key:"dragOver",value:function(t){if(!this.dragging)return!1;for(var e=t.target;e&&!e.matches('[draggable="true"]');)e=e.parentNode;e&&(this.dropping=e,t.preventDefault())}},{key:"drop",value:function(t){t.stopPropagation();var e=this.dragging.querySelector("label"),n=this.dropping.querySelector("label"),r=e.getAttribute("for"),i=n.getAttribute("for"),o=this.extractIndex(r),a=this.extractIndex(i);if(o==a||o==a-1)return this.dragging=!1,void(this.dropping=!1);var s=e.querySelectorAll('[name^="'+r+'"]'),u=e.querySelectorAll('[for^="'+r+'"]'),l=n.querySelectorAll('[name^="'+i+'"]'),c=n.querySelectorAll('[for^="'+i+'"]'),f=this.dropping,d=0,p=void 0,v=void 0;for(var h in this.args.fields){var g=this.args.fields[h].tags.input.element,b=this.args.fields[h].tags.label.element,y=g.getAttribute("name");e==b&&(p=this.args.fields[h]),n==b&&(v=this.args.fields[h]);var _=this.extractIndex(y),m=!1;if(!(_<0)&&(o>a&&_>=a&&_<=o?(m=this.changeIndex(y,_+1),d=-1):o<a&&_<=a&&_>=o&&(m=this.changeIndex(y,_-1),d=0),m!==!1)){this.changeAttributePrefix(b,"for",y,m),this.args.fields[h].args.fieldName=m,this.changeAttributePrefix(g,"name",y,m);for(var w=g.parentNode.querySelectorAll('[name^="'+y+'"]'),k=0;k<w.length;k++)this.changeAttributePrefix(w[k],"name",y,m);for(var O=g.parentNode.querySelectorAll('[for^="'+y+'"]'),j=0;j<O.length;j++)this.changeAttributePrefix(O[j],"for",y,m)}}r=e.getAttribute("for"),i=n.getAttribute("for"),o=this.extractIndex(r),a=this.extractIndex(i),this.changeAttributePrefix(e,"for",r,this.changeIndex(r,a+d));for(var T=0;T<s.length;T++)this.changeAttributePrefix(s[T],"name",r,this.changeIndex(r,a+d));for(var P=0;P<u.length;P++)this.changeAttributePrefix(u[P],"for",r,this.changeIndex(r,a+d));p.args.fieldName=e.getAttribute("for"),this.changeAttributePrefix(n,"for",i,this.changeIndex(i,a+d+1));for(var E=0;E<l.length;E++)this.changeAttributePrefix(l[E],"name",i,this.changeIndex(i,a+d+1));for(var S=0;S<c.length;S++)this.changeAttributePrefix(c[S],"for",i,this.changeIndex(i,a+d+1));v.args.fieldName=n.getAttribute("for"),this.dragging.parentNode.insertBefore(this.dragging,f),this.dragging=!1,this.dropping=!1}},{key:"dragStop",value:function(){this.dragging=!1,this.dropping=!1}},{key:"changeAttributePrefix",value:function(t,e,n,r){var i=(t.getAttribute(e),r+t.getAttribute(e).substring(n.length));t.setAttribute(e,i)}},{key:"extractIndex",value:function(t){var e=void 0;return!!(e=/\[(-?\d+)\]$/.exec(t))&&parseInt(e[1])}},{key:"changeIndex",value:function(t,e){var n=t.replace(/\[(-?\d+)\]$/,"["+e+"]");return n}},{key:"cancel",value:function(t){t.stopPropagation()}}]),e}(l.FieldSet)}),require.register("form/multiField/Wrapper.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Wrapper=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=e("Config"),u=e("../../base/View"),l=e("../../base/Repository");t.Wrapper=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.template='\n\t\t\t<div\n\t\t\t\tclass = "wrapped-field [[classes]]"\n\t\t\t\tcv-on = "click:editRecord(event, key)"\n\t\t\t\ttitle = "[[fieldName]]: [[id]]"\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tcv-on = "click:deleteImage(event, key)"\n\t\t\t\t\tstyle = "display: inline; cursor:pointer;"\n\t\t\t\t>\n\t\t\t\t\t[[icon]]\n\t\t\t\t</div>\n\t\t\t\t<div class = "field-content">\n\t\t\t\t\t[[title]]\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div style = "display:none">[[field]]</div>\n\t\t',n.args.field=n.args.field||"!",n.args.keyword="",n.args.title="",n.args.record={},n.args.key=n.args.field.key,n.args.classes="",n.args.icon="×",n.deleted=!1,n.args.field.args.bindTo("fieldName",function(t){n.args.fieldName=t}),n.args.fieldName=n.args.field.args.name,n.args.id=n.args.field.args.value.id,n.args.bindTo("id",function(t){n.args.field.args.value.id=t}),n.args.field.args.value.bindTo("id",function(t){t&&l.Repository.request(n.backendPath(),{id:t}).then(function(e){n.args.id=t;var r=e.body[0];return r?void n.refresh(r):(n.args.publicId=null,void(n.args.title=null))})},{wait:0}),n.args.field.args.value.bindTo("keyword",function(t){n.args.keyword=t}),n}return o(e,t),a(e,[{key:"editRecord",value:function(){this.args.parent.editRecord(this.args.record,this)}},{key:"deleteImage",value:function(t,e){t.stopPropagation(),this.deleted?(this.args.icon="×",this.args.parent.undeleteImage(e),this.deleted=!1):(this.args.icon="↺",this.args.parent.deleteImage(e),this.deleted=!0)}},{key:"backendPath",value:function(){return s.Config.backend+this.args.parent.args.attrs["data-endpoint"]}},{key:"getRecordTitle",value:function(t){return t._titleField?t[t._titleField]:t.title||t.publicId||t.id}},{key:"refresh",value:function(t){for(var e in t)this.args[e]=t[e];this.args.record=t,this.args.title=this.getRecordTitle(t)}}]),e}(u.View)}),require.register("index.js",function(t,e,n){"use strict"}),require.register("input/Keyboard.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Keyboard=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=e("../base/Bindable");t.Keyboard=function(){function t(){var e=this;r(this,t),this.maxDecay=120,this.listening=!0,this.keys=o.Bindable.makeBindable({}),this.codes=o.Bindable.makeBindable({}),document.addEventListener("keyup",function(t){e.keys[t.key]=-1,e.codes[t.code]=-1}),document.addEventListener("keydown",function(t){e.keys[t.key]>0||(e.keys[t.key]=1,e.codes[t.code]=1)}),window.addEventListener("blur",function(t){for(var n in e.keys)e.keys[n]=-1;for(var r in e.codes)e.codes[r]=-1})}return i(t,[{key:"getKey",value:function(t){return this.keys[t]?this.keys[t]:0}},{key:"getKeyCode",value:function(t){return this.codes[t]?this.codes[t]:0}},{key:"update",value:function(){for(var t in this.keys)this.keys[t]>0?this.keys[t]++:(this.keys[t]--,this.keys[t]<-this.maxDecay&&delete this.keys[t]);for(var t in this.codes)this.codes[t]>0?this.codes[t]++:(this.codes[t]--,this.codes[t]<-this.maxDecay&&delete this.keys[t])}}]),t}()}),require.register("tag/LazyTag.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.LazyTag=void 0;var a=e("./ScrollTag"),s=e("../base/Dom");t.LazyTag=function(t){function e(t,n,o,a,u){r(this,e);var l=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,a,u));return l.element.classList.remove("cv-visible"),l.element.classList.add("cv-not-visible"),l.bindTo("visible",function(t){t&&(l.afterScroll&&clearTimeout(l.afterScroll),l.afterScroll=setTimeout(function(){l.element&&(l.element.classList.add("cv-visible"),l.element.classList.remove("cv-not-visible"),s.Dom.mapTags(l.element,"[cv-lazy-style]",function(t){var e=t.getAttribute("cv-lazy-style"),n=t.getAttribute("style");t.setAttribute("style",n+";"+e),t.removeAttribute("cv-lazy-style")}))},.5*(l.offsetTop||l.element.offsetTop)+.5*l.element.offsetLeft))}),l}return o(e,t),e}(a.ScrollTag)}),require.register("tag/PopOutTag.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.PopOutTag=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function c(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:c(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},u=(e("../base/Bindable"),e("../base/Dom")),l=e("../base/Tag");t.PopOutTag=function(t){function e(t,n,o,a,s){r(this,e);var u=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,a,s));return u.poppedOut=!1,u.style=t.getAttribute("style"),u.moving=!1,u.hostSelector=u.element.getAttribute("cv-pop-to"),u.element.removeAttribute("cv-pop-to"),u.verticalDuration=.4,u.horizontalDuration=.1,u.unpoppedStyle="",u.previousScroll=0,u.bodyStyle="",u.bodyScroll=0,u.element.classList.add("unpopped"),u.scrollStyle,u.popTimeout=null,u.rect,u.clickListener=function(e){if(u.rect=u.element.getBoundingClientRect(),!u.poppedOut){u.distance=Math.sqrt(Math.pow(u.rect.top,2)+Math.pow(u.rect.left,2));var n=t.getAttribute("data-pop-speed")||1750,r=window.innerWidth-u.rect.right,i=window.innerHeight-u.rect.bottom,o=(u.rect.left+r)/2,a=(u.rect.top+i)/2;u.horizontalDuration=o/n,u.verticalDuration=a/n,u.horizontalDuration<.1&&(u.horizontalDuration=.1),u.verticalDuration<.1&&(u.verticalDuration=.1),u.horizontalDuration>.4&&(u.horizontalDuration=.4),u.verticalDuration>.4&&(u.verticalDuration=.4)}u.element.contains(e.target)&&(e.stopPropagation(),e.preventDefault(),u.moving||(u.poppedOut?e.target.matches(".closeButton")&&u.poppedOut&&u.unpop():u.pop()))},u.escapeListener=function(t){"Escape"===t.key&&u.unpop()},u.element.___clickListener___||(Object.defineProperty(u.element,"___scrollListeners___",{enumerable:!1,writable:!0}),u.element.___clickListener___=u.clickListener,u.element.___escapeListener___=u.escapeListener,u.element.addEventListener("click",t.___clickListener___),window.addEventListener("keyup",t.___escapeListener___),u.cleanup.push(function(t){return function(){t.removeEventListener("click",t.___clickListener___),window.removeEventListener("keyup",t.___escapeListener___)}}(t))),u}return o(e,t),a(e,[{key:"pause",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"pause",this).call(this,t),t&&(document.body.setAttribute("style",this.bodyStyle),document.body.setAttribute("style",""))}},{key:"pop",value:function(){var t=this;e.popLevel(),this.previousScroll=window.scrollY,this.rect=this.element.getBoundingClientRect(),this.style=this.element.getAttribute("style");for(var n=this.element;n.parentNode&&!n.matches(this.hostSelector)&&n.parentNode!=document;)n=n.parentNode;var r=n.getBoundingClientRect();window.requestAnimationFrame(function(){t.unpoppedStyle="\n\t\t\t\t;position:  fixed;\n\t\t\t\tleft:       "+t.rect.x+"px;\n\t\t\t\ttop:        "+t.rect.y+"px;\n\t\t\t\twidth:      "+t.rect.width+"px;\n\t\t\t\theight:     "+t.rect.height+"px;\n\t\t\t\tz-index:    99999;\n\t\t\t\ttransition: width "+t.horizontalDuration+"s  ease-out\n\t\t\t\t\t\t\t, top "+t.verticalDuration+"s    ease-out\n\t\t\t\t\t\t\t, left "+t.horizontalDuration+"s ease-out\n\t\t\t\t\t\t\t, height "+t.verticalDuration+"s ease-out\n\t\t\t\t\t\t\t, all "+t.horizontalDuration+"s  ease-out;\n\t\t\t\toverflow: hidden;\n\t\t\t";var e=t.style+t.unpoppedStyle;t.element.setAttribute("style",e),window.requestAnimationFrame(function(){e+="\n\t\t\t\t\t;left:      "+r.x+"px;\n\t\t\t\t\ttop:        "+r.y+"px;\n\t\t\t\t\twidth:      "+r.width+"px;\n\t\t\t\t\theight:     "+r.height+"px;\n\t\t\t\t\toverflow-y: auto;\n\t\t\t\t\ttransition: width "+t.horizontalDuration+"s ease-out\n\t\t\t\t\t\t, top "+t.verticalDuration+"s           ease-out\n\t\t\t\t\t\t, left "+t.horizontalDuration+"s        ease-out\n\t\t\t\t\t\t, height "+t.verticalDuration+"s        ease-out\n\t\t\t\t\t\t, all "+t.horizontalDuration+"s         ease-out;\n\t\t\t\t",t.moving=!0,t.element.setAttribute("style",e),t.element.classList.add("popped"),t.element.classList.remove("unpopped"),t.popTimeout=setTimeout(function(){if(t.element){t.bodyStyle=document.body.getAttribute("style"),document.body.setAttribute("style","height:100%;overflow:hidden;"),t.moving=!1,u.Dom.mapTags(t.element,!1,function(e){var n=new CustomEvent("cvPopped");e.dispatchEvent(n),t.scrollStyle=t.element.getAttribute("style")});var e=new CustomEvent("cvPop",{bubbles:!0,detail:{tag:t,view:t.parent,publicId:t.parent.args.publicId}});t.element.dispatchEvent(e)}},1e3*t.horizontalDuration)}),t.poppedOut=!0})}},{key:"unpop",value:function(){var t=this;this.element.classList.add("unpopping"),this.popTimeout&&clearTimeout(this.popTimeout),0==e.level?document.body.setAttribute("style",""):document.body.setAttribute("style",this.bodyStyle||""),e.unpopLevel(),this.rect||(this.rect=this.element.getBoundingClientRect()),window.scrollTo(0,this.previousScroll);var n=this.style+this.unpoppedStyle+(";transition: width "+this.horizontalDuration+"s ease-in\n\t\t\t\t\t, height "+this.verticalDuration+"s        ease-in\n\t\t\t\t\t, all "+this.horizontalDuration+"s         ease-in;");this.element.setAttribute("style",n),this.moving=!0,setTimeout(function(){t.element&&t.element.classList.remove("popped")},1e3*this.horizontalDuration),setTimeout(function(){if(t.element.classList.add("unpopped"),t.element.classList.remove("unpopping"),t.element){t.element.setAttribute("style",t.style),t.moving=!1,u.Dom.mapTags(t.element,!1,function(t){var e=new CustomEvent("cvUnpopped");t.dispatchEvent(e)});var e=new CustomEvent("cvUnpop",{bubbles:!0,detail:{tag:t,view:t.parent,publicId:t.parent.args.publicId}});t.element.dispatchEvent(e)}},1e3*this.horizontalDuration),this.poppedOut=!1}},{key:"remove",value:function(){document.body.setAttribute("style",this.bodyStyle),s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"remove",this).call(this)}}],[{key:"popLevel",value:function(){return this.level||(this.level=0),this.level++,this.level}},{key:"unpopLevel",value:function(){return this.level||(this.level=0),this.level--,this.level<0&&(this.level=0),this.level}}]),e}(l.Tag)}),require.register("tag/ScrollTag.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ScrollTag=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=e("../base/Tag"),u=e("../base/Dom");e("../base/Bindable"),t.ScrollTag=function(t){function e(t,n,o,a,s){r(this,e);var l=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,a,s));return l.visible=!1,l.offsetTop=!1,l.offsetBottom=!1,l.attachListener=function(e){for(var n=e.target;n.parentNode;)n=n.parentNode;n!==window&&n!==document||e.target===t&&(l.addScrollListener(e.target),l.addResizeListener(e.target),l.scrolled(e.target),e.target.removeEventListener("cvDomAttached",l.attachListener))},l.element.addEventListener("cvDomAttached",l.attachListener),l.cleanup.push(function(t){return function(){t.removeEventListener("cvDomAttached",l.attachListener)}}(l.element)),l.bindTo("visible",function(t){var e=void 0;e=t?new Event("cvScrolledIn"):new Event("cvScrolledOut"),u.Dom.mapTags(l.element,!1,function(t){t.dispatchEvent(e)}),l.element.dispatchEvent(e)}),l.bindTo("offsetTop",function(t){var e=new CustomEvent("cvScrolled",{detail:{offset:t}});u.Dom.mapTags(l.element,!1,function(t){t.dispatchEvent(e)}),l.element.dispatchEvent(e)}),l}return o(e,t),a(e,[{key:"scrolled",value:function(t){var e=this.element;if(e){var n=!1,r=e.getBoundingClientRect();r.bottom>0&&r.top<window.innerHeight&&(n=!0),this.proxy.visible=n,this.proxy.offsetTop=r.top||0,this.proxy.offsetBottom=r.bottom||0}}},{key:"addScrollListener",value:function(t){var e=this;if(!t.___scrollListener___){Object.defineProperty(t,"___scrollListener___",{enumerable:!1,writable:!0}),t.___scrollListener___=function(t){e.scrolled(t.target)};for(var n=t,r={passive:!0,capture:!0};n.parentNode;)n=n.parentNode,n.addEventListener("scroll",t.___scrollListener___,r),this.direct.cleanup.push(function(t,e,n){return function(){t.removeEventListener("scroll",e.___scrollListener___,n),e=t=null}}(n,t,r))}}},{key:"addResizeListener",value:function(t){var e=this;t.___resizeListener___||(Object.defineProperty(t,"___resizeListener___",{enumerable:!1,writable:!0}),t.___resizeListener___=function(t){e.scrolled(t.target)},window.addEventListener("resize",this.resizeListener),this.direct.cleanup.push(function(e){return function(){window.removeEventListener("resize",e.___resizeListener___),t.___resizeListener___=null,t=null}}(t)))}}]),e}(s.Tag)}),require.register("toast/Toast.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Toast=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=e("../base/View"),u=e("./ToastAlert");t.Toast=function(t){function e(){r(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.template='\n\t\t\t<div id = "[[_id]]" cv-each = "alerts:alert" class = "toast">\n\t\t\t\t[[alert]]\n\t\t\t</div>\n\t\t',t.args.alerts=[],t}return o(e,t),a(e,null,[{key:"instance",value:function(){return this.inst||(this.inst=new this),this.inst}}]),a(e,[{key:"pop",value:function(t){var e=this;this.args.alerts.length;this.args.alerts.push(t),t.decay(function(t){return function(){for(var n in e.args.alerts)if(e.args.alerts[n].___ref___===t.___ref___)return t.remove(),void delete e.args.alerts[n]}}(t))}},{key:"alert",value:function(t,e,n){return this.pop(new u.ToastAlert({title:t,body:e,time:n}))}}]),e}(s.View)}),require.register("toast/ToastAlert.js",function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ToastAlert=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=e("../base/View");t.ToastAlert=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.args.time=n.args.time||16e3,n.init=n.args.time,n.args.opacity=1,n.args.title=n.args.title||"Standard alert",n.args.status="new",n.args.body=n.args.body||"This is a standard alert.",n.template='\n\t\t\t<div id = "[[_id]]" style = "opacity:[[opacity]]" class = "alert toast-[[status]]">\n\t\t\t\t<h3>[[title]]</h3>\n\t\t\t\t<p>[[body]]</p>\n\t\t\t</div>\n\t\t',n}return o(e,t),a(e,[{key:"decay",value:function n(t){var e=this,r=16,n=setInterval(function(){e.args.time<300&&"imminent"!==e.args.status?e.args.status="imminent":e.args.time>300&&"decaying"!==e.args.status&&(e.args.status="decaying"),e.args.time>0&&(e.args.time-=r,e.args.opacity=e.args.time/e.init,e.args.time<=0&&(t&&t(),clearInterval(n)))},r)}}]),e}(s.View)}),require.register("___globals___",function(t,e,n){})}(),require("___globals___");