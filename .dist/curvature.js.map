{"version":3,"sources":["app/Config.js","app/Curvature.js","app/access/LoginView.js","app/access/UserRepository.js","app/base/Bindable.js","app/base/Cache.js","app/base/Cookie.js","app/base/Dom.js","app/base/Repository.js","app/base/Router.js","app/base/Tag.js","app/base/Theme.js","app/base/View.js","app/base/ViewList.js","app/form/ButtonField.js","app/form/Field.js","app/form/FieldSet.js","app/form/FileField.js","app/form/Form.js","app/form/HiddenField.js","app/form/HtmlField.js","app/form/SelectField.js","app/input/Keyboard.js","app/tag/PopOutTag.js","app/tag/ScrollTag.js","app/toast/Toast.js","app/toast/ToastAlert.js"],"names":["Config","base","Bindable","Cache","Cookie","Dom","Repository","Router","Tag","Theme","View","access","LoginView","UserRepository","form","ButtonField","Field","FieldSet","FileField","Form","HiddenField","HtmlField","SelectField","tag","PopOutTag","ScrollTag","toast","Toast","ToastAlert","template","event","console","log","preventDefault","fbWindow","window","open","backend","userCheck","clearInterval","onInterval","getCurrentUser","then","response","user","body","id","clearCache","instance","pop","title","username","publicId","time","logoutWindow","refresh","request","uri","object","___binding___","Node","Object","defineProperty","enumerable","writable","___isBindable___","___wrapped___","___bindingAll___","bindTo","property","callback","push","i","___stack___","___stackTime___","___before___","___after___","___setCount___","toString","JSON","stringify","makeBindable","set","target","key","value","stop","warnOn","del","undefined","Array","isArray","splice","get","___executing___","unshift","Date","getTime","ret","apply","arguments","execTime","shift","___ref___","Proxy","deleteProperty","expiry","bucket","expiration","defaultvalue","name","jar","location","href","substr","document","cookie","split","map","c","parse","error","decodeURIComponent","v","k","t","d","cookieString","encodeURIComponent","doc","selector","startNode","endNode","result","started","ended","treeWalker","createTreeWalker","NodeFilter","SHOW_ALL","acceptNode","node","FILTER_SKIP","Element","matches","FILTER_ACCEPT","nextNode","currentNode","dispatchEvent","mapTags","objects","args","content","Promise","resolve","skeleton","post","cache","type","queryString","formData","queryArgs","api","keys","arg","join","fullUri","postString","FormData","append","xhr","XMLHttpRequest","tagCacheSelector","tagCache","querySelector","tagCacheContent","innerText","withCredentials","timeout","xhrId","xhrs","length","reject","onreadystatechange","DONE","OK","readyState","status","responseText","code","prerendering","createElement","appendChild","setAttribute","setRequestHeader","send","abort","xhrList","mainView","addEventListener","match","pathname","go","route","silent","history","pushState","Event","path","view","forceRefresh","current","routes","query","URLSearchParams","search","pair","L1","L2","j","argName","groups","exec","Error","pause","update","store","parts","finalArgs","fresh","queryOver","queryToString","element","parent","ref","index","proxy","cleanup","clearBindings","firstChild","removeChild","views","single","list","model","modelClass","_modelClass","class","content_type","_id","uuid","firstNode","lastNode","nodes","frames","timeouts","intervals","attach","detach","eventCleanup","viewList","viewLists","tags","timestamp","requestAnimationFrame","wrappedCallback","fired","setTimeout","created","paused","setInterval","clearTimeout","parentNode","insertPoint","detachEvent","bubbles","attachEvent","insertBefore","subDoc","createRange","createContextualFragment","prerenderAttr","getAttribute","eachAttr","carryAttr","removeAttribute","subTemplate","innerHTML","carryProps","eachProp","asProp","keyProp","remove","ViewList","render","subArgs","withAttr","LinkAttr","linkClick","eventListener","removeEventListener","action","String","a","eventName","replace","callbackName","argList","s","trim","eventMethod","argRefs","outerHTML","bindArg","tagName","toLowerCase","checked","inputListener","regex","nodeType","TEXT_NODE","original","nodeValue","interpolatable","header","bindProperty","unsafeHtml","staticPrefix","substring","staticNode","createTextNode","dynamicNode","staticSuffix","ELEMENT_NODE","attributes","attribute","bindProperties","segments","refAttr","refProp","refClassname","refKey","refClass","stringToClass","refKeyVal","mapIfTags","bind","createComment","newNode","postRender","ifProperty","inverted","ifDoc","moveTag","prepend","str","crypto","getRandomValues","Uint8Array","refClassSplit","refShortClassname","require","subProperty","keyProperty","reRender","finalViews","found","viewArgs","appendOnly","values","attrs","buttonClick","valueString","ignore","setting","fields","renderFields","children","flatValue","method","_method","classes","_classes","_onSubmit","field","contentEditable","contenteditable","options","Keyboard","listening","codes","poppedOut","style","moving","leftDuration","unpoppedStyle","previousScroll","bodyStyle","bodyScroll","classList","add","scrollStyle","rect","clickListener","getBoundingClientRect","distance","Math","sqrt","top","left","contains","stopPropagation","scrollY","x","y","width","height","overflow","overflowY","popLevel","scrollTo","unpopLevel","level","visible","offsetTop","offsetBottom","scrollListener","scrolled","resizeListener","attachListener","e","addScrollListener","addResizeListener","scrolledEvent","CustomEvent","detail","offset","scroller","bottom","innerHeight","___scrollListener___","___resizeListener___","inst","alerts","alert","decay","init","opacity","complete","decayInterval"],"mappings":"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","file":".dist/curvature.js","sourcesContent":["export class Config {}\n","'use strict'\n\nimport { Bindable   } from 'base/Bindable';\nimport { Cache      } from 'base/Cache';\nimport { Cookie     } from 'base/Cookie';\nimport { Dom        } from 'base/Dom';\nimport { Repository } from 'base/Repository';\nimport { Router     } from 'base/Router';\nimport { Tag        } from 'base/Tag';\nimport { Theme      } from 'base/Theme';\nimport { View       } from 'base/View';\n\nimport { LoginView }      from 'access/LoginView';\nimport { UserRepository } from 'access/UserRepository';\n\nimport { ButtonField } from 'form/ButtonField';\nimport { Field       } from 'form/Field';\nimport { FieldSet    } from 'form/FieldSet';\nimport { FileField   } from 'form/FileField';\nimport { Form        } from 'form/Form';\nimport { HiddenField } from 'form/HiddenField';\nimport { HtmlField   } from 'form/HtmlField';\nimport { SelectField } from 'form/SelectField';\n\nimport { PopOutTag } from 'tag/PopOutTag';\nimport { ScrollTag } from 'tag/ScrollTag';\n\nimport { Toast      } from 'toast/Toast';\nimport { ToastAlert } from 'toast/ToastAlert';\n\nlet base = {\n\tBindable\n\t, Cache\n\t, Cookie\n\t, Dom\n\t, Repository\n\t, Router\n\t, Tag\n\t, Theme\n\t, View\n}\n\nlet access = {\n\tLoginView\n\t, UserRepository\n};\n\nlet form = {\n\tButtonField\n\t, Field\n\t, FieldSet\n\t, FileField\n\t, Form\n\t, HiddenField\n\t, HtmlField\n\t, SelectField\n};\n\nlet tag = {\n\tPopOutTag\n\t, ScrollTag\n};\n\nlet toast = {\n\tToast\n\t, ToastAlert\n};\n\nexport { base, access, form, tag, toast };","import { Config         } from 'Config';\r\n\r\nimport { View           } from '../base/View';\r\nimport { Router         } from '../base/Router';\r\nimport { Repository     } from '../base/Repository';\r\n\r\nimport { UserRepository } from './UserRepository';\r\n\r\nimport { Toast      } from '../toast/Toast';\r\nimport { ToastAlert } from '../toast/ToastAlert';\r\n\r\nexport class LoginView extends View{\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.template = `\r\n\t\t\t<br />\r\n\t\t\t<br />\r\n\t\t\t<br />\r\n\t\t\t<br />\r\n\t\t\t<br />\r\n\t\t\t<br />\r\n\t\t\t<br />\r\n\t\t\t<br />\r\n\t\t\t<br />\r\n\t\t\t<br />\r\n\t\t\t<br />\r\n\t\t\t\r\n\t\t\t<a cv-link = \"user\">User</a>\r\n\t\t\t<br />\r\n\t\t\t\r\n\t\t\t<a cv-link = \"user/login\">Login</a>\r\n\t\t\t<br />\r\n\r\n\t\t\t<a cv-link = \"user/register\">Register</a>\r\n\t\t\t<br />\r\n\r\n\t\t\t<a cv-link = \"user/logout\">Logout</a>\r\n\t\t\t<br />\r\n\r\n\t\t\t<input\r\n\t\t\t\ttype  = \"button\"\r\n\t\t\t\tvalue = \"Login via FaceBook\"\r\n\t\t\t \tcv-on = \"click:facebookLogin(event)\"\r\n\t\t\t />\r\n\t\t\t <input\r\n\t\t\t\ttype  = \"button\"\r\n\t\t\t\tvalue = \"Log Out\"\r\n\t\t\t \tcv-on = \"click:logout(event)\"\r\n\t\t\t />\r\n\t\t`;\r\n\t}\r\n\tfacebookLogin(event) {\r\n\t\tconsole.log('fb!')\r\n\t\tevent.preventDefault();\r\n\t\tlet fbWindow = window.open(\r\n\t\t\tConfig.backend\r\n\t\t\t\t+ '/facebookLogin'\r\n\t\t);\r\n\r\n\t\tif(this.userCheck)\r\n\t\t{\r\n\t\t\tthis.clearInterval(this.userCheck);\r\n\t\t}\r\n\r\n\t\tthis.userCheck = this.onInterval(333, () => {\r\n\t\t\tUserRepository.getCurrentUser(true).then((response) => {\r\n\t\t\t\tlet user = response.body;\r\n\t\t\t\tif(!user.id || !user)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.clearInterval(this.userCheck);\r\n\r\n\t\t\t\tRouter.clearCache();\r\n\t\t\t\tRepository.clearCache();\r\n\r\n\t\t\t\tToast.instance().pop(new ToastAlert({\r\n\t\t\t\t\ttitle: 'Logged in as ' + user.username\r\n\t\t\t\t\t, body: 'ID: '  + user.publicId\r\n\t\t\t\t\t, time: 2400\r\n\t\t\t\t}));\r\n\r\n\t\t\t\t// history.go(-1);\r\n\r\n\t\t\t\t// Router.instance().updateView(this, this.routes, true);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\tlogout(event) {\r\n\t\tlet logoutWindow = window.open(\r\n\t\t\tConfig.backend\r\n\t\t\t\t+ '/user/logout?page=app%3Fclose%3D1'\r\n\t\t);\r\n\t}\r\n}\r\n\r\n","import { Config     } from 'Config';\r\nimport { Repository } from '../base/Repository';\r\n\r\nexport class UserRepository extends Repository {\r\n\tstatic get uri() { return Config.backend + '/user/'; }\r\n\tstatic getCurrentUser(refresh) {\r\n\t\treturn this.request(\r\n\t\t\tthis.uri + 'current'\r\n\t\t\t, false, false, false\r\n\t\t).then((user) => {\r\n\t\t\treturn user;\r\n\t\t});\r\n\t}\r\n\tstatic logout() {\r\n\t\treturn this.request(\r\n\t\t\tthis.uri + 'logout'\r\n\t\t\t, false, {}, false\r\n\t\t).then((user) => {\r\n\t\t\treturn user;\r\n\t\t});\r\n\t}\r\n}","export class Bindable {\r\n    static isBindable(object) {\r\n        if (!object.___binding___) {\r\n            return false;\r\n        }\r\n\r\n        return object.___binding___ === Bindable;\r\n    }\r\n    static makeBindable(object) {\r\n\r\n        if (!object ||\r\n            object.___binding___ ||\r\n            typeof object !== 'object' ||\r\n            object instanceof Node\r\n        ) {\r\n            return object;\r\n        }\r\n\r\n        Object.defineProperty(object, '___ref___', {\r\n            enumerable: false,\r\n            writable: true\r\n        });\r\n\r\n        Object.defineProperty(object, 'bindTo', {\r\n            enumerable: false,\r\n            writable: true\r\n        });\r\n\r\n        Object.defineProperty(object, '___binding___', {\r\n            enumerable: false,\r\n            writable: true\r\n        });\r\n\r\n        Object.defineProperty(object, '___bindingAll___', {\r\n            enumerable: false,\r\n            writable: true\r\n        });\r\n\r\n        Object.defineProperty(object, '___isBindable___', {\r\n            enumerable: false,\r\n            writable: true\r\n        });\r\n\r\n        Object.defineProperty(object, '___executing___', {\r\n            enumerable: false,\r\n            writable: true\r\n        });\r\n\r\n        Object.defineProperty(object, '___stack___', {\r\n            enumerable: false,\r\n            writable: true\r\n        });\r\n\r\n        Object.defineProperty(object, '___stackTime___', {\r\n            enumerable: false,\r\n            writable: true\r\n        });\r\n\r\n        Object.defineProperty(object, '___before___', {\r\n            enumerable: false,\r\n            writable: true\r\n        });\r\n\r\n        Object.defineProperty(object, '___after___', {\r\n            enumerable: false,\r\n            writable: true\r\n        });\r\n\r\n        Object.defineProperty(object, 'toString', {\r\n            enumerable: false,\r\n            writable: true\r\n        });\r\n\r\n        Object.defineProperty(object, '___setCount___', {\r\n            enumerable: false,\r\n            writable: true\r\n        });\r\n\r\n        Object.defineProperty(object, '___wrapped___', {\r\n            enumerable: false,\r\n            writable: true\r\n        });\r\n\r\n        object.___isBindable___ = Bindable;\r\n        object.___wrapped___    = {};\r\n        object.___binding___    = {};\r\n        object.___bindingAll___ = [];\r\n        object.bindTo = ((object) => (property, callback = null) => {\r\n            if (callback == null) {\r\n                callback = property;\r\n                object.___bindingAll___.push(callback);\r\n                for (let i in object) {\r\n                    callback(object[i], i, object, false);\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (!object.___binding___[property]) {\r\n                object.___binding___[property] = [];\r\n            }\r\n\r\n            object.___binding___[property].push(callback);\r\n\r\n            callback(object[property], property, object, false);\r\n\r\n        })(object);\r\n\r\n        object.___stack___ = [];\r\n        object.___stackTime___ = [];\r\n        object.___before___ = [];\r\n        object.___after___ = [];\r\n        object.___setCount___ = {};\r\n\r\n        object.toString = ((object) => () => {\r\n            if (typeof object == 'object') {\r\n                return JSON.stringify(object);\r\n                return '[object]'\r\n            }\r\n\r\n            return object;\r\n        })(object);\r\n\r\n        for (let i in object) {\r\n            if (object[i] &&\r\n                typeof object[i] == 'object' &&\r\n                !object[i] instanceof Node\r\n            ) {\r\n                object[i] = Bindable.makeBindable(object[i]);\r\n            }\r\n        }\r\n\r\n        let set = ((object) => (target, key, value) => {\r\n            if (target[key] === value && typeof value !== object) {\r\n                return true;\r\n            }\r\n\r\n            // console.log(`Setting ${key}`, value);\r\n\r\n            if (value && typeof value == 'object' && !(value instanceof Node)) {\r\n                if (value.___isBindable___ !== Bindable) {\r\n                    value = Bindable.makeBindable(value);\r\n\r\n                    for (let i in value) {\r\n                        if (value[i] && typeof value[i] == 'object') {\r\n                            value[i] = Bindable.makeBindable(value[i]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            for (let i in object.___bindingAll___) {\r\n                object.___bindingAll___[i](value, key, target, false);\r\n            }\r\n\r\n            let stop = false;\r\n\r\n            if (key in object.___binding___) {\r\n                for (let i in object.___binding___[key]) {\r\n                    if (object.___binding___[key][i](value, key, target, false) === false) {\r\n                        stop = true;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (!stop) {\r\n                target[key] = value;\r\n            }\r\n\r\n            if (!target.___setCount___[key]) {\r\n                target.___setCount___[key] = 0;\r\n            }\r\n\r\n            target.___setCount___[key]++;\r\n\r\n            const warnOn = 10;\r\n\r\n            if (target.___setCount___[key] > warnOn && value instanceof Object) {\r\n                console.log(\r\n                    'Warning: Resetting bindable reference \"' +\r\n                    key +\r\n                    '\" to object ' +\r\n                    target.___setCount___[key] +\r\n                    ' times.'\r\n                );\r\n            }\r\n\r\n            return true;\r\n        })(object);\r\n\r\n        let del = ((object) => (target, key) => {\r\n            // console.log(key, 'DEL');\r\n\r\n            if (!(key in target)) {\r\n                return false;\r\n            }\r\n\r\n            for (let i in object.___bindingAll___) {\r\n                object.___bindingAll___[i](undefined, key, target, true);\r\n            }\r\n\r\n            if (key in object.___binding___) {\r\n                for (let i in object.___binding___[key]) {\r\n                    object.___binding___[key][i](undefined, key, target, true);\r\n                }\r\n            }\r\n\r\n            if (Array.isArray(target)) {\r\n                target.splice(key, 1);\r\n            } else {\r\n                delete target[key];\r\n            }\r\n\r\n            return true;\r\n        })(object);\r\n\r\n        let get = ((object) => (target, key) => {\r\n            if (typeof target[key] == 'function') {\r\n\r\n            \tif(target.___wrapped___[key])\r\n            \t{\r\n            \t\treturn target.___wrapped___[key];\r\n            \t}\r\n\r\n                target.___wrapped___[key] = function() {\r\n                    target.___executing___ = key;\r\n\r\n                    target.___stack___.unshift(key);\r\n                    target.___stackTime___.unshift((new Date).getTime());\r\n\r\n                    // console.log(`Start ${key}()`);\r\n\r\n                    for (let i in target.___before___) {\r\n                        target.___before___[i](target, key, object);\r\n                    }\r\n\r\n                    let ret = target[key].apply(target, arguments);\r\n\r\n                    for (let i in target.___after___) {\r\n                        target.___after___[i](target, key, object);\r\n                    }\r\n\r\n                    target.___executing___ = null;\r\n\r\n                    let execTime = (new Date).getTime() - target.___stackTime___[0];\r\n\r\n                    if (execTime > 150) {\r\n                        // console.log(`End ${key}(), took ${execTime} ms`);\r\n                    }\r\n\r\n                    target.___stack___.shift();\r\n                    target.___stackTime___.shift();\r\n\r\n                    return ret;\r\n                };\r\n\r\n                return target.___wrapped___[key];\r\n            }\r\n\r\n            // console.log(`Getting ${key}`);\r\n\r\n            return target[key];\r\n        })(object);\r\n\r\n        object.___ref___ = new Proxy(object, {\r\n            deleteProperty: del,\r\n            get: get,\r\n            set: set\r\n        });\r\n\r\n        return object.___ref___;\r\n    }\r\n    static clearBindings(object) {\r\n        object.___wrapped___ = {};\r\n        object.___binding___ = {};\r\n        object.___before___  = {};\r\n        object.___after___   = {};\r\n    }\r\n}","export class Cache\r\n{\r\n\tstatic store(key, value, expiry, bucket = 'standard')\r\n\t{\r\n\t\tlet expiration = (expiry * 1000) + (new Date).getTime();\r\n\r\n\t\t// console.log(\r\n\t\t// \t`Caching ${key} until ${expiration} in ${bucket}.`\r\n\t\t// \t, value\r\n\t\t// \t, this.bucket\r\n\t\t// );\r\n\r\n\t\tif(!this.bucket)\r\n\t\t{\r\n\t\t\tthis.bucket = {};\r\n\t\t}\r\n\r\n\t\tif(!this.bucket[bucket])\r\n\t\t{\r\n\t\t\tthis.bucket[bucket]\t= {};\r\n\t\t}\r\n\r\n\t\tthis.bucket[bucket][key] = {expiration, value};\r\n\t}\r\n\r\n\tstatic load(key, defaultvalue = false, bucket = 'standard')\r\n\t{\r\n\t\t// console.log(\r\n\t\t// \t`Checking cache for ${key} in ${bucket}.`\r\n\t\t// \t, this.bucket\r\n\t\t// );\r\n\r\n\t\tif(this.bucket && this.bucket[bucket] && this.bucket[bucket][key])\r\n\t\t{\r\n\t\t\t// console.log(this.bucket[bucket][key].expiration, (new Date).getTime());\r\n\t\t\tif(this.bucket[bucket][key].expiration > (new Date).getTime())\r\n\t\t\t{\r\n\t\t\t\treturn this.bucket[bucket][key].value;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn defaultvalue;\r\n\t}\r\n}","import { Bindable } from './Bindable';\n\nexport class Cookie\n{\n\tstatic set(name, value)\n\t{\n\t\tCookie.jar[name] = value;\n\t}\n\n\tstatic get(name)\n\t{\n\t\treturn Cookie.jar[name];\n\t}\n\n\tstatic delete(name)\n\t{\n\t\tdelete Cookie.jar[name];\n\t}\n};\n\nCookie.jar = Cookie.jar || Bindable.makeBindable({});\n\nif(window.location.href.substr(0,4) !== 'data')\n{\n\tdocument.cookie.split(';').map(c => {\n\t\tlet [key, value] = c.split('=');\n\n\t\ttry\n\t\t{\n\t\t\tvalue = JSON.parse(value);\n\t\t}\n\t\tcatch(error)\n\t\t{\n\t\t\tvalue = value;\n\t\t}\n\n\t\tCookie.jar[decodeURIComponent(key)] = value;\n\t});\n\n\tCookie.jar.bindTo((v,k,t,d) => {\n\t\tt[k] = v;\n\n\t\tif(d)\n\t\t{\n\t\t\tt[k] = null;\n\t\t}\n\t\t\n\t\tconst cookieString = `${encodeURIComponent(k)}=${JSON.stringify(t[k])}`;\n\t\tdocument.cookie = cookieString;\n\t});\n}\n","export class Dom\r\n{\r\n\tstatic mapTags(doc, selector, callback, startNode, endNode)\r\n\t{\r\n\t\tlet result = [];\r\n\r\n\t\tlet started = true;\r\n\r\n\t\tif(startNode)\r\n\t\t{\r\n\t\t\tstarted = false;\r\n\t\t}\r\n\r\n\t\tlet ended = false;\r\n\r\n\t\tvar treeWalker = document.createTreeWalker(\r\n\t\t\tdoc,\r\n\t\t\tNodeFilter.SHOW_ALL,\r\n\t\t\t{\r\n\t\t\t\tacceptNode: (node) => {\r\n\t\t\t\t\tif(!started)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif(node === startNode)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tstarted = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn NodeFilter.FILTER_SKIP;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(endNode && node === endNode)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tended = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(ended)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn NodeFilter.FILTER_SKIP;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(selector)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// console.log(selector, node, !!(node instanceof Element));\r\n\t\t\t\t\t\tif(node instanceof Element)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif(node.matches(selector))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\treturn NodeFilter.FILTER_ACCEPT;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn NodeFilter.FILTER_SKIP;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn NodeFilter.FILTER_ACCEPT;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfalse\r\n\t\t);\r\n\r\n\t\twhile(treeWalker.nextNode())\r\n\t\t{\r\n\t\t\tresult.push(callback(treeWalker.currentNode));\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\tstatic dispatchEvent(doc, event)\r\n\t{\r\n\t\tdoc.dispatchEvent(event);\r\n\r\n\t\tDom.mapTags(doc, false, (node) => {\r\n\t\t\tnode.dispatchEvent(event);\r\n\t\t});\r\n\t}\r\n}","import { Cookie } from './Cookie';\r\n\r\nvar objects = {};\r\n\r\nexport class Repository\r\n{\r\n\tstatic get xhrs() { return this.xhrList = this.xhrList || [];   }\r\n\r\n\tstatic loadPage(args = {}, refresh = false) {\r\n\t\treturn this.request(this.uri, args).then((response) => {\r\n\t\t\treturn response;\r\n\t\t\t// return response.map((skeleton) => new Model(skeleton));\r\n\t\t});\r\n\t}\r\n\tstatic domCache(uri, content)\r\n\t{\r\n\t\tconsole.log(uri, content);\r\n\t}\r\n\tstatic load(id, refresh = false) {\r\n\t\tthis.objects           = this.objects           || {};\r\n\t\tthis.objects[this.uri] = this.objects[this.uri] || {};\r\n\r\n\t\tif(this.objects[this.uri][id]) {\r\n\t\t\treturn Promise.resolve(this.objects[this.uri][id]);\r\n\t\t}\r\n\r\n\t\treturn this.request(this.uri + '/' + id).then((response) => {\r\n\t\t\t// let model = new Model(response);\r\n\t\t\t// return this.objects[this.uri][id] = model;\r\n\t\t});\r\n\t}\r\n\tstatic form(id = null) {\r\n\t\tlet uri = this.uri + '/' + 'create';\r\n\t\tif(id) {\r\n\t\t\turi = this.uri + '/' + id + '/edit';\r\n\t\t}\r\n\t\treturn this.request(uri).then((skeleton) => {\r\n\t\t\treturn skeleton;\r\n\t\t});\r\n\t}\r\n\tstatic clearCache() {\r\n\t\tif(this.objects && this.objects[this.uri]) {\r\n\t\t\tthis.objects[this.uri] = {};\r\n\t\t}\r\n\t}\r\n\tstatic request(uri, args = null, post = null, cache = true) {\r\n\t\tlet type = 'GET';\r\n\t\tlet queryString = '';\r\n\t\tlet formData = null;\r\n\t\tlet queryArgs   = {};\r\n\r\n\t\tif(args) {\r\n\t\t\tqueryArgs   = args;\r\n\t\t}\r\n\r\n\t\tqueryArgs.api   = queryArgs.api || 'json';\r\n\r\n\t\tqueryString = Object.keys(queryArgs).map((arg) => {\r\n\t\t\treturn encodeURIComponent(arg)\r\n\t\t\t+ '='\r\n\t\t\t+ encodeURIComponent(queryArgs[arg])\r\n\t\t}).join('&');\r\n\r\n\t\tlet fullUri    = uri;\r\n\t\tlet postString = '';\r\n\r\n\t\tif(post) {\r\n\t\t\tcache = false;\r\n\t\t\ttype = 'POST';\r\n\t\t\tformData = new FormData();\r\n\t\t\tfor(let i in post) {\r\n\t\t\t\tformData.append(i, post[i]);\r\n\t\t\t}\r\n\t\t\tpostString = Object.keys(post).map((arg) => {\r\n\t\t\t\treturn encodeURIComponent(arg)\r\n\t\t\t\t+ '='\r\n\t\t\t\t+ encodeURIComponent(post[arg])\r\n\t\t\t}).join('&');\r\n\t\t}\r\n\r\n\t\tfullUri = uri + '?' + queryString;\r\n\r\n\t\tlet xhr = new XMLHttpRequest();\r\n\r\n\t\tif(!post && cache && this.cache && this.cache[fullUri]) {\r\n\t\t\treturn Promise.resolve(this.cache[fullUri]);\r\n\t\t}\r\n\r\n\t\tlet tagCacheSelector = 'script[data-uri=\"'\r\n\t\t\t+ fullUri\r\n\t\t\t+ '\"]';\r\n\r\n\t\tlet tagCache = document.querySelector(tagCacheSelector);\r\n\r\n\t\tif(!post && cache && tagCache) {\r\n\t\t\tlet tagCacheContent = JSON.parse(tagCache.innerText);\r\n\t\t\t\r\n\t\t\treturn Promise.resolve(tagCacheContent);\r\n\t\t}\r\n\r\n\t\txhr.withCredentials = true;\r\n\t\txhr.timeout         = 15000;\r\n\r\n\t\tlet xhrId = this.xhrs.length;\r\n\r\n\t\tif(!post) {\r\n\t\t\tthis.xhrs.push(xhr);\r\n\t\t}\r\n\r\n\t\treturn new Promise(((xhrId) => (resolve, reject) => {\r\n\t\t\txhr.onreadystatechange = () => {\r\n\t\t\t\tlet DONE = 4;\r\n\t\t\t\tlet OK = 200;\r\n\r\n\t\t\t\tlet response;\r\n\r\n\t\t\t\tif (xhr.readyState === DONE) {\r\n\r\n\t\t\t\t\tif(!this.cache) {\r\n\t\t\t\t\t\tthis.cache = {};\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (xhr.status === OK) {\r\n\r\n\t\t\t\t\t\tif(response = JSON.parse(xhr.responseText)) {\r\n\t\t\t\t\t\t\tif(response.code == 0) {\r\n\t\t\t\t\t\t\t\t// Repository.lastResponse = response;\r\n\r\n\t\t\t\t\t\t\t\tif(!post && cache) {\r\n\t\t\t\t\t\t\t\t\t// this.cache[fullUri] = response;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tlet tagCache = document.querySelector(\r\n\t\t\t\t\t\t\t\t\t'script[data-uri=\"'\r\n\t\t\t\t\t\t\t\t\t+ fullUri\r\n\t\t\t\t\t\t\t\t\t+ '\"]'\r\n\t\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t\tlet prerendering  = Cookie.get('prerenderer');\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tconsole.log(prerendering);\r\n\r\n\t\t\t\t\t\t\t\tif(prerendering)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tif(!tagCache)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\ttagCache  = document.createElement('script');\r\n\t\t\t\t\t\t\t\t\t\tdocument.querySelector('head').appendChild(tagCache);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\ttagCache.type = 'text/json';\r\n\t\t\t\t\t\t\t\t\ttagCache.setAttribute('data-uri', fullUri);\r\n\t\t\t\t\t\t\t\t\ttagCache.innerText = JSON.stringify(response);\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tresolve(response);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif(!post && cache) {\r\n\t\t\t\t\t\t\t\t\t// this.cache[fullUri] = response;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\treject(response);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t// Repository.lastResponse = xhr.responseText;\r\n\r\n\t\t\t\t\t\t\tif(!post && cache) {\r\n\t\t\t\t\t\t\t\t// this.cache[fullUri] = xhr.responseText;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tresolve(xhr.responseText);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\treject('HTTP' + xhr.status);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.xhrs[xhrId] = null;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\txhr.open(type, fullUri);\r\n\r\n\t\t\tif(post)\r\n\t\t\t{\r\n\t\t\t\txhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n\t\t\t}\r\n\t\t\txhr.send(postString);\r\n\t\t})(xhrId));\r\n\t}\r\n\tstatic cancel() {\r\n\t\tfor(var i in this.xhrs) {\r\n\t\t\tif(!this.xhrs[i]) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tthis.xhrs[i].abort();\r\n\t\t}\r\n\t\tthis.xhrList = [];\r\n\t}\r\n}\r\n\r\n// Repository.lastResponse = null;","import { View  }   from './View';\r\nimport { Cache }   from './Cache';\r\n\r\nexport class Router {\r\n\tstatic listen(mainView)\r\n\t{\r\n\t\twindow.addEventListener(\r\n\t\t\t'popstate'\r\n\t\t\t, (event) => {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\t//this.route(location.pathname);\r\n\t\t\t\t// console.log(location.pathname);\r\n\r\n\t\t\t\tthis.match(location.pathname, mainView);\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tthis.go(location.pathname);\r\n\t}\r\n\tstatic go(route, silent)\r\n\t{\r\n\t\tif(location.pathname !== route) {\r\n\t\t\thistory.pushState(null, null, route);\r\n\t\t}\r\n\t\tif(!silent)\r\n\t\t{\r\n\t\t\twindow.dispatchEvent(new Event('popstate'));\t\t\t\r\n\t\t}\r\n\t}\r\n\tstatic match(path, view, forceRefresh = false)\r\n\t{\r\n\t\tlet current = view.args.content;\r\n\t\tlet routes  = view.routes;\r\n\r\n\t\tthis.path   = path;\r\n\t\tthis.query  = {};\r\n\r\n\t\tlet query   = new URLSearchParams(window.location.search);\r\n\r\n\t\tthis.queryString = window.location.search;\r\n\r\n\t\tfor(let pair of query) { \r\n\t\t\tthis.query[ pair[0] ] = pair[1]; \r\n\t\t}\r\n\r\n\t\t// forceRefresh = true;\r\n\r\n\t\tlet result;\r\n\r\n\t\t// if(!forceRefresh && (result = Cache.load(this.path, false, 'page')))\r\n\t\t// {\r\n\t\t// \t// console.log('Using cache!');\r\n\r\n\t\t// \tview.args.content.pause(true);\r\n\r\n\t\t// \tview.args.content = result;\r\n\r\n\t\t// \tresult.pause(false);\r\n\r\n\t\t// \tresult.update(this.query);\r\n\r\n\t\t// \treturn;\r\n\t\t// }\r\n\r\n\t\tpath = path.substr(1).split('/');\r\n\r\n\t\t// console.log(path, routes);\r\n\r\n\t\tlet args = {};\r\n\t\tfor(let i in this.query)\r\n\t\t{\r\n\t\t\targs[i] = this.query[i];\r\n\t\t}\r\n\r\n\t\tL1: for(let i in routes) {\r\n\t\t\tlet route = i.split('/');\r\n\t\t\tif(route.length < path.length)\r\n\t\t\t{\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tL2: for(let j in route)\r\n\t\t\t{\r\n\t\t\t\tif(route[j].substr(0, 1) == '%') {\r\n\t\t\t\t\tlet argName = null;\r\n\t\t\t\t\tlet groups  = /^%(\\w+)\\??/.exec(route[j]);\r\n\t\t\t\t\tif(groups && groups[1]) {\r\n\t\t\t\t\t\targName = groups[1];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!argName) {\r\n\t\t\t\t\t\tthrow new Error(`${route[j]} is not a valid argument segment in route \"${i}\"`);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!path[j]) {\r\n\t\t\t\t\t\tif(route[j].substr(route[j].length - 1, 1) == '?') {\r\n\t\t\t\t\t\t\targs[ argName ] = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tcontinue L1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\targs[ argName ] = path[j];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if(path[j] !== route[j]) {\r\n\t\t\t\t\tcontinue L1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(typeof routes[i] !== 'function') {\r\n\t\t\t\treturn routes[i];\r\n\t\t\t}\r\n\r\n\t\t\t// if(!forceRefresh\r\n\t\t\t// \t&& current\r\n\t\t\t// \t&& current instanceof routes[i]\r\n\t\t\t// \t&& current.update(args)\r\n\t\t\t// ) {\r\n\t\t\t// \tview.args.content = current;\r\n\r\n\t\t\t// \treturn true;\r\n\t\t\t// }\r\n\r\n\t\t\tlet result = routes[i];\r\n\r\n\t\t\tif(routes[i] instanceof Object)\r\n\t\t\t{\r\n\t\t\t\tresult = new routes[i](args);\r\n\t\t\t}\r\n\r\n\t\t\tif(result instanceof View)\r\n\t\t\t{\r\n\t\t\t\tresult.pause(false);\r\n\t\t\t}\r\n\r\n\t\t\tresult.update(args, forceRefresh);\r\n\r\n\t\t\tif(view.args.content instanceof View)\r\n\t\t\t{\r\n\t\t\t\tview.args.content.pause(true);\r\n\t\t\t}\t\t\t\r\n\r\n\t\t\t// Cache.store(this.path, result, 3600, 'page');\r\n\r\n\t\t\tview.args.content = result;\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tif(routes && routes[false])\r\n\t\t{\r\n\t\t\tif(!forceRefresh\r\n\t\t\t\t&& current\r\n\t\t\t\t&& current instanceof routes[false]\r\n\t\t\t\t&& current.update(args)\r\n\t\t\t) {\r\n\t\t\t\tview.args.content = current;\r\n\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tif(typeof routes[false] !== 'function') {\r\n\t\t\t\tview.args.content = routes[false];\r\n\t\t\t}\r\n\r\n\t\t\tlet result = routes[false];\r\n\r\n\t\t\tif(result instanceof View)\r\n\t\t\t{\r\n\t\t\t\tresult.pause(false);\r\n\t\t\t}\r\n\r\n\t\t\tif(routes[false] instanceof Object)\r\n\t\t\t{\r\n\t\t\t\tresult = new routes[false](args);\r\n\t\t\t}\r\n\r\n\t\t\tresult.update(args, forceRefresh);\r\n\r\n\t\t\tif(view.args.content instanceof View)\r\n\t\t\t{\r\n\t\t\t\tview.args.content.pause(true);\r\n\t\t\t}\r\n\r\n\t\t\tview.args.content = result;\r\n\r\n\t\t\tCache.store(this.path, result, 3600, 'page');\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\tstatic clearCache() {\r\n\t\t// this.cache = {};\r\n\t}\r\n\tstatic queryOver(args = {})\r\n\t{\r\n\t\tlet parts = [], finalArgs = {};\r\n\r\n\t\tfor(let i in this.query)\r\n\t\t{\r\n\t\t\tfinalArgs[i] = this.query[i];\r\n\t\t}\r\n\r\n\t\tfor(let i in args)\r\n\t\t{\r\n\t\t\tfinalArgs[i] = args[i];\r\n\t\t}\r\n\r\n\t\tdelete finalArgs['api'];\r\n\r\n\t\treturn finalArgs;\r\n\t}\r\n\tstatic queryToString(args = {}, fresh = false)\r\n\t{\r\n\t\tlet parts = [], finalArgs = args;\r\n\r\n\t\tif(!fresh)\r\n\t\t{\r\n\t\t\tfinalArgs = this.queryOver(args);\r\n\t\t}\r\n\t\t\r\n\t\tfor(let i in finalArgs)\r\n\t\t{\r\n\t\t\tif(finalArgs[i] === '')\r\n\t\t\t{\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tparts.push(i + '=' + encodeURIComponent(finalArgs[i]));\r\n\t\t}\r\n\r\n\t\treturn parts.join('&');\r\n\t}\r\n\tstatic setQuery(name, value, silent)\r\n\t{\r\n\t\tlet args = {};\r\n\r\n\t\targs[name] = value;\r\n\t\t\r\n\t\tthis.go(\r\n\t\t\tthis.path\r\n\t\t\t\t+ '?'\r\n\t\t\t\t+ this.queryToString(args)\r\n\t\t\t, silent\r\n\t\t);\r\n\t}\r\n}\r\n","import { Bindable } from './Bindable';\r\nexport class Tag\r\n{\r\n\tconstructor(element, parent, ref, index)\r\n\t{\r\n\t\tthis.element = Bindable.makeBindable(element);\r\n\t\tthis.parent  = parent;\r\n\t\tthis.ref     = ref;\r\n\t\tthis.index   = index;\r\n\r\n\t\tthis.proxy   = Bindable.makeBindable(this)\r\n\t\tthis.cleanup = [];\r\n\r\n\t\treturn this.proxy;\r\n\t}\r\n\tremove()\r\n\t{\r\n\t\tlet cleanup;\r\n\r\n\t\twhile(cleanup = this.cleanup.shift())\r\n\t\t{\r\n\t\t\tcleanup();\r\n\t\t}\r\n\r\n\t\tBindable.clearBindings(this);\r\n\t}\r\n\tclear()\r\n\t{\r\n\t\twhile(this.element.firstChild)\r\n\t\t{\r\n\t\t\tthis.element.removeChild(this.element.firstChild);\r\n\t\t}\r\n\t}\r\n}\r\n","export class Theme\r\n{\r\n\tconstructor()\r\n\t{\r\n\t\tthis.views = {\r\n\t\t\t'SeanMorris\\\\TheWhtRbt\\\\Location' : {\r\n\t\t\t\tsingle: 'twr9/LocationPreview'\r\n\t\t\t\t, list: 'twr9/LocationList'\r\n\t\t\t}\r\n\t\t\t, 'SeanMorris\\\\TheWhtRbt\\\\Image' : {\r\n\t\t\t\tsingle: 'DetailView'\r\n\t\t\t\t, list: 'DetailListView'\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tresolve(model)\r\n\t{\r\n\t\tlet modelClass;\r\n\r\n\t\tif(Array.isArray(model))\r\n\t\t{\r\n\t\t\tfor(let i in model)\r\n\t\t\t{\r\n\t\t\t\tlet _modelClass = model[i].class || model[i].content_type;\r\n\r\n\t\t\t\tif(modelClass && modelClass !== _modelClass)\r\n\t\t\t\t{\r\n\t\t\t\t\tthrow new Error('Model list mismatch!');\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tmodelClass = _modelClass;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(this.views[modelClass])\r\n\t\t\t{\r\n\t\t\t\tif(this.views[modelClass].list)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.views[modelClass].list;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this.views[modelClass];\r\n\t\t\t}\r\n\r\n\t\t\treturn 'DetailListView';\r\n\t\t}\r\n\t\telse if(model)\r\n\t\t{\r\n\t\t\tmodelClass = model.class || model.content_type;\r\n\r\n\t\t\tif(this.views[modelClass])\r\n\t\t\t{\r\n\t\t\t\tif(this.views[modelClass].single)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.views[modelClass].single;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this.views[modelClass];\r\n\t\t\t}\r\n\r\n\t\t\treturn 'DetailView';\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n}\r\n","import { Bindable } from './Bindable';\r\nimport { ViewList } from './ViewList';\r\nimport { Router   } from './Router';\r\nimport { Cookie   } from './Cookie';\r\nimport { Dom      } from './Dom';\r\nimport { Tag      } from './Tag';\r\n\r\nexport class View\r\n{\r\n\tconstructor(args = {})\r\n\t{\r\n\t\tthis.args      = Bindable.makeBindable(args);\r\n\t\tthis._id       = this.uuid();\r\n\t\tthis.args._id  = this._id;\r\n\t\tthis.template  = ``;\r\n\t\tthis.parent    = null;\r\n\r\n\t\tthis.firstNode = null;\r\n\t\tthis.lastNode  = null;\r\n\t\tthis.nodes     = null;\r\n\r\n\t\tthis.frames    = [];\r\n\t\tthis.timeouts  = [];\r\n\t\tthis.intervals = [];\r\n\r\n\t\tthis.cleanup   = [];\r\n\r\n\t\tthis.attach    = [];\r\n\t\tthis.detach    = [];\r\n\r\n\t\tthis.eventCleanup = [];\r\n\r\n\t\tthis.parent    = null;\r\n\t\tthis.viewList  = null;\r\n\t\tthis.viewLists = {};\r\n\r\n\t\tthis.tags      = {};\r\n\r\n\t\tthis.intervals = [];\r\n\t\tthis.timeouts  = [];\r\n\t\tthis.frames    = [];\r\n\t}\r\n\r\n\tonFrame(callback) {\r\n\t\tlet c = (timestamp) => {\r\n\t\t\tcallback(timestamp);\r\n\t\t\twindow.requestAnimationFrame(c);\r\n\t\t};\r\n\r\n\t\tc();\r\n\t}\r\n\r\n\tonTimeout(time, callback) {\r\n\t\tlet wrappedCallback = () => {\r\n\t\t\tthis.timeouts[index].fired = true;\r\n\t\t\tcallback();\r\n\t\t};\r\n\t\tlet timeout = setTimeout(wrappedCallback, time)\r\n\t\tlet index   = this.timeouts.length;\r\n\r\n\t\tthis.timeouts.push({\r\n\t\t\ttimeout:    timeout\r\n\t\t\t, callback: wrappedCallback\r\n\t\t\t, time:     time\r\n\t\t\t, fired:    false\r\n\t\t\t, created:  (new Date).getTime()\r\n\t\t\t, paused:   false\r\n\t\t});\r\n\r\n\t\treturn timeout;\r\n\t}\r\n\r\n\tclearTimeout(timeout) {\r\n\t\tfor(var i in this.timeouts) {\r\n\t\t\tif(timeout === this.timeouts[i].timeout) {\r\n\t\t\t\tclearInterval(this.timeouts[i].timeout);\r\n\r\n\t\t\t\tdelete this.timeouts[i];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tonInterval(time, callback) {\r\n\t\tlet timeout = setInterval(callback, time);\r\n\r\n\t\tthis.intervals.push({\r\n\t\t\ttimeout:    timeout\r\n\t\t\t, callback: callback\r\n\t\t\t, time:     time\r\n\t\t\t, paused:   false\r\n\t\t});\r\n\r\n\t\treturn timeout;\r\n\t}\r\n\r\n\tclearInterval(timeout) {\r\n\t\tfor(var i in this.intervals) {\r\n\t\t\tif(timeout === this.intervals[i].timeout) {\r\n\t\t\t\tclearInterval(this.intervals[i].timeout);\r\n\r\n\t\t\t\tdelete this.intervals[i];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpause(paused = undefined)\r\n\t{\r\n\t\tif(paused === undefined)\r\n\t\t{\r\n\t\t\tthis.paused = !this.paused;\r\n\t\t}\r\n\r\n\t\tthis.paused = paused;\r\n\r\n\t\tif(this.paused)\r\n\t\t{\r\n\t\t\tfor(let i in this.timeouts)\r\n\t\t\t{\r\n\t\t\t\tif(this.timeouts[i].fired)\r\n\t\t\t\t{\r\n\t\t\t\t\tdelete this.timeouts[i];\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tclearTimeout(this.timeouts[i].timeout);\r\n\t\t\t}\r\n\r\n\t\t\tfor(let i in this.intervals)\r\n\t\t\t{\r\n\t\t\t\tclearInterval(this.intervals[i].timeout);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tfor(let i in this.timeouts)\r\n\t\t\t{\r\n\t\t\t\tif(!this.timeouts[i].timeout.paused)\r\n\t\t\t\t{\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(this.timeouts[i].fired)\r\n\t\t\t\t{\r\n\t\t\t\t\tdelete this.timeouts[i];\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.timeouts[i].timeout = setTimeout(\r\n\t\t\t\t\tthis.timeouts[i].callback\r\n\t\t\t\t\t, this.timeouts[i].time\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tfor(let i in this.intervals)\r\n\t\t\t{\r\n\t\t\t\tif(!this.intervals[i].timeout.paused)\r\n\t\t\t\t{\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.intervals[i].timeout.paused = false;\r\n\r\n\t\t\t\tthis.intervals[i].timeout = setInterval(\r\n\t\t\t\t\tthis.intervals[i].callback\r\n\t\t\t\t\t, this.intervals[i].time\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\trender(parentNode = null, insertPoint = null)\r\n\t{\r\n\t\tif(this.nodes)\r\n\t\t{\r\n\t\t\tfor(let i in this.detach)\r\n\t\t\t{\r\n\t\t\t\tthis.detach[i]();\r\n\t\t\t}\r\n\r\n\t\t\tfor(let i in this.nodes)\r\n\t\t\t{\r\n\t\t\t\tlet detachEvent = new Event('cvDomDetached', {bubbles: true, target: this.nodes[i]});\r\n\t\t\t\tlet attachEvent = new Event('cvDomAttached', {bubbles: true, target: this.nodes[i]});\r\n\r\n\t\t\t\tthis.nodes[i].dispatchEvent(detachEvent);\r\n\r\n\t\t\t\tDom.mapTags(this.nodes[i], false, (node) => {\r\n\t\t\t\t\tnode.dispatchEvent(detachEvent);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif(parentNode)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(insertPoint)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tparentNode.insertBefore(this.nodes[i], insertPoint);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tparentNode.appendChild(this.nodes[i]);\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tDom.mapTags(this.nodes[i], false, (node) => {\r\n\t\t\t\t\tnode.dispatchEvent(attachEvent);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.nodes[i].dispatchEvent(attachEvent);\r\n\t\t\t}\r\n\r\n\t\t\tfor(let i in this.attach)\r\n\t\t\t{\r\n\t\t\t\tthis.attach[i]();\r\n\t\t\t}\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet subDoc;\r\n\r\n\t\tif(this.template == document)\r\n\t\t{\r\n\t\t\tsubDoc = this.template;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tsubDoc = document.createRange().createContextualFragment(this.template);\r\n\t\t}\r\n\r\n\t\tDom.mapTags(subDoc, '[cv-prerender]', (tag) => {\r\n\t\t\tlet prerenderAttr = tag.getAttribute('cv-prerender');\r\n\t\t\tlet prerendering  = Cookie.get('prerenderer');\r\n\r\n\t\t\tif(prerenderAttr == 'never' && prerendering\r\n\t\t\t\t|| prerenderAttr == 'only' && !prerendering\r\n\t\t\t){\r\n\t\t\t\ttag.parentNode.removeChild(tag);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tDom.mapTags(subDoc, '[cv-each]', (tag) => {\r\n\t\t\tlet eachAttr = tag.getAttribute('cv-each');\r\n\t\t\tlet carryAttr = tag.getAttribute('cv-carry');\r\n\t\t\ttag.removeAttribute('cv-each');\r\n\t\t\ttag.removeAttribute('cv-carry');\r\n\r\n\t\t\tlet subTemplate = tag.innerHTML;\r\n\r\n\t\t\twhile(tag.firstChild)\r\n\t\t\t{\r\n\t\t\t\ttag.removeChild(tag.firstChild);\r\n\t\t\t}\r\n\r\n\t\t\tlet carryProps = [];\r\n\r\n\t\t\tif(carryAttr)\r\n\t\t\t{\r\n\t\t\t\tcarryProps = carryAttr.split(',');\r\n\t\t\t}\r\n\r\n\t\t\tlet [eachProp, asProp, keyProp] = eachAttr.split(':');\r\n\r\n\t\t\t// console.log(this, eachProp);\r\n\r\n\t\t\tlet viewList;\r\n\r\n\t\t\tthis.args.bindTo(eachProp, (v, k, t)=>{\r\n\t\t\t\tif(viewList)\r\n\t\t\t\t{\r\n\t\t\t\t\tviewList.remove();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tviewList = new ViewList(subTemplate, asProp, v, keyProp);\r\n\r\n\t\t\t\tthis.cleanup.push(((viewList)=>()=>{\r\n\t\t\t\t\tviewList.remove();\r\n\t\t\t\t})(viewList));\r\n\r\n\t\t\t\tviewList.parent = this;\r\n\r\n\t\t\t\tviewList.render(tag);\r\n\r\n\t\t\t\tfor(let i in carryProps)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.args.bindTo(carryProps[i], (v, k) => {\r\n\t\t\t\t\t\tviewList.args.subArgs[k] = v;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tthis.viewLists[eachProp] = viewList;\r\n\t\t});\r\n\r\n\t\tDom.mapTags(subDoc, '[cv-with]', (tag) => {\r\n\t\t\tlet withAttr = tag.getAttribute('cv-with');\r\n\t\t\tlet carryAttr = tag.getAttribute('cv-carry');\r\n\t\t\ttag.removeAttribute('cv-with');\r\n\t\t\ttag.removeAttribute('cv-carry');\r\n\r\n\t\t\tlet subTemplate = tag.innerHTML;\r\n\r\n\t\t\tlet carryProps = [];\r\n\r\n\t\t\tif(carryAttr)\r\n\t\t\t{\r\n\t\t\t\tcarryProps = carryAttr.split(',');\r\n\t\t\t}\r\n\r\n\t\t\twhile(tag.firstChild)\r\n\t\t\t{\r\n\t\t\t\ttag.removeChild(tag.firstChild);\r\n\t\t\t}\r\n\r\n\t\t\tlet view = new View();\r\n\r\n\t\t\tthis.cleanup.push(((view)=>()=>{\r\n\t\t\t\t// view.remove();\r\n\t\t\t})(view));\r\n\r\n\t\t\tview.template = subTemplate;\r\n\t\t\tview.parent   = this;\r\n\r\n\t\t\t// console.log(carryProps);\r\n\r\n\t\t\tfor(let i in carryProps)\r\n\t\t\t{\r\n\t\t\t\tthis.args.bindTo(carryProps[i], (v, k) => {\r\n\t\t\t\t\tview.args[k] = v;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tfor(let i in this.args[withAttr])\r\n\t\t\t{\r\n\t\t\t\tthis.args[withAttr].bindTo(i, (v, k) => {\r\n\t\t\t\t\tview.args[k] = v;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// console.log(view);\r\n\r\n\t\t\tview.render(tag);\r\n\t\t});\r\n\r\n\t\tDom.mapTags(subDoc, '[cv-link]', (tag) => {\r\n\t\t\tlet LinkAttr = tag.getAttribute('cv-link');\r\n\r\n\t\t\ttag.setAttribute('href', LinkAttr);\r\n\r\n\t\t\tlet linkClick = (event) => {\r\n\t\t\t\tevent.preventDefault();\r\n\r\n\t\t\t\tRouter.go(tag.getAttribute('href'));\r\n\t\t\t};\r\n\r\n\t\t\ttag.addEventListener('click', linkClick);\r\n\r\n\t\t\tthis.cleanup.push( ((tag, eventListener) => ()=>{\r\n\t\t\t\ttag.removeEventListener('click', eventListener);\r\n\t\t\t\ttag           = undefined;\r\n\t\t\t\teventListener = undefined;\r\n\t\t\t})(tag, linkClick));\r\n\r\n\t\t\ttag.removeAttribute('cv-link');\r\n\t\t});\r\n\r\n\t\tDom.mapTags(subDoc, '[cv-on]', (tag)=>{\r\n\t\t\tlet action = String(tag.getAttribute('cv-on'))\r\n\t\t\t\t.split(/;/)\r\n\t\t\t\t.map((a) => a.split(':'))\r\n\t\t\t\t.map(((object, tag) => (a) => {\r\n\t\t\t\t\tvar eventName    = a[0].replace(/(^[\\s\\n]+|[\\s\\n]+$)/, '');\r\n\t\t\t\t\tvar callbackName = a[1];\r\n\t\t\t\t\tvar argList      = [];\r\n\t\t\t\t\tvar groups = /(\\w+)(?:\\(([\\w\\s,]+)\\))?/.exec(callbackName);\r\n\t\t\t\t\tif(groups.length) {\r\n\t\t\t\t\t\tcallbackName = groups[1].replace(/(^[\\s\\n]+|[\\s\\n]+$)/, '');\r\n\t\t\t\t\t\tif(groups[2]) {\r\n\t\t\t\t\t\t\targList = groups[2].split(',').map(s => s.trim());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet eventMethod;\r\n\t\t\t\t\tlet parent = this;\r\n\r\n\t\t\t\t\twhile(parent)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif(parent[ callbackName ])\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\teventMethod = (...args) => {\r\n\t\t\t\t\t\t\t\tparent[ callbackName ](...args);\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif(parent.viewList && parent.viewList.parent)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tparent = parent.viewList.parent;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(parent.parent)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tparent = parent.parent;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet eventListener = ((object) => (event) => {\r\n\t\t\t\t\t\tlet argRefs = argList.map((arg) => {\r\n\t\t\t\t\t\t\tif(arg === 'event') {\r\n\t\t\t\t\t\t\t\treturn event;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(arg in object.args) {\r\n\t\t\t\t\t\t\t\treturn object.args[arg];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// console.log(argList, argRefs);\r\n\t\t\t\t\t\tif(!(typeof eventMethod == 'function')) {\r\n\t\t\t\t\t\t\t// console.log(object);\r\n\t\t\t\t\t\t\t// console.trace();\r\n\t\t\t\t\t\t\t// console.log(this);\r\n\t\t\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\t\t`${callbackName} is not defined on View object.\r\n\r\nTag:\r\n\r\n${tag.outerHTML}`\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\teventMethod(...argRefs);\r\n\t\t\t\t\t})(object);\r\n\r\n\r\n\t\t\t\t\tswitch(eventName)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcase '_init':\r\n\t\t\t\t\t\t\teventListener();\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase '_attach':\r\n\t\t\t\t\t\t\tthis.attach.push(eventListener);\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase '_detach':\r\n\t\t\t\t\t\t\tthis.detach.push(eventListener);\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\ttag.addEventListener(eventName, eventListener);\r\n\r\n\t\t\t\t\t\t\tthis.cleanup.push(\r\n\t\t\t\t\t\t\t\t((tag, eventName, eventListener) => ()=>{\r\n\t\t\t\t\t\t\t\t\ttag.removeEventListener(eventName, eventListener);\r\n\t\t\t\t\t\t\t\t\ttag           = undefined;\r\n\t\t\t\t\t\t\t\t\teventListener = undefined;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t)(tag, eventName, eventListener));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn [eventName, callbackName, argList];\r\n\t\t\t\t})(this, tag));\r\n\r\n\t\t\ttag.removeAttribute('cv-on');\r\n\t\t});\r\n\r\n\t\tDom.mapTags(subDoc, '[cv-bind]', (tag) => {\r\n\t\t\tlet bindArg = tag.getAttribute('cv-bind');\r\n\t\t\tthis.args.bindTo(bindArg, (v,k,t) => {\r\n\t\t\t\tif(t[k] === v)\r\n\t\t\t\t{\r\n\t\t\t\t\t// return;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(t[k] instanceof View)\r\n\t\t\t\t{\r\n\t\t\t\t\tt[k].remove();\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tif(tag.tagName == 'INPUT' || tag.tagName == 'SELECT') {\r\n\t\t\t\t\tlet type = tag.getAttribute('type');\r\n\t\t\t\t\tif(type && type.toLowerCase() == 'checkbox') {\r\n\t\t\t\t\t\tif(v) {\r\n\t\t\t\t\t\t\ttag.checked = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\ttag.checked = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(type !== 'file') {\r\n\t\t\t\t\t\ttag.value = v || '';\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(v instanceof View)\r\n\t\t\t\t{\r\n\t\t\t\t\tv.render(tag);\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\ttag.innerText = v;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tlet inputListener = (event) => {\r\n\t\t\t\tif(event.target.getAttribute('type') !== 'password')\r\n\t\t\t\t{\r\n\t\t\t\t\tconsole.log(event.target.value);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(event.target !== tag) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// console.log(event.target.value);\r\n\r\n\t\t\t\tthis.args[bindArg] = event.target.value;\r\n\t\t\t};\r\n\r\n\t\t\ttag.addEventListener('input',         inputListener);\r\n\t\t\ttag.addEventListener('change',        inputListener);\r\n\t\t\ttag.addEventListener('value-changed', inputListener);\r\n\r\n\t\t\tthis.cleanup.push( ((tag, eventListener) => ()=>{\r\n\t\t\t\ttag.removeEventListener('input',         inputListener);\r\n\t\t\t\ttag.removeEventListener('change',        inputListener);\r\n\t\t\t\ttag.removeEventListener('value-changed', inputListener);\r\n\t\t\t\ttag           = undefined;\r\n\t\t\t\teventListener = undefined;\r\n\t\t\t})(tag, inputListener));\r\n\r\n\t\t\ttag.removeAttribute('cv-bind');\r\n\t\t});\r\n\r\n\t\tDom.mapTags(subDoc, false, (tag) => {\r\n\t\t\tlet regex    = /(\\[\\[(\\$?\\w+)\\]\\])/g;\r\n\r\n\t\t\tif(tag.nodeType == Node.TEXT_NODE)\r\n\t\t\t{\r\n\t\t\t\tlet original = tag.nodeValue;\r\n\r\n\t\t\t\tif(!this.interpolatable(original))\r\n\t\t\t\t{\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet header   = 0;\r\n\t\t\t\tlet match;\r\n\r\n\t\t\t\twhile(match = regex.exec(original))\r\n\t\t\t\t{\r\n\t\t\t\t\tlet bindProperty = match[2];\r\n\r\n\t\t\t\t\tlet unsafeHtml = false;\r\n\r\n\t\t\t\t\tif(bindProperty.substr(0, 1) === '$')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tunsafeHtml   = true;\r\n\t\t\t\t\t\tbindProperty = bindProperty.substr(1);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet staticPrefix = original.substring(header, match.index);\r\n\r\n\t\t\t\t\theader = match.index + match[1].length;\r\n\r\n\t\t\t\t\tlet staticNode = document.createTextNode(staticPrefix);\r\n\r\n\t\t\t\t\ttag.parentNode.insertBefore(staticNode, tag);\r\n\r\n\t\t\t\t\tlet dynamicNode;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(unsafeHtml)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdynamicNode = document.createElement('div');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdynamicNode = document.createTextNode('');\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\ttag.parentNode.insertBefore(dynamicNode, tag);\r\n\r\n\t\t\t\t\tthis.args.bindTo(bindProperty, ((dynamicNode,unsafeHtml) => (v,k,t) => {\r\n\t\t\t\t\t\t// console.log(`Setting ${k} to ${v}`, dynamicNode);\r\n\t\t\t\t\t\tif(t[k] instanceof View)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tt[k].remove();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdynamicNode.nodeValue = '';\r\n\r\n\t\t\t\t\t\tif(v instanceof View)\r\n\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\tv.render(tag.parentNode, dynamicNode);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t// console.log(dynamicNode);\r\n\t\t\t\t\t\t\tif(unsafeHtml)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tdynamicNode.innerHTML = v;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tdynamicNode.nodeValue = v;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})(dynamicNode,unsafeHtml));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet staticSuffix = original.substring(header)\r\n\r\n\t\t\t\tlet staticNode = document.createTextNode(staticSuffix);\r\n\r\n\t\t\t\ttag.parentNode.insertBefore(staticNode, tag);\r\n\r\n\t\t\t\ttag.nodeValue = '';\r\n\t\t\t}\r\n\r\n\t\t\tif(tag.nodeType == Node.ELEMENT_NODE)\r\n\t\t\t{\r\n\t\t\t\tfor (let i = 0; i < tag.attributes.length; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(!this.interpolatable(tag.attributes[i].value))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet header    = 0;\r\n\t\t\t\t\tlet match;\r\n\t\t\t\t\tlet original  = tag.attributes[i].value;\r\n\t\t\t\t\tlet attribute = tag.attributes[i];\r\n\r\n\t\t\t\t\tlet bindProperties = {};\r\n\t\t\t\t\tlet segments       = [];\r\n\r\n\t\t\t\t\twhile(match = regex.exec(original))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsegments.push(original.substring(header, match.index));\r\n\r\n\t\t\t\t\t\tif(!bindProperties[match[2]])\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tbindProperties[match[2]] = [];\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbindProperties[match[2]].push(segments.length);\r\n\r\n\t\t\t\t\t\tsegments.push(match[1]);\r\n\r\n\t\t\t\t\t\theader = match.index + match[1].length;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tsegments.push(original.substring(header));\r\n\r\n\t\t\t\t\tfor(let j in bindProperties)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.args.bindTo(j, (v, k, t, d) => {\r\n\t\t\t\t\t\t\tfor(let i in bindProperties)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tfor(let j in bindProperties[i])\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tsegments[ bindProperties[i][j] ] = t[i];\r\n\r\n\t\t\t\t\t\t\t\t\tif(k === i)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tsegments[ bindProperties[i][j] ] = v;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttag.setAttribute(attribute.name, segments.join(''));\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// console.log(bindProperties, segments);\r\n\r\n\t\t\t\t\t// console.log(tag.attributes[i].name, tag.attributes[i].value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tDom.mapTags(subDoc, '[cv-ref]', (tag) => {\r\n\t\t\tlet refAttr                         = tag.getAttribute('cv-ref');\r\n\t\t\tlet [refProp, refClassname, refKey] = refAttr.split(':');\r\n\r\n\t\t\tlet refClass = this.stringToClass(refClassname);\r\n\r\n\t\t\ttag.removeAttribute('cv-ref');\r\n\r\n\t\t\tif(this.viewList)\r\n\t\t\t{\r\n\t\t\t\tif(!this.viewList.parent.tags[refProp])\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.viewList.parent.tags[refProp] = [];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet refKeyVal = this.args[refKey];\r\n\r\n\t\t\t\tthis.viewList.parent.tags[refProp][refKeyVal] = new refClass(\r\n\t\t\t\t\ttag, this, refProp, refKeyVal\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tthis.tags[refProp] = new refClass(\r\n\t\t\t\t\ttag, this, refProp\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tDom.mapTags(subDoc, '[cv-if]', this.mapIfTags.bind(this));\r\n\r\n\t\tthis.nodes = [];\r\n\r\n\t\tthis.firstNode = document.createComment(`Template ${this._id} Start`);\r\n\r\n\t\tthis.nodes.push(this.firstNode);\r\n\r\n\t\tif(parentNode)\r\n\t\t{\r\n\t\t\tif(insertPoint)\r\n\t\t\t{\r\n\t\t\t\tparentNode.insertBefore(this.firstNode, insertPoint);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tparentNode.appendChild(this.firstNode);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\twhile(subDoc.firstChild)\r\n\t\t{\r\n\t\t\tlet newNode = subDoc.firstChild;\r\n\t\t\tlet attachEvent = new Event('cvDomAttached', {bubbles: true, target: newNode});\r\n\r\n\t\t\tthis.nodes.push(subDoc.firstChild);\r\n\r\n\t\t\tif(parentNode)\r\n\t\t\t{\r\n\t\t\t\tif(insertPoint)\r\n\t\t\t\t{\r\n\t\t\t\t\tparentNode.insertBefore(subDoc.firstChild, insertPoint);\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tparentNode.appendChild(subDoc.firstChild);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tDom.mapTags(newNode, false, (node) => {\r\n\t\t\t\t// node.dispatchEvent(attachEvent);\r\n\t\t\t});\r\n\r\n\t\t\tnewNode.dispatchEvent(attachEvent);\r\n\t\t}\r\n\r\n\t\tthis.lastNode = document.createComment(`Template ${this._id} End`);\r\n\r\n\t\tthis.nodes.push(this.lastNode);\r\n\r\n\t\tif(parentNode)\r\n\t\t{\r\n\t\t\tif(insertPoint)\r\n\t\t\t{\r\n\t\t\t\tparentNode.insertBefore(this.lastNode, insertPoint);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tparentNode.appendChild(this.lastNode);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor(let i in this.attach)\r\n\t\t{\r\n\t\t\tthis.attach[i]();\r\n\t\t}\r\n\r\n\t\tthis.postRender(parentNode);\r\n\r\n\t\t// return this.nodes;\r\n\t}\r\n\t\r\n\tmapIfTags(tag)\r\n\t{\r\n\t\tlet ifProperty = tag.getAttribute('cv-if');\r\n\r\n\t\tlet inverted = false;\r\n\r\n\t\tif(ifProperty.substr(0, 1) === '!')\r\n\t\t{\r\n\t\t\tinverted   = true;\r\n\t\t\tifProperty = ifProperty.substr(1);\r\n\t\t}\r\n\r\n\t\tlet ifDoc = document.createRange().createContextualFragment('');\r\n\r\n\t\tthis.args.bindTo(\r\n\t\t\tifProperty\r\n\t\t\t, ((tag, ifDoc) => (v) => {\r\n\t\t\t\tlet detachEvent = new Event('cvDomDetached');\r\n\t\t\t\tlet attachEvent = new Event('cvDomAttached');\r\n\r\n\t\t\t\tif(inverted)\r\n\t\t\t\t{\r\n\t\t\t\t\tv = !v;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tDom.mapTags(tag, '[cv-if]', this.mapIfTags.bind(this));\r\n\r\n\t\t\t\tif(v)\r\n\t\t\t\t{\r\n\t\t\t\t\twhile(ifDoc.firstChild)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlet moveTag = ifDoc.firstChild;\r\n\r\n\t\t\t\t\t\ttag.prepend(moveTag);\r\n\r\n\t\t\t\t\t\tmoveTag.dispatchEvent(attachEvent);\r\n\r\n\t\t\t\t\t\tDom.mapTags(moveTag, false, (node) => {\r\n\t\t\t\t\t\t\tnode.dispatchEvent(attachEvent);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\twhile(tag.firstChild)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlet moveTag = tag.firstChild;\r\n\r\n\t\t\t\t\t\tifDoc.prepend(moveTag);\r\n\r\n\t\t\t\t\t\tmoveTag.dispatchEvent(detachEvent);\r\n\r\n\t\t\t\t\t\tDom.mapTags(moveTag, false, (node) => {\r\n\t\t\t\t\t\t\tnode.dispatchEvent(detachEvent);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})(tag, ifDoc)\r\n\t\t);\r\n\r\n\t\ttag.removeAttribute('cv-if');\r\n\t}\r\n\r\n\tpostRender(parentNode)\r\n\t{\r\n\r\n\t}\r\n\r\n\tinterpolatable(str)\r\n\t{\r\n\t\treturn !!(String(str).match(/\\[\\[\\$?\\w+\\??\\]\\]/));\r\n\t}\r\n\r\n\tuuid() {\r\n\t\treturn ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(\r\n\t\t\t/[018]/g\r\n\t\t\t, c => (\r\n\t\t\t\tc ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4\r\n\t\t\t).toString(16)\r\n\t\t);\r\n\t}\r\n\tremove()\r\n\t{\r\n\t\tfor(let i in this.nodes)\r\n\t\t{\r\n\t\t\tthis.nodes[i].remove();\r\n\t\t}\r\n\r\n\t\tlet cleanup;\r\n\r\n\t\twhile(cleanup = this.cleanup.shift())\r\n\t\t{\r\n\t\t\tcleanup();\r\n\t\t}\r\n\r\n\t\tfor(let i in this.tags)\r\n\t\t{\r\n\t\t\tif(Array.isArray(this.tags[i]))\r\n\t\t\t{\r\n\t\t\t\tfor(var j in this.tags[i])\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.tags[i][j].remove();\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tthis.tags[i].remove();\r\n\t\t}\r\n\r\n\t\tBindable.clearBindings(this);\r\n\t}\r\n\r\n\tupdate()\r\n\t{\r\n\r\n\t}\r\n\r\n\tbeforeUpdate(args)\r\n\t{\r\n\r\n\t}\r\n\r\n\tafterUpdate(args)\r\n\t{\r\n\r\n\t}\r\n\r\n\tstringToClass(refClassname)\r\n\t{\r\n\t\tlet refClassSplit           = refClassname.split('/');\r\n\t\tlet refShortClassname       = refClassSplit[ refClassSplit.length - 1 ];\r\n\t\tlet refClass                = require(refClassname);\r\n\r\n\t\treturn refClass[refShortClassname];\r\n\t}\r\n}\r\n","import { Bindable } from './Bindable';\r\nimport { View     } from './View';\r\n\r\nexport class ViewList\r\n{\r\n\tconstructor(template, subProperty, list, keyProperty = null)\r\n\t{\r\n\t\tthis.args         = Bindable.makeBindable({});\r\n\t\tthis.args.value   = Bindable.makeBindable(list || {});\r\n\t\tthis.args.subArgs = Bindable.makeBindable({});\r\n\t\tthis.views        = {};\r\n\t\tthis.template     = template;\r\n\t\tthis.subProperty  = subProperty;\r\n\t\tthis.keyProperty  = keyProperty;\r\n\t\tthis.tag          = null;\r\n\t\tthis.paused       = false;\r\n\r\n\t\tthis.args.value.___before___.push((t)=>{\r\n\t\t\t// console.log(t.___executing___);\r\n\t\t\tif(t.___executing___ == 'bindTo')\r\n\t\t\t{\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.paused = true;\r\n\t\t});\r\n\r\n\t\tthis.args.value.___after___.push((t)=>{\r\n\t\t\tif(this.paused)\r\n\t\t\t{\r\n\t\t\t\t// console.log(t.___executing___);\r\n\t\t\t\tthis.reRender();\r\n\t\t\t}\r\n\t\t\tthis.paused = false;\r\n\t\t});\r\n\r\n\t\t// console.log(this.args);\r\n\r\n\t\tthis.args.value.bindTo((v, k, t, d) => {\r\n\r\n\t\t\tif(this.paused)\r\n\t\t\t{\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif(d)\r\n\t\t\t{\r\n\t\t\t\tthis.views[k].remove();\r\n\r\n\t\t\t\tdelete this.views[k];\r\n\t\t\t\t// console.log(`Deleting ${k}`, v, this.views);\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// console.log(`Setting ${k}`, v, this.views);\r\n\r\n\t\t\tif(!this.views[k])\r\n\t\t\t{\r\n\t\t\t\tlet view = new View();\r\n\r\n\t\t\t\tthis.views[k] = view;\r\n\t\t\t\t\r\n\t\t\t\tthis.views[k].template = this.template;\r\n\t\t\t\t\r\n\t\t\t\tthis.views[k].parent   = this.parent;\r\n\t\t\t\tthis.views[k].viewList = this;\r\n\r\n\t\t\t\tthis.args.subArgs.bindTo((v, k, t, d) => {\r\n\t\t\t\t\tview.args[k] = v;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.views[k].args[ this.subProperty ] = v;\r\n\r\n\t\t\t\tif(this.keyProperty)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.views[k].args[ this.keyProperty ] = k;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tt[k] = v;\r\n\r\n\t\t\t\tthis.reRender();\r\n\t\t\t}\r\n\r\n\t\t\tthis.views[k].args[ this.subProperty ] = v;\r\n\t\t});\r\n\t}\r\n\r\n\trender(tag)\r\n\t{\r\n\t\tfor(let i in this.views)\r\n\t\t{\r\n\t\t\tthis.views[i].render(tag);\r\n\t\t}\r\n\r\n\t\tthis.tag = tag;\r\n\r\n\t\t// console.log(tag);\r\n\t}\r\n\r\n\treRender()\r\n\t{\r\n\t\t// console.log('rerender');\r\n\t\tif(!this.tag)\r\n\t\t{\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet views = [];\r\n\r\n\t\tfor(let i in this.views)\r\n\t\t{\r\n\t\t\tviews[i] = this.views[i];\r\n\t\t}\r\n\r\n\t\tlet finalViews = [];\r\n\r\n\t\tfor(let i in this.args.value)\r\n\t\t{\r\n\t\t\tlet found = false;\r\n\t\t\tfor(let j in views)\r\n\t\t\t{\r\n\t\t\t\tif(views[j] && this.args.value[i] === views[j].args[ this.subProperty ])\r\n\t\t\t\t{\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tfinalViews[i] = views[j];\r\n\t\t\t\t\tdelete views[j];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(!found)\r\n\t\t\t{\r\n\t\t\t\tlet viewArgs = {};\r\n\t\t\t\tviewArgs[this.subProperty] = this.args.value[i];\r\n\t\t\t\tfinalViews[i] = new View(viewArgs);\r\n\r\n\t\t\t\tfinalViews[i].template = this.template;\r\n\t\t\t\tfinalViews[i].parent   = this.parent;\r\n\t\t\t\tfinalViews[i].viewList = this;\r\n\r\n\t\t\t\tfinalViews[i].args[ this.keyProperty ] = i;\r\n\r\n\t\t\t\tthis.args.subArgs.bindTo((v, k, t, d) => {\r\n\t\t\t\t\tfinalViews[i].args[k] = v;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet appendOnly = true;\r\n\r\n\t\tfor(let i in this.views)\r\n\t\t{\r\n\t\t\tif(this.views[i] !== finalViews[i])\r\n\t\t\t{\r\n\t\t\t\tappendOnly = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(!appendOnly)\r\n\t\t{\r\n\t\t\twhile(this.tag.firstChild)\r\n\t\t\t{\r\n\t\t\t\tthis.tag.removeChild(this.tag.firstChild);\r\n\t\t\t}\r\n\r\n\t\t\tfor(let i in finalViews)\r\n\t\t\t{\r\n\t\t\t\tfinalViews[i].render(this.tag);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tlet i = this.views.length || 0\r\n\r\n\t\t\twhile(finalViews[i])\r\n\t\t\t{\r\n\t\t\t\tfinalViews[i].render(this.tag);\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t}\t\t\r\n\r\n\t\tthis.views = finalViews;\r\n\t}\r\n\tremove()\r\n\t{\r\n\t\tfor(let i in this.views)\r\n\t\t{\r\n\t\t\tthis.views[i].remove();\r\n\t\t}\r\n\r\n\t\tthis.views = [];\r\n\r\n\t\twhile(this.tag.firstChild)\r\n\t\t{\r\n\t\t\tthis.tag.removeChild(this.tag.firstChild);\r\n\t\t}\r\n\t}\r\n}\r\n","import { Field } from './Field';\r\n\r\nexport class ButtonField extends Field {\r\n\tconstructor(values, form, parent, key) {\r\n\t\tsuper(values, form, parent, key);\r\n\t\tthis.args.title = this.args.title || this.args.value;\r\n\t\tthis.template = `\r\n\t\t\t<label for = \"${this.args.name}\" cv-ref = \"label:curvature/base/Tag\">\r\n\t\t\t\t<input\r\n\t\t\t\t\tname  = \"${this.args.name}\"\r\n\t\t\t\t\ttype  = \"${this.args.attrs.type}\"\r\n\t\t\t\t\tvalue = \"[[title]]\"\r\n\t\t\t\t\ton    = \"click:clicked(event)\"\r\n\t\t\t\t/>\r\n\t\t\t</label>\r\n\t\t`;\r\n\t}\r\n\tclicked(event) {\r\n\t\tthis.form.buttonClick(this.args.name);\r\n\t}\r\n}\r\n","import { View } from '../base/View';\r\n\r\nexport class Field extends View {\r\n\tconstructor(values, form, parent, key) {\r\n\t\tsuper(values);\r\n\t\tthis.args.title = this.args.title || '';\r\n\t\tthis.args.value = this.args.value || '';\r\n\r\n\t\tthis.args.valueString = '';\r\n\r\n\t\tthis.form   = form;\r\n\t\tthis.parent = parent;\r\n\t\tthis.key    = key;\r\n\r\n\t\tthis.ignore = this.args.attrs['data-cv-ignore'] || false;\r\n\r\n\t\tlet setting = null;\r\n\r\n\t\tthis.args.bindTo(\r\n\t\t\t'value'\r\n\t\t\t, (v, k) => {\r\n\t\t\t\t// console.trace();\r\n\t\t\t\t// console.log(this.args.name, v, k);\r\n\r\n\t\t\t\tif(setting == key)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// console.log(this.args.name, v, k);\r\n\r\n\t\t\t\tthis.args.valueString = JSON.stringify(v||'', null, 4);\r\n\r\n\t\t\t\tsetting = key;\r\n\r\n\t\t\t\tthis.parent.args.value[key] = v;\r\n\t\t\t\tsetting = null;\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tthis.parent.args.value.bindTo(key, (v, k)=>{\r\n\t\t\tif(setting == k)\r\n\t\t\t{\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tsetting = k;\r\n\r\n\t\t\tthis.args.value = v;\r\n\r\n\t\t\tsetting = null;\r\n\t\t});\r\n\r\n\t\tthis.template = `\r\n\t\t\t<label for = \"${this.args.name}\" cv-ref = \"label:curvature/base/Tag\">\r\n\t\t\t\t<span cv-if = \"title\" cv-ref = \"title:curvature/base/Tag\">[[title]]:</span>\r\n\t\t\t\t<input\r\n\t\t\t\t\tname    = \"${this.args.name}\"\r\n\t\t\t\t\ttype    = \"${this.args.attrs.type||'text'}\"\r\n\t\t\t\t\tcv-bind = \"value\"\r\n\t\t\t\t\tcv-ref  = \"input:curvature/base/Tag\"\r\n\t\t\t\t/>\r\n\t\t\t</label>\r\n\t\t`;\r\n\t\t//type    = \"${this.args.attrs.type||'text'}\"\r\n\t}\t\r\n}\r\n","import { Field } from './Field';\r\nimport { Form  } from './Form';\r\n\r\nexport class FieldSet extends Field\r\n{\r\n\tconstructor(values, form, parent, key)\r\n\t{\r\n\t\tsuper(values, form, parent, key);\r\n\t\tthis.args.value  = {};\r\n\t\tthis.args.fields = Form.renderFields(values.children, this);\r\n\t\tthis.template    = `\r\n\t\t\t<label for = \"${this.args.name}\">\r\n\t\t\t\t<span cv-if = \"title\">[[title]]:</span>\r\n\t\t\t\t<fieldset name = \"${this.args.name}\">\r\n\t\t\t\t\t<div cv-each = \"fields:field\">\r\n\t\t\t\t\t\t<div cv-bind = \"field\"></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</fieldset>\r\n\t\t\t</label>\r\n\t\t`;\r\n\t}\r\n}\r\n","import { Field } from './Field';\r\n\r\nexport class FileField extends Field {\r\n\tconstructor(values, form, parent, key) {\r\n\t\tsuper(values, form, parent, key);\r\n\t\tthis.template = `\r\n\t\t\t<label for = \"${this.args.name}\">\r\n\t\t\t\t<input\r\n\t\t\t\t\t\tname    = \"${this.args.name}\"\r\n\t\t\t\t\t\ttype    = \"${this.args.attrs.type}\"\r\n\t\t\t\t\t\tcv-bind = \"value\"\r\n\t\t\t\t/>\r\n\t\t\t\t<span style = \"display:none\" cv-if = \"value\">[[[value]]]</span>\r\n\t\t\t</label>\r\n\t\t`;\r\n\t}\r\n}\r\n","import { View } from '../base/View';\r\n\r\nimport { Field       } from './Field';\r\nimport { FieldSet    } from './FieldSet';\r\nimport { SelectField } from './SelectField';\r\nimport { HtmlField   } from './HtmlField';\r\nimport { HiddenField } from './HiddenField';\r\nimport { ButtonField } from './ButtonField';\r\n\r\n// import { Router           } from 'Router';\r\n\r\n// import { Repository       } from '../Repository';\r\n\r\n// import { FieldSet         } from './FieldSet';\r\n\r\n// import { ToastView        } from '../ToastView';\r\n// import { ToastAlertView   } from '../ToastAlertView';\r\n\r\nexport class Form extends View\r\n{\r\n\tconstructor(skeleton)\r\n\t{\r\n\t\tsuper({});\r\n\t\tthis.args.flatValue = this.args.flatValue || {};\r\n\t\tthis.args.value     = this.args.value     || {};\r\n\r\n\t\tthis.args.method    = skeleton._method || 'GET';\r\n\r\n\t\tthis.args.classes   = this.args.classes || [];\r\n\r\n\t\tthis.args.bindTo('classes', (v)=>{\r\n\t\t\tthis.args._classes = v.join(' ');\r\n\t\t});\r\n\r\n\t\tthis._onSubmit  = [];\r\n\t\tthis.action     = '';\r\n\t\tthis.template   = `\r\n\t\t\t<form\r\n\t\t\t\tclass   = \"[[_classes]]\"\r\n\t\t\t\tmethod  = \"[[method]]\"\r\n\t\t\t\tcv-each = \"fields:field\"\r\n\t\t\t\tcv-on   = \"submit:submit(event)\"\r\n\t\t\t\tcv-ref  = \"formTag:curvature/base/Tag\"\r\n\t\t\t>\r\n\t\t\t\t[[field]]\r\n\t\t\t</form>\r\n\t\t`;\r\n\r\n\t\tthis.args.fields    = Form.renderFields(skeleton, this);\r\n\r\n\t\tthis.args.bindTo(\r\n\t\t\t'value'\r\n\t\t\t, (v) => {\r\n\t\t\t\tthis.args.valueString = JSON.stringify(v, null, 4);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\tsubmit(event)\r\n\t{\r\n\t\tevent.preventDefault();\r\n\r\n\t\tthis.args.valueString = JSON.stringify(\r\n\t\t\tthis.args.value\r\n\t\t\t, null\r\n\t\t\t, 4\r\n\t\t);\r\n\r\n\t\tfor(let i in this._onSubmit)\r\n\t\t{\r\n\t\t\tthis._onSubmit[i](this, event);\r\n\t\t}\r\n\t}\r\n\tbuttonClick(event)\r\n\t{\r\n\t\t// console.log(event);\r\n\t}\r\n\tonSubmit(callback)\r\n\t{\r\n\t\tthis._onSubmit.push(callback);\r\n\t}\r\n\tstatic renderFields(skeleton, parent = null)\r\n\t{\r\n\t\tlet fields = {};\r\n\t\tfor(let i in skeleton)\r\n\t\t{\r\n\t\t\tif(fields[i])\r\n\t\t\t{\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif(i.substr(0,1) == '_')\r\n\t\t\t{\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tlet field = null;\r\n\t\t\tlet form  = null;\r\n\t\t\tif(parent instanceof Form)\r\n\t\t\t{\r\n\t\t\t\tform = parent;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tform = parent.form;\r\n\t\t\t}\r\n\r\n\t\t\tswitch(skeleton[i].type)\r\n\t\t\t{\r\n\t\t\t\tcase 'fieldset':\r\n\t\t\t\t\tfield = new FieldSet(skeleton[i], form, parent, i);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'select':\r\n\t\t\t\t\tfield = new SelectField(skeleton[i], form, parent, i);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'html':\r\n\t\t\t\t\tfield = new HtmlField(skeleton[i], form, parent, i);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'submit':\r\n\t\t\t\tcase 'button':\r\n\t\t\t\t\tfield = new ButtonField(skeleton[i], form, parent, i);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'hidden':\r\n\t\t\t\t\tfield = new HiddenField(skeleton[i], form, parent, i);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault :\r\n\t\t\t\t\tfield = new Field(skeleton[i], form, parent, i);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tfields[i] = field;\r\n\r\n\t\t\tfield.args.bindTo(\r\n\t\t\t\t'value'\r\n\t\t\t\t, (v, k ,t, d) => {\r\n\t\t\t\t\t// console.log(t,v);\r\n\t\t\t\t\tif(t.type == 'html' && !t.contentEditable)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tform.args.flatValue[ field.args.name ] = v;\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn fields;\r\n\t}\r\n\tqueryString(args = {})\r\n\t{\r\n\t\tlet parts = [];\r\n\t\t\r\n\t\tfor(let i in this.args.flatValue)\r\n\t\t{\r\n\t\t\targs[i] = args[i] || this.args.flatValue[i];\r\n\t\t}\r\n\r\n\t\tfor(let i in args)\r\n\t\t{\r\n\t\t\tparts.push(i + '=' + encodeURIComponent(args[i]));\r\n\t\t}\r\n\r\n\t\treturn parts.join('&');\r\n\t}\r\n\tpopulate(values)\r\n\t{\r\n\t\t// console.log(values);\r\n\r\n\t\tfor(let i in values)\r\n\t\t{\r\n\t\t\tthis.args.value[i] = values[i];\r\n\t\t}\r\n\t}\r\n}\r\n","import { Field } from './Field';\r\n\r\nexport class HiddenField extends Field {\r\n\tconstructor(values, form, parent, key) {\r\n\t\tsuper(values, form, parent, key);\r\n\t\tthis.template = `\r\n\t\t\t<label for = \"${this.args.name}\" style = \"display:none\" cv-ref = \"label:curvature/base/Tag\">\r\n\t\t\t\t<input\r\n\t\t\t\t\t\tname    = \"${this.args.name}\"\r\n\t\t\t\t\t\ttype    = \"${this.args.attrs.type}\"\r\n\t\t\t\t\t\tcv-bind = \"value\"\r\n\t\t\t\t\t\tcv-ref  = \"input:curvature/base/Tag\"\r\n\t\t\t\t/>\r\n\t\t\t\t<span cv-if = \"value\">[[[value]]]</span>\r\n\t\t\t</label>\r\n\t\t`;\r\n\t}\r\n}\r\n","import { View } from '../base/View';\r\n\r\nexport class HtmlField extends View {\r\n\tconstructor(values, form, parent, key) {\r\n\t\tsuper(values, form, parent, key);\r\n\t\tthis.ignore = this.args.attrs['data-cv-ignore'] || false;\r\n\t\tthis.args.contentEditable = this.args.attrs.contenteditable || false;\r\n\t\tthis.template = `<div contenteditable = \"[[contentEditable]]\">[[$value]]</div>`;\r\n\t}\t\r\n}\r\n","import { Field } from './Field';\r\n\r\nexport class SelectField extends Field {\r\n\tconstructor(values, form, parent, key) {\r\n\t\tsuper(values, form, parent, key);\r\n\t\tthis.template = `\r\n\t\t\t<label for = \"${this.args.name}\" cv-ref = \"label:curvature/base/Tag\">\r\n\t\t\t\t<span cv-if = \"title\" cv-ref = \"title:curvature/base/Tag\">[[title]]:</span>\r\n\t\t\t\t<select\r\n\t\t\t\t\tname    = \"${this.args.name}\"\r\n\t\t\t\t\tcv-bind = \"value\"\r\n\t\t\t\t\tcv-each = \"options:option:optionText\"\r\n\t\t\t\t\tcv-ref  = \"input:curvature/base/Tag\"\r\n\t\t\t\t/>\r\n\t\t\t\t\t<option value = \"[[option]]\">[[optionText]]</option>\r\n\t\t\t\t</select>\r\n\t\t\t</label>\r\n\t\t`;\r\n\t}\r\n\tgetLabel()\r\n\t{\r\n\t\tfor(let i in this.args.options)\r\n\t\t{\r\n\t\t\tif(this.args.options[i] == this.args.value)\r\n\t\t\t{\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","import { Bindable } from '../base/Bindable';\n\nexport class Keyboard\n{\n\tconstructor()\n\t{\n\t\tif(this.listening)\n\t\t{\n\t\t\t// return;\n\t\t}\n\n\t\tconsole.log('listening');\n\n\t\tthis.listening = true;\n\n\t\tthis.keys  = Bindable.makeBindable({});\n\t\tthis.codes = Bindable.makeBindable({});\n\n\t\tdocument.addEventListener('keyup', (event) => {\n\t\t\tthis.keys[ event.key ]   = -1;\n\t\t\tthis.codes[ event.code ] = -1;\n\t\t});\n\n\t\tdocument.addEventListener('keydown', (event) => {\n\t\t\tthis.keys[ event.key ]   = 1;\n\t\t\tthis.codes[ event.code ] = 1;\n\t\t});\n\t}\n\n\tgetKey(key)\n\t{\n\t\tif(!this.keys[key])\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\treturn this.keys[key];\n\t}\n\n\tgetKeyCode(code)\n\t{\n\t\tif(!this.codes[code])\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\treturn this.codes[code];\n\t}\n\n\tupdate()\n\t{\n\t\tfor(var i in this.keys)\n\t\t{\n\t\t\tif(this.keys[i] > 0)\n\t\t\t{\n\t\t\t\tthis.keys[i]++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.keys[i]--;\n\t\t\t}\n\t\t}\n\t\tfor(var i in this.codes)\n\t\t{\n\t\t\tif(this.codes[i] > 0)\n\t\t\t{\n\t\t\t\tthis.codes[i]++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.codes[i]--;\n\t\t\t}\n\t\t}\n\t}\n}\n","import { Dom } from '../base/Dom';\r\nimport { Tag } from '../base/Tag';\r\n\r\nexport class PopOutTag extends Tag\r\n{\r\n\tconstructor(element, parent, ref, index)\r\n\t{\r\n\t\tsuper(element, parent, ref, index);\r\n\r\n\t\tthis.poppedOut = false;\r\n\t\tthis.style     = element.getAttribute('style');\r\n\t\tthis.moving    = false;\r\n\r\n\t\tthis.leftDuration   = 0;\r\n\t\tthis.unpoppedStyle  = '';\r\n\t\tthis.previousScroll = 0;\r\n\r\n\t\tthis.bodyStyle  = '';\r\n\t\tthis.bodyScroll = 0;\r\n\r\n\t\telement.classList.add('unpopped');\r\n\r\n\t\tthis.scrollStyle;\r\n\r\n\t\tthis.rect;\r\n\t\tthis.clickListener  = (event) => {\r\n\t\t\tlet leftDuration = 0.333;\r\n\t\t\t\r\n\t\t\tif(!this.poppedOut || ! this.rect)\r\n\t\t\t{\r\n\t\t\t\tthis.rect = element.getBoundingClientRect();\r\n\r\n\t\t\t\tthis.distance = Math.sqrt(\r\n\t\t\t\t\tthis.rect.top ** 2\r\n\t\t\t\t\t+ this.rect.left ** 2\r\n\t\t\t\t);\r\n\r\n\t\t\t\tthis.leftDuration = (1 - (1 / this.distance)) / 4;\r\n\t\t\t}\r\n\r\n\t\t\tif(!this.element.contains(event.target))\r\n\t\t\t{\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tevent.preventDefault();\r\n\t\t\tevent.stopPropagation();\r\n\r\n\r\n\t\t\tif(this.moving)\r\n\t\t\t{\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif(!this.poppedOut)\r\n\t\t\t{\r\n\t\t\t\tthis.previousScroll = window.scrollY;\r\n\r\n\t\t\t\tif(!this.leftDuration)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.leftDuration = leftDuration;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.unpoppedStyle = `\r\n\t\t\t\t\t;position:  fixed;\r\n\t\t\t\t\tleft:       ${this.rect.x}px;\r\n\t\t\t\t\ttop:        ${this.rect.y}px;\r\n\t\t\t\t\twidth:      ${this.rect.width}px;\r\n\t\t\t\t\theight:     ${this.rect.height}px;\r\n\t\t\t\t\tz-index:    99999;\r\n\r\n\t\t\t\t\toverflow: hidden;\r\n\t\t\t\t`;\r\n\r\n\t\t\t\tlet style = this.style + this.unpoppedStyle;\r\n\r\n\t\t\t\telement.setAttribute('style', style);\r\n\r\n\t\t\t\tdocument.body.style.overflow = 'hidden';\r\n\t\t\t\tdocument.body.style.overflowY = 'hidden';\r\n\r\n\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\tstyle += `\r\n\t\t\t\t\t\t;top:   0px;\r\n\t\t\t\t\t\tleft:   0px;\r\n\t\t\t\t\t\twidth:  100%;\r\n\t\t\t\t\t\theight: 100%;\r\n\t\t\t\t\t\toverflow-y: auto;\r\n\t\t\t\t\t`;\r\n\r\n\t\t\t\t\tthis.moving = true;\r\n\r\n\t\t\t\t\telement.classList.add('unpopped');\r\n\r\n\t\t\t\t\telement.classList.add('popped');\r\n\t\t\t\t\telement.classList.remove('unpopped');\r\n\r\n\t\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\t\telement.setAttribute(\r\n\t\t\t\t\t\t\t'style'\r\n\t\t\t\t\t\t\t, style + `;transition: ${this.leftDuration}s ease-in;`\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t\tconsole.log(this.leftDuration*1000);\r\n\t\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\t\tPopOutTag.popLevel();\r\n\t\t\t\t\t\tthis.bodyStyle = document.body.getAttribute('style');\r\n\t\t\t\t\t\tthis.bodyScroll = window.scrollY;\r\n\t\t\t\t\t\tconsole.log(this.bodyScroll);\r\n\t\t\t\t\t\tdocument.body.setAttribute('style', 'height:0px;overflow:hidden;');\r\n\t\t\t\t\t\twindow.scrollTo(0,0);\r\n\t\t\t\t\t\tthis.moving = false;\r\n\t\t\t\t\t\tDom.mapTags(element, false, (tag)=>{\r\n\t\t\t\t\t\t\tlet event = new Event('cvPopped');\r\n\r\n\t\t\t\t\t\t\ttag.dispatchEvent(event);\r\n\r\n\t\t\t\t\t\t\tthis.scrollStyle = element.getAttribute('style');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}, this.leftDuration*1000);\r\n\t\t\t\t}, 1);\r\n\r\n\t\t\t\tthis.poppedOut = !this.poppedOut;\r\n\t\t\t}\r\n\t\t\telse if(event.target.matches('.closeButton') && this.poppedOut)\r\n\t\t\t{\r\n\t\t\t\twindow.scrollTo(0,this.previousScroll);\r\n\t\t\t\tsetTimeout(()=>{\r\n\r\n\t\t\t\t}, 1);\r\n\r\n\t\t\t\tlet style = this.style\r\n\t\t\t\t\t+ this.unpoppedStyle\r\n\t\t\t\t\t+ `;transition: ${this.leftDuration}s;`;\r\n\r\n\t\t\t\tif(0 === PopOutTag.unpopLevel())\r\n\t\t\t\t{\r\n\t\t\t\t\tdocument.body.setAttribute('style', this.bodyStyle);\r\n\t\t\t\t\tdocument.body.setAttribute('style', '');\r\n\t\t\t\t\tconsole.log('!!!');\r\n\r\n\t\t\t\t\twindow.scrollTo(0, this.bodyScroll);\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\telement.classList.add('unpopped');\r\n\r\n\t\t\t\telement.setAttribute('style', style);\r\n\r\n\t\t\t\tthis.moving = true;\r\n\r\n\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\telement.setAttribute('style', this.style);\r\n\t\t\t\t\telement.classList.remove('popped');\r\n\t\t\t\t}, this.leftDuration*500);\r\n\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\telement.setAttribute('style', this.style);\r\n\t\t\t\t\tthis.moving = false;\r\n\t\t\t\t\tDom.mapTags(element, false, (tag)=>{\r\n\t\t\t\t\t\tlet event = new Event('cvUnpopped');\r\n\r\n\t\t\t\t\t\ttag.dispatchEvent(event);\r\n\t\t\t\t\t});\r\n\t\t\t\t}, this.leftDuration*1000);\r\n\r\n\t\t\t\tthis.poppedOut = !this.poppedOut;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\telement.addEventListener('click',  this.clickListener);\r\n\r\n\t\tthis.cleanup.push(((element)=>()=>{\r\n\t\t\telement.removeEventListener('click',  this.clickListener);\r\n\t\t})(element));\r\n\t}\r\n\r\n\tstatic popLevel()\r\n\t{\r\n\t\tif(!this.level)\r\n\t\t{\r\n\t\t\tthis.level = 0;\r\n\t\t}\r\n\r\n\t\tthis.level++;\r\n\r\n\t\treturn this.level;\r\n\t}\r\n\r\n\tstatic unpopLevel()\r\n\t{\r\n\t\tif(!this.level)\r\n\t\t{\r\n\t\t\tthis.level = 0;\r\n\t\t}\r\n\r\n\t\tthis.level--;\r\n\r\n\t\treturn this.level;\r\n\t}\r\n\r\n\tpause()\r\n\t{\r\n\t\tsuper.pause();\r\n\t\tdocument.body.setAttribute('style', this.bodyStyle);\r\n\t\tdocument.body.setAttribute('style', '');\r\n\t\twindow.scrollTo(0, this.bodyScroll);\r\n\r\n\t\tconsole.log('!!!');\r\n\t}\r\n}\r\n","import { Tag      } from '../base/Tag';\r\nimport { Dom      } from '../base/Dom';\r\nimport { Bindable } from '../base/Bindable';\r\n\r\nexport class ScrollTag extends Tag\r\n{\r\n\tconstructor(element, parent, ref, index)\r\n\t{\r\n\t\tsuper(element, parent, ref, index);\r\n\r\n\t\tthis.visible         = false;\r\n\t\tthis.offsetTop       = false;\r\n\t\tthis.offsetBottom    = false;\r\n\r\n\t\tthis.scrollListener = (event) => {\r\n\t\t\tthis.scrolled(event.target);\r\n\t\t};\r\n\r\n\t\tthis.resizeListener = (event)=>{\r\n\t\t\tthis.scrolled(event.target);\r\n\t\t};\r\n\r\n\t\tthis.attachListener = (e) => {\r\n\t\t\tif(e.path[e.path.length-1]!==window)\r\n\t\t\t{\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif(e.target !== element)\r\n\t\t\t{\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// let current = Bindable.makeBindable(e.target);\r\n\r\n\t\t\tthis.addScrollListener(e.target);\r\n\t\t\tthis.addResizeListener(e.target);\r\n\r\n\t\t\tthis.scrolled(e.target);\r\n\r\n\t\t\te.target.removeEventListener('cvDomAttached', this.attachListener);\r\n\t\t};\r\n\r\n\t\tthis.element.addEventListener('cvDomAttached', this.attachListener);\r\n\r\n\t\tthis.cleanup.push(((element) => () => {\r\n\t\t\telement.removeEventListener('cvDomAttached', this.attachListener);\r\n\t\t})(this.element));\r\n\r\n\t\tthis.bindTo('visible', (v) => {\r\n\t\t\tlet scrolledEvent;\r\n\r\n\t\t\tif(v)\r\n\t\t\t{\r\n\t\t\t\tscrolledEvent = new Event('cvScrolledIn');\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tscrolledEvent = new Event('cvScrolledOut');\r\n\t\t\t}\r\n\r\n\t\t\tDom.mapTags(this.element, false, (node) => {\r\n\t\t\t\tnode.dispatchEvent(scrolledEvent);\r\n\t\t\t});\r\n\r\n\t\t\tthis.element.dispatchEvent(scrolledEvent);\r\n\t\t});\r\n\r\n\t\tthis.bindTo('offsetTop', (v) => {\r\n\t\t\tlet scrolledEvent = new CustomEvent('cvScrolled', {\r\n\t\t\t\tdetail: {offset: v}\r\n\t\t\t});\r\n\t\t\tDom.mapTags(this.element, false, (node) => {\r\n\t\t\t\tnode.dispatchEvent(scrolledEvent);\r\n\t\t\t});\r\n\r\n\t\t\tthis.element.dispatchEvent(scrolledEvent);\r\n\t\t});\r\n\t}\r\n\r\n\tscrolled(scroller)\r\n\t{\r\n\t\tlet current = this.element;\r\n\r\n\t\tlet offsetTop         = 0\r\n\t\t\t, offsetBottom    = 0;\r\n\r\n\t\tlet visible = false;\r\n\r\n\t\tlet rect = this.element.getBoundingClientRect();\r\n\r\n\t\tif(rect.bottom > 0 && rect.top < window.innerHeight)\r\n\t\t{\r\n\t\t\tvisible = true;\r\n\t\t}\r\n\r\n\t\tthis.proxy.visible      = visible;\r\n\t\tthis.proxy.offsetTop    = rect.top    || 0;\r\n\t\tthis.proxy.offsetBottom = rect.bottom || 0;\r\n\t}\r\n\r\n\taddScrollListener(tag)\r\n\t{\r\n\t\tif(!tag.___scrollListener___)\r\n\t\t{\r\n\t\t\tObject.defineProperty(tag, '___scrollListener___', {\r\n\t\t\t\tenumerable: false\r\n\t\t\t\t, writable: true\r\n\t\t\t});\r\n\r\n\t\t\ttag.___scrollListener___ = this.scrollListener;\r\n\r\n\t\t\twindow.addEventListener('scroll', this.scrollListener);\r\n\r\n\t\t\tthis.cleanup.push(((element)=>()=>{\r\n\t\t\t\tconsole.log('Cleaning!');\r\n\t\t\t\twindow.removeEventListener('scroll', element.___scrollListener___);\r\n\t\t\t})(tag));\r\n\t\t}\r\n\t}\r\n\r\n\taddResizeListener(tag)\r\n\t{\r\n\t\tif(!tag.___resizeListener___)\r\n\t\t{\r\n\t\t\tObject.defineProperty(tag, '___resizeListener___', {\r\n\t\t\t\tenumerable: false\r\n\t\t\t\t, writable: true\r\n\t\t\t});\r\n\r\n\t\t\twindow.addEventListener('resize', this.resizeListener);\r\n\r\n\t\t\tthis.cleanup.push(((element)=>()=>{\r\n\t\t\t\twindow.removeEventListener('resize', element.___resizeListener___);\r\n\t\t\t})(tag));\r\n\r\n\t\t\ttag.___resizeListener___ = this.resizeListener;\r\n\t\t}\r\n\t}\r\n}\r\n","import { View } from '../base/View';\r\n\r\nimport { ToastAlert } from './ToastAlert';\r\n\r\nexport class Toast extends View {\r\n\tstatic instance() {\r\n\t\tif(!this.inst) {\r\n\t\t\tthis.inst = new this();\r\n\t\t}\r\n\t\treturn this.inst;\r\n\t}\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.template = `\r\n\t\t\t<div id = \"[[_id]]\" cv-each = \"alerts:alert\" class = \"toast\">\r\n\t\t\t\t[[alert]]\r\n\t\t\t</div>\r\n\t\t`;\r\n\t\t// this.style = {\r\n\t\t// \t'': {\r\n\t\t// \t\tposition:   'fixed'\r\n\t\t// \t\t, top:      '0px'\r\n\t\t// \t\t, right:    '0px'\r\n\t\t// \t\t, padding:  '8px'\r\n\t\t// \t\t, 'z-index':'999999'\r\n\t\t// \t\t, display:  'flex'\r\n\t\t// \t\t, 'flex-direction': 'column-reverse'\r\n\t\t// \t}\r\n\t\t// };\r\n\t\t\r\n\t\tthis.args.alerts = [];\r\n\r\n\t\tthis.args.alerts.bindTo((v) => { console.log(v) });\r\n\t}\r\n\tpop(alert) {\r\n\t\tlet index = this.args.alerts.length;\r\n\r\n\t\tthis.args.alerts.push(alert);\r\n\r\n\t\talert.decay(((alert)=>()=>{\r\n\t\t\tfor(let i in this.args.alerts)\r\n\t\t\t{\r\n\t\t\t\tif(this.args.alerts)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.args.alerts[i] === alert;\r\n\r\n\t\t\t\t\tthis.args.alerts.splice(i, 1);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})(alert));\r\n\t}\r\n}\r\n","import { View } from '../base/View';\r\n\r\nexport class ToastAlert extends View {\r\n\tconstructor(args) {\r\n\t\tsuper(args);\r\n\t\tthis.args.time    = this.args.time || 10000;\r\n\t\tthis.init         = this.args.time;\r\n\t\tthis.args.opacity = 1;\r\n\t\tthis.args.title   = this.args.title || 'Standard alert';\r\n\t\tthis.args.body    = this.args.body  || 'This is a standard alert.';\r\n\t\tthis.template     = `\r\n\t\t\t<div id = \"[[_id]]\" style = \"opacity:[[opacity]]\" class = \"alert\">\r\n\t\t\t\t<h3>[[title]]</h3>\r\n\t\t\t\t<p>[[body]]</p>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\tdecay(complete) {\r\n\t\tlet decayInterval = 16;\r\n\t\tlet decay = setInterval(\r\n\t\t\t()=>{\r\n\t\t\t\tif(this.args.time > 0) {\r\n\t\t\t\t\tthis.args.time -= decayInterval;\r\n\t\t\t\t\tthis.args.opacity = this.args.time / this.init;\r\n\r\n\t\t\t\t\tif(this.args.time <= 0) {\r\n\t\t\t\t\t\tif(complete) {\r\n\t\t\t\t\t\t\tcomplete();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tclearInterval(decay);\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t, decayInterval\r\n\t\t);\r\n\t}\r\n}\r\n"]}